for (P in P_set) {
for (D in D_set) {
for (Q in Q_set) {
model <- Arima(ts_obj,
order   = c(p, d, q),
seasonal = list(order = c(P, D, Q), period = s),
method = "ML",
transform.pars = TRUE )
SARIMA_fit[[cc]] <- model
results_matrix[cc, ] <- c(p, d, q, P, D, Q, model$aic, model$bic, model$aicc)
cc <- cc + 1
}
}
}
}
}
}
results_df <- as.data.frame(results_matrix)
colnames(results_df) <- c("p","d","q","P","D","Q","AIC","BIC","AICc")
highlight_row <- which.min(results_df$AIC)
cap <- if (!is.null(caption_prefix) && nzchar(caption_prefix)) {
sprintf("%s : %s", caption_prefix, caption_suffix)
} else {
caption_suffix
}
result_table1 <-knitr::kable(results_df, align = 'c', caption = cap) %>%
kableExtra::kable_styling(full_width = FALSE, position = "center") %>%
kableExtra::row_spec(highlight_row, bold = TRUE, background = "#FFFF99")
best_model <- SARIMA_fit[[highlight_row]]
cat("\nBest SARIMA Model (by AIC) \n")
print(best_model)
cat("\n Summary(best model) \n")
#print(summary(best_model))
list(
table = result_table1,
best_model = SARIMA_fit[[highlight_row]],
#best_row = results_df[highlight_row, , drop = FALSE]
)
#return(list(
# best_model = best_model
#))
}
#| echo: true
#| code-fold: true
fit_import <- sarima_grid(
ts_obj = import_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1), s = 12,
caption_prefix = "Trade import South korea vs USA "
)
#| echo: true
#| code-fold: true
sarima_grid <- function(ts_obj,
p_set, d_set, q_set,
P_set, D_set, Q_set, s,
caption_prefix = NULL,
caption_suffix = "Comparison of SARIMA Model"){
SARIMA_fit <- list()
n <- length(p_set) * length(d_set) * length(q_set) *
length(P_set) * length(D_set) * length(Q_set)
results_matrix <- matrix(NA_real_, nrow = n, ncol = 9)
cc <- 1
for (d in d_set) {
for (p in p_set) {
for (q in q_set) {
for (P in P_set) {
for (D in D_set) {
for (Q in Q_set) {
model <- Arima(ts_obj,
order   = c(p, d, q),
seasonal = list(order = c(P, D, Q), period = s),
method = "ML",
transform.pars = TRUE )
SARIMA_fit[[cc]] <- model
results_matrix[cc, ] <- c(p, d, q, P, D, Q, model$aic, model$bic, model$aicc)
cc <- cc + 1
}
}
}
}
}
}
results_df <- as.data.frame(results_matrix)
colnames(results_df) <- c("p","d","q","P","D","Q","AIC","BIC","AICc")
highlight_row <- which.min(results_df$AIC)
cap <- if (!is.null(caption_prefix) && nzchar(caption_prefix)) {
sprintf("%s : %s", caption_prefix, caption_suffix)
} else {
caption_suffix
}
result_table1 <-knitr::kable(results_df, align = 'c', caption = cap) %>%
kableExtra::kable_styling(full_width = FALSE, position = "center") %>%
kableExtra::row_spec(highlight_row, bold = TRUE, background = "#FFFF99")
best_model <- SARIMA_fit[[highlight_row]]
cat("\nBest SARIMA Model (by AIC) \n")
print(best_model)
cat("\n Summary(best model) \n")
#print(summary(best_model))
list(
table = result_table1,
best_model = SARIMA_fit[[highlight_row]],
best_row = results_df[highlight_row, , drop = FALSE]
)
#return(list(
# best_model = best_model
#))
}
#| echo: true
#| code-fold: true
fit_import <- sarima_grid(
ts_obj = import_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1), s = 12,
caption_prefix = "Trade import South korea vs USA "
)
fit_import
#| echo: true
#| code-fold: true
fit_export<- sarima_grid(
ts_obj = export_ts,
p_set = c(0), d_set = c(0,1), q_set = c(0,1,2,3),
P_set = c(0), D_set = c(0,1), Q_set = c(0,1), s = 12,
caption_prefix = " Trade export South korea vs USA  "
)
fit_export
#| echo: true
#| code-fold: true
sarima_grid <- function(ts_obj,
p_set, d_set, q_set,
P_set, D_set, Q_set, s,
caption_prefix = NULL,
caption_suffix = "Comparison of SARIMA Model"){
SARIMA_fit <- list()
n <- length(p_set) * length(d_set) * length(q_set) *
length(P_set) * length(D_set) * length(Q_set)
results_matrix <- matrix(NA_real_, nrow = n, ncol = 9)
cc <- 1
for (d in d_set) {
for (p in p_set) {
for (q in q_set) {
for (P in P_set) {
for (D in D_set) {
for (Q in Q_set) {
model <- Arima(ts_obj,
order   = c(p, d, q),
seasonal = list(order = c(P, D, Q), period = s),
method = "ML",
transform.pars = TRUE )
SARIMA_fit[[cc]] <- model
results_matrix[cc, ] <- c(p, d, q, P, D, Q, model$aic, model$bic, model$aicc)
cc <- cc + 1
}
}
}
}
}
}
results_df <- as.data.frame(results_matrix)
colnames(results_df) <- c("p","d","q","P","D","Q","AIC","BIC","AICc")
highlight_row <- which.min(results_df$AIC)
cap <- if (!is.null(caption_prefix) && nzchar(caption_prefix)) {
sprintf("%s : %s", caption_prefix, caption_suffix)
} else {
caption_suffix
}
result_table1 <-knitr::kable(results_df, align = 'c', caption = cap) %>%
kableExtra::kable_styling(full_width = FALSE, position = "center") %>%
kableExtra::row_spec(highlight_row, bold = TRUE, background = "#FFFF99")
list(
table = result_table1,
best_model = SARIMA_fit[[highlight_row]],
best_row = results_df[highlight_row, , drop = FALSE]
)
#best_model <- SARIMA_fit[[highlight_row]]
#cat("\nBest SARIMA Model (by AIC) \n")
#print(best_model)
#cat("\n Summary(best model) \n")
#print(summary(best_model))
#list(
#  table = result_table1,
#  best_model = SARIMA_fit[[highlight_row]],
#  best_row = results_df[highlight_row, , drop = FALSE]
#)
#return(list(
# best_model = best_model
#))
}
#| echo: true
#| code-fold: true
fit_import <- sarima_grid(
ts_obj = import_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1), s = 12,
caption_prefix = "Trade import South korea vs USA "
)
fit_import
#| echo: true
#| code-fold: true
arima_grid <- function(ts_obj,
p_set, d_set, q_set,
caption1 = NULL,
caption2 = "Comparison of ARIMA Models") {
ARIMA_fit <- list()
n <- length(p_set) * length(d_set) * length(q_set)
results_matrix <- matrix(NA_real_, nrow = n, ncol = 6)
cc <- 1
for (d in d_set) {
for (p in p_set) {
for (q in q_set) {
model <- Arima(ts_obj, order = c(p, d, q), include.drift = (d > 0))
ARIMA_fit[[cc]] <- model
results_matrix[cc, ] <- c(p, d, q, model$aic, model$bic, model$aicc)
cc <- cc + 1
}
}
}
results_df <- as.data.frame(results_matrix)
colnames(results_df) <- c("p","d","q","AIC","BIC","AICc")
highlight_row <- which.min(results_df$AIC)
cap <- if (!is.null(caption1) && nzchar(caption1)) {
sprintf("%s : %s", caption1, caption2)
} else {
caption
}
result_table<-knitr::kable(results_df, align = 'c', caption = cap) %>%
kable_styling(full_width = FALSE, position = "center") %>%
row_spec(highlight_row, bold = TRUE, background = "#FFFF99")
list(
table = result_table,
best_model = ARIMA_fit[[highlight_row]],
best_row = results_df[highlight_row, , drop = FALSE]
)
#print(result_table)
#best_model <- ARIMA_fit[[highlight_row]]
#cat("\nBest ARIMA Model (by AIC) \n")
#print(best_model)
#cat("\n Summary(best model) \n")
#print(summary(best_model))
#return(list(
#  best_model = best_model
#))
}
#| echo: true
#| code-fold: true
fit_kor_base <- arima_grid(
ts_obj = kr_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1),
caption1 = "South Korea Base Rate "
)
fit_kor_base
#| echo: true
#| code-fold: true
fit_export<- sarima_grid(
ts_obj = export_ts,
p_set = c(0), d_set = c(0,1), q_set = c(0,1,2,3),
P_set = c(0), D_set = c(0,1), Q_set = c(0,1), s = 12,
caption_prefix = " Trade export South korea vs USA  "
)
fit_export
#| echo: true
#| code-fold: true
sarima_grid <- function(ts_obj,
p_set, d_set, q_set,
P_set, D_set, Q_set, s,
caption_prefix = NULL,
caption_suffix = "Comparison of SARIMA Model"){
SARIMA_fit <- list()
n <- length(p_set) * length(d_set) * length(q_set) *
length(P_set) * length(D_set) * length(Q_set)
results_matrix <- matrix(NA_real_, nrow = n, ncol = 9)
cc <- 1
for (d in d_set) {
for (p in p_set) {
for (q in q_set) {
for (P in P_set) {
for (D in D_set) {
for (Q in Q_set) {
model <- Arima(ts_obj,
order   = c(p, d, q),
seasonal = list(order = c(P, D, Q), period = s),
method = "ML",
transform.pars = TRUE )
SARIMA_fit[[cc]] <- model
results_matrix[cc, ] <- c(p, d, q, P, D, Q, model$aic, model$bic, model$aicc)
cc <- cc + 1
}
}
}
}
}
}
results_df <- as.data.frame(results_matrix)
colnames(results_df) <- c("p","d","q","P","D","Q","AIC","BIC","AICc")
highlight_row <- which.min(results_df$AIC)
cap <- if (!is.null(caption_prefix) && nzchar(caption_prefix)) {
sprintf("%s : %s", caption_prefix, caption_suffix)
} else {
caption_suffix
}
result_table1 <-knitr::kable(results_df, align = 'c', caption = cap) %>%
kableExtra::kable_styling(full_width = FALSE, position = "center") %>%
kableExtra::row_spec(highlight_row, bold = TRUE, background = "#FFFF99")
list(
table = result_table1,
best_model = SARIMA_fit[[highlight_row]],
best_row = results_df[highlight_row, , drop = FALSE]
)
}
#| echo: true
#| code-fold: true
fit_import <- sarima_grid(
ts_obj = import_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1), s = 12,
caption_prefix = "Trade import South korea vs USA "
)
fit_import
#| echo: true
#| code-fold: true
sarima_grid <- function(ts_obj,
p_set, d_set, q_set,
P_set, D_set, Q_set, s,
caption_prefix = NULL,
caption_suffix = "Comparison of SARIMA Model"){
SARIMA_fit <- list()
n <- length(p_set) * length(d_set) * length(q_set) *
length(P_set) * length(D_set) * length(Q_set)
results_matrix <- matrix(NA_real_, nrow = n, ncol = 9)
cc <- 1
for (d in d_set) {
for (p in p_set) {
for (q in q_set) {
for (P in P_set) {
for (D in D_set) {
for (Q in Q_set) {
model <- Arima(ts_obj,
order   = c(p, d, q),
seasonal = list(order = c(P, D, Q), period = s),
method = "ML",
transform.pars = TRUE )
SARIMA_fit[[cc]] <- model
results_matrix[cc, ] <- c(p, d, q, P, D, Q, model$aic, model$bic, model$aicc)
cc <- cc + 1
}
}
}
}
}
}
results_df <- as.data.frame(results_matrix)
colnames(results_df) <- c("p","d","q","P","D","Q","AIC","BIC","AICc")
highlight_row <- which.min(results_df$AIC)
cap <- if (!is.null(caption_prefix) && nzchar(caption_prefix)) {
sprintf("%s : %s", caption_prefix, caption_suffix)
} else {
caption_suffix
}
#result_table1 <-knitr::kable(results_df, align = 'c', caption = cap) %>%
# kableExtra::kable_styling(full_width = FALSE, position = "center") %>%
# kableExtra::row_spec(highlight_row, bold = TRUE, background = "#FFFF99")
#list(
#   table = result_table1,
#  best_model = SARIMA_fit[[highlight_row]],
#  best_row = results_df[highlight_row, , drop = FALSE]
# )
}
#| echo: true
#| code-fold: true
#| results: asis
library(kableExtra)
sarima_grid <- function(ts_obj,
p_set, d_set, q_set,
P_set, D_set, Q_set, s,
caption_prefix = NULL,
caption_suffix = "Comparison of SARIMA Model"){
SARIMA_fit <- list()
n <- length(p_set) * length(d_set) * length(q_set) *
length(P_set) * length(D_set) * length(Q_set)
results_matrix <- matrix(NA_real_, nrow = n, ncol = 9)
cc <- 1
for (d in d_set) {
for (p in p_set) {
for (q in q_set) {
for (P in P_set) {
for (D in D_set) {
for (Q in Q_set) {
model <- Arima(ts_obj,
order   = c(p, d, q),
seasonal = list(order = c(P, D, Q), period = s),
method = "ML",
transform.pars = TRUE )
SARIMA_fit[[cc]] <- model
results_matrix[cc, ] <- c(p, d, q, P, D, Q, model$aic, model$bic, model$aicc)
cc <- cc + 1
}
}
}
}
}
}
results_df <- as.data.frame(results_matrix)
colnames(results_df) <- c("p","d","q","P","D","Q","AIC","BIC","AICc")
highlight_row <- which.min(results_df$AIC)
cap <- if (!is.null(caption_prefix) && nzchar(caption_prefix)) {
sprintf("%s : %s", caption_prefix, caption_suffix)
} else {
caption_suffix
}
result_table1 <-knitr::kable(results_df, align = 'c', caption = cap) %>%
kableExtra::kable_styling(full_width = FALSE, position = "center") %>%
kableExtra::row_spec(highlight_row, bold = TRUE, background = "#FFFF99")
list(
table = result_table1,
best_model = SARIMA_fit[[highlight_row]],
best_row = results_df[highlight_row, , drop = FALSE]
)
}
#| echo: true
#| code-fold: true
fit_import <- sarima_grid(
ts_obj = import_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1), s = 12,
caption_prefix = "Trade import South korea vs USA "
)
fit_import
#| echo: true
#| code-fold: true
fit_import <- sarima_grid(
ts_obj = import_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1), s = 12,
caption_prefix = "Trade import South korea vs USA "
)
fit_import$table
#| echo: true
#| code-fold: true
fit_import <- sarima_grid(
ts_obj = import_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1), s = 12,
caption_prefix = "Trade import South korea vs USA "
)
fit_import$table
fit_import$best_model
#| echo: true
#| code-fold: true
fit_housing <- sarima_grid(
ts_obj = house_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1,2), s = 12,
caption_prefix = "seoul housing property index"
)
fit_housing$
#| echo: true
#| code-fold: true
fit_housing <- sarima_grid(
ts_obj = house_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
P_set = c(0,1), D_set = c(1), Q_set = c(0,1,2), s = 12,
caption_prefix = "seoul housing property index"
)
fit_housing$table
print(fit_housing$best_model)
#| echo: true
#| code-fold: true
fit_usr <- arima_grid(
ts_obj = usr_ts,
p_set = c(0,1), d_set = c(1), q_set = c(0,1,2),
caption1 = "FED rate"
)
fit_usr$table
#| echo: true
#| code-fold: true
fit_kr <- arima_grid(
ts_obj = kr_ts,
p_set = c(0,1), d_set = c(0,1), q_set = c(0,1),
caption1 = "KRW/USD FX rate"
)
fit_kr
#| echo: true
#| code-fold: true
fit_yield_3y <- arima_grid(
ts_obj = yield_3y_ts,
p_set = c(0,1), d_set = c(0,1), q_set = c(0,1),
caption1 = "USA & South Korea yield spread rate(3Y)"
)
#| echo: true
#| code-fold: true
fit_kr <- arima_grid(
ts_obj = kr_ts,
p_set = c(0,1), d_set = c(0,1), q_set = c(0,1),
caption1 = "KRW/USD FX rate"
)
fit_kr$table
print(fit_kr$table)
#| echo: true
#| code-fold: true
fit_kr <- arima_grid(
ts_obj = kr_ts,
p_set = c(0,1), d_set = c(0,1), q_set = c(0,1),
caption1 = "KRW/USD FX rate"
)
fit_kr$table
print(fit_kr$best_model)
#| echo: true
#| code-fold: true
fit_kospi <- arima_grid(
ts_obj = kospi_log,
p_set = c(0,1), d_set = c(0,1), q_set = c(0,1,2),
caption1 = "KOSPI Index (log)"
)
