[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Time series Analysis",
    "section": "",
    "text": "What is a Time Series? A time series is any sequence of measurements taken at regular, equally spaced intervals—seconds, minutes, hours, days, months, quarters, or years. Common examples include weather (daily temperature or rainfall), financial markets (daily stock prices or returns), industry indicators (monthly production or sales), electricity demand, traffic counts, and hospital admissions. In time-series analysis we study how these values evolve: their level, trend, seasonal or calendar patterns (e.g., weekdays vs. weekends, holiday effects), cycles, and anomalies. Typical goals are to describe behavior clearly, forecast future values, and quantify the impact of events or policies.\nBecause observations are ordered in time, nearby points tend to be correlated (autocorrelation). This violates the independent-and-identically-distributed assumption behind many standard statistical methods, so naïve cross-sectional tools often mislead. Time-series work must explicitly handle dependence, trend, and seasonality—for example by differencing, seasonal adjustment, and models that use lagged values and errors (e.g., ARIMA/SARIMA, ARIMAX/SARIMAX with external drivers, VAR for multiple series, state-space/ETS, or GARCH when volatility changes over time). Analysts also watch for structural breaks (e.g., policy shifts, COVID), outliers, and missing periods, and they evaluate models with time-aware validation (rolling or blocked splits) rather than random shuffles."
  },
  {
    "objectID": "data_source/data_source.html",
    "href": "data_source/data_source.html",
    "title": "DATA SOURCES",
    "section": "",
    "text": "Data source 1: Yield Curve\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese datasets contain yield curve information for both the United States and Korea. Yield curves represent benchmark borrowing costs across short- and long-term maturities. The difference between long- and short-term yields (“the slope”) reflects market expectations about growth and inflation. The U.S. yield curve will be used primarily to capture U.S. economic conditions, while the Korean yield curve will measure how U.S. rate movements influence Korean bonds. The analysis focuses on the spread between 3-year (short-term) and 10-year (long-term) maturities.\nUS yield curve\nkorea yield curve\n\n\nData source 2: FX spot rate data\n\nThis dataset records the daily exchange rate of the Korean Won (KRW) against the U.S. Dollar (USD). The FX rate is central to understanding the U.S. dollar’s influence on Korea’s financial markets. It allows the detection of turning points, trend shifts, and day-to-day volatility, helping to evaluate how U.S. rate shocks and dollar movements transmit into the Korean currency market.\nKorean won(KRW) data\n\n\nData source 3: Yahoo finance\n\nYahoo Finance provides accessible and reliable financial market data. In this project, it is used to obtain stock market indices such as the KOSPI—the main benchmark for Korean equities,U.S. Dollar Index (DXY) and S&P500 index. These data support analyses linking stock performance and currency strength to U.S. interest rate movements. For this project yfinance via python will be used to access dataset and store to my folder.\nyahoo finance\n\nKOSPI index yfinance code\n\n\nCode\nimport yfinance as yf\nimport pandas as pd\n\nticker = \"^KS11\"\ndata = yf.download(ticker, start=\"1990-01-02\", end=None, interval=\"1d\", progress=False)\n#data.to_csv(\"kospi.csv\")\n\n\n\n\nUSD index yfinance code\n\n\nCode\nimport yfinance as yf\nimport pandas as pd\n\nticker = \"DX-Y.NYB\"\ndata = yf.download(ticker, start=\"1981-04-13\", end=None, interval=\"1d\", progress=False)\n\n#data.to_csv(\"usd_index.csv\")\n\n\n\n\nS&P500 index yfinance code\n\n\nCode\nimport yfinance as yf\nimport pandas as pd\nsp500 = yf.download(\"^GSPC\", start=\"1990-01-02\")\n#sp500.to_csv(\"sp500.csv\")\n\n\n\n\n\nData source 4: Korea import & export data\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis dataset reports Korea’s imports and exports with the United States, measured in thousands of U.S. dollars over time. Since Korea’s economy is heavily export-oriented, t rade data are crucial for assessing how U.S. economic developments—through growth momentum, dollar fluctuations, and rate differentials—affect Korea’s trade performance. This dataset supports the examination of transmission channels between U.S. shocks and Korea’s real economy.\ntrade data\n\n\nData source 5: korean housing data\n\nThis dataset provides the residential property price index for Korea, specifically the Seoul metropolitan area. Given that the housing market represents one of Korea’s largest sectors, changes in property prices and transactions are key indicators of domestic financial conditions. This data enables analysis of how U.S. economic conditions and interest rate changes affect Korea’s housing affordability, financing costs, and overall market activity.\nhousing data\n\n\nData source 6 : FRED effective rate\n\nThis dataset provides the Effective Federal Funds Rate (EFFR) from the Federal Reserve Economic Data (FRED). The effective rate reflects the average interest rate at which depository institutions lend balances to each other overnight and serves as the key indicator of U.S. monetary policy stance. In this project, the FRED rate data represent the foundation of U.S. policy movements, used to identify tightening or easing cycles, measure interest-rate shocks, and analyze how U.S. monetary changes transmit to Korean financial markets, including bond yields, FX, and equity valuations.\nFRED rate\n\n\nDate source 7: Bank of Korea base rate\n\nThis dataset contains the Bank of Korea (BoK) Base Rate, which is the main policy rate set by the BoK’s Monetary Policy Board. The base rate determines short-term money market conditions and anchors borrowing and lending rates across Korea’s financial system. In this project, the BoK rate is used to evaluate domestic monetary policy reactions to external U.S. rate movements. Comparing shifts in the BoK base rate with changes in the FRED effective rate allows identification of synchronization or divergence between the two central banks’ policies and their effects on Korea’s yield curve, currency, and real economy.\nBOK rate"
  },
  {
    "objectID": "EDA/eda.html",
    "href": "EDA/eda.html",
    "title": "EDA",
    "section": "",
    "text": "packages used\n\n\nCode\nlibrary(feasts) \nlibrary(tsibble)\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(zoo)       \nlibrary(forecast)   \nlibrary(tseries)   \nlibrary(patchwork) \nlibrary(here)\nlibrary(plotly)\nlibrary(xts)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggfortify)\n\n\n\n\nTime series plot\n\nBank of Korea base rateFederal Reserve effective rateKRW vs USD exchange rateUSD indexseoul real property price indexyield spread for USA & South korea: 10 years -3 yearsus-korea import and exportsS&P500 indexKOSPI index\n\n\n\n\nCode\nbok&lt;- read.csv(\"../data/interest/bok.csv\")%&gt;%\n  rename(Date = date)\nbok$Date&lt;- as.Date(bok$Date)\nbok &lt;- bok %&gt;%\n  mutate(Date = floor_date(Date, unit = \"quarter\")) %&gt;%\n  group_by(Date) %&gt;%\n  summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)), .groups = \"drop\")\n\n\nggplot(bok, aes(x = Date, y = base_rate)) +\n  geom_line(color = \"skyblue\") +\n  labs(title = \"Bank of Korea base rate(quarterly) \",\n       x = \"Date\", y = \"Rate (%)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThis time series plot shows a gentle downward trend from the early 2000s to 2020, then a sharp upswing during the 2021–23 tightening cycle and a recent leveling. There is no seasonality, policy rates don’t just move by considering only the calendar. Variation is moderate and step-like, reflecting discrete policy decisions rather than continuous noise. There are clear cyclical/periodic fluctuations aligned with business cycles: rapid cuts in 2008–09 and 2020, tightening in mid-2000s and post-COVID.\n\n\n\n\nCode\nusr&lt;- read.csv(\"../data/interest/us_rate.csv\")%&gt;%\n  rename(Date = observation_date,rate = DFF)\nusr$Date&lt;- as.Date(usr$Date)\n\nusr&lt;- usr %&gt;%\n  mutate(Date = floor_date(Date, unit = \"quarter\")) %&gt;%\n  group_by(Date) %&gt;%\n  summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)), .groups = \"drop\")\n\nggplot(usr, aes(x = Date, y = rate)) +\n  geom_line(color = \"orange\") +\n  labs(title = \"Federal reserve effective rate(quarterly) \",\n       x = \"Date\", y = \"Rate (%)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nPlot shows tightening and easing cycles: high in the early 2000s, pinned near zero in 2009–15 and 2020–21, then rapid hikes from 2022. There is no seasonality,since policy rates affected by various economical reasons, seasonal factors are less important when considering policy rates. The long stretches at the zero lower bound and the subsequent aggressive normalization highlight the interaction of inflation shocks and recession risk.\n\n\n\n\nCode\nkr &lt;- read.csv(\"../data/fx rate/kor.csv\")\nkr &lt;- kr %&gt;%\n  transmute(\n    Date = as.Date(observation_date),\n    krw  = DEXKOUS,    \n    usd  = 1 / DEXKOUS  \n  ) %&gt;%\n  filter(!is.na(Date)) %&gt;%\n  arrange(Date) %&gt;%\n  distinct(Date, .keep_all = TRUE) %&gt;%\n  complete(Date = seq(min(Date), max(Date), by = \"day\")) %&gt;%\n\n  fill(krw, usd, .direction = \"down\")\n\n\nggplot(kr, aes(x = Date, y = usd)) +\n  geom_line(color = \"gold\") +\n  labs(title = \"KRW/USD exchange rate \",\n       x = \"Date\", y = \"USD\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThe plot displays a long-run trend toward KRW depreciation punctuated by crisis spikes (late-1990s Asian crisis, 2008 GFC, 2020 COVID). Seasonality is not evident. Variation increases when the level is high, and medium-term cycles track global risk and U.S. monetary conditions. However overall it is hard to say for all time frame, there is a high variation(there are exceptional variation in one period).\n\n\n\n\nCode\nusd &lt;- read_csv(\"../data/fx rate/usd_index.csv\", show_col_types = FALSE)\n\nusd &lt;- usd %&gt;%\n  transmute(\n    Date = as.Date(Date),\n    usd_index = Close\n  ) %&gt;%\n  filter(!is.na(Date)) %&gt;%\n  arrange(Date) %&gt;%\n  distinct(Date, .keep_all = TRUE) %&gt;%\n  complete(Date = seq(min(Date), max(Date), by = \"day\")) %&gt;%\n  fill(usd_index, .direction = \"down\")\n\n\nggplot(usd, aes(x = Date, y = usd_index)) +\n  geom_line(color = \"darkblue\") +\n  labs(title = \"USD index \",\n       x = \"Date\", y = \"USD index\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nUSD index time series plot shows slow trend regimes—weakening after the mid-1980s peak, renewed strength around 2015–22—without seasonality; its variation is larger when the index is high; and long cycles reflect relative growth/real-rate differentials and safe-haven demand.\n\n\n\n\nCode\nhousing &lt;- read_csv(here(\"data/housing/seoul_housing.csv\"), skip = 3) %&gt;%\n  select(Date = `TIME_PERIOD:Period`, housing = `OBS_VALUE:Value`)%&gt;%\n  mutate(Date = as.Date(Date))\n\nhousing &lt;- housing %&gt;% mutate(Date = as.Date(Date))\n\n\nggplot(housing, aes(x = Date, y = housing)) +\n  geom_line(color = \"salmon2\") +\n  labs(title = \"Seoul Real Property Price Index \",\n       x = \"Date\", y = \"index \") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nSeoul real property price index plot shows A clear upward trend dominates, interrupted by corrections around 2008–12 and a sharp 2020–22 surge followed by partial pullback. seasonality is minimal, variation has grown with price levels.\n\n\n\n\nCode\nus_yield  &lt;- read.csv(here(\"data/yield\", \"us_yield.csv\"))\nkor_yield   &lt;- read.csv(here(\"data/yield\", \"kor_yield.csv\"))\n\n\nus_yield$Date  &lt;- as.Date(us_yield$Date)\nkor_yield$Date &lt;- as.Date(kor_yield$Date)\n\ncolnames(us_yield)[colnames(us_yield)  == \"X3Y\"]  &lt;- \"US_3Y\"\ncolnames(us_yield)[colnames(us_yield)  == \"X10Y\"] &lt;- \"US_10Y\"\ncolnames(kor_yield)[colnames(kor_yield) == \"X3Y\"]  &lt;- \"KR_3Y\"\ncolnames(kor_yield)[colnames(kor_yield) == \"X10Y\"] &lt;- \"KR_10Y\"\n\nus_yield  &lt;- us_yield[,  c(\"Date\", \"US_3Y\", \"US_10Y\")]\nkor_yield &lt;- kor_yield[, c(\"Date\", \"KR_3Y\", \"KR_10Y\")]\n\nus_yield  &lt;- us_yield  %&gt;% arrange(Date) %&gt;% fill(US_3Y, US_10Y, .direction = \"down\")\nkor_yield &lt;- kor_yield %&gt;% arrange(Date) %&gt;% fill(KR_3Y, KR_10Y, .direction = \"down\")\n\n\ndf &lt;- merge(us_yield, kor_yield, by = \"Date\")\n\ndf$US_3m10  &lt;- df$US_3Y - df$US_10Y\ndf$KR_3m10  &lt;- df$KR_3Y - df$KR_10Y\ndf$US_KR_3Y &lt;- df$US_3Y - df$KR_3Y\ndf$US_KR_10Y&lt;- df$US_10Y - df$KR_10Y\n\nfig &lt;- plot_ly(df, x = ~Date) |&gt;\n  add_lines(y = ~US_KR_3Y, name = \"US−KR (3Y)\") |&gt;\n  add_lines(y = ~US_KR_10Y, name = \"US−KR (10Y)\") |&gt;\n  layout(title = \"Yield Spreads: Term (3Y−10Y) and Cross-country (US−KR)\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Spread (pp)\"))\nfig\n\n\n\n\n\n\nyield spreads plot oscillate around zero with repeated cycles—notably inversions near recessions—show no seasonality, and maintain relatively stable variation in percentage points rather than scaling with level; taken together, they act as timely signals of policy divergence and cycle turns.\n\n\n\n\nCode\nimports &lt;- read_csv(here::here(\"data/trade\", \"imports.csv\"))\nexports &lt;- read_csv(here::here(\"data/trade\", \"exports.csv\"))\n\nclean_date &lt;- function(x) {\n  as.Date(paste0(sub(\"^([0-9]{4})([0-9]{2})$\", \"\\\\1-\\\\2\", gsub(\"/\", \"-\", as.character(x))), \"-01\"))\n}\n\nimports &lt;- imports %&gt;%\n  mutate(Date = clean_date(Date),\n         Type = \"Imports\")\n\nexports &lt;- exports %&gt;%\n  mutate(Date = clean_date(Date),\n         Type = \"Exports\")\ntrade &lt;- bind_rows(imports, exports)\n\nnames(trade)[2] &lt;- \"Value\"\n\ntrade_ts &lt;- trade %&gt;%\n  as_tsibble(index = Date, key = Type)\n\nautoplot(trade_ts, Value) +\n  labs(title = \"Monthly Imports and Exports: South korea vs USA\",\n       x = \"Date\", y = \"Trade Value\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nBoth import and export time series plots shows strong secular trend as trade deepens. For seasonality, it is likely to exists, in terms of year frame there is up-down; this means in terms of monthly there is possibility for seasonality. This which might due to production of goods, shipping calendars. variation widens as volumes grow; and cyclical dips coincide with global shocks (2008–09, 2020).\n\n\n\n\nCode\nsp500 &lt;- read_csv(\"../data/stock/sp500.csv\")\n\nggplot(sp500, aes(x = Date, y = Close)) +\n  geom_line(color = \"red\") +\n  labs(title = \"S&P 500 index \",\n       x = \"Date\", y = \"S&P 500 index \") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThis plot features a steep long-run trend higher with pronounced cyclical bear markets (2000–02, 2008–09, 2020); there is no seasonality; variation increases alongside the level, producing larger rallies and drawdowns over time.\n\n\n\n\nCode\nkospi &lt;- read_csv(\"../data/stock/kospi.csv\")\nkospi$Date &lt;- as.Date(kospi$Date)\nggplot(kospi, aes(x = Date, y = Close)) +\n  geom_line(color = \"darkslategray2\") +\n  labs(title = \"KOSPI index\",\n       x = \"Date\", y = \"kospi index\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nKOSPI time series plot shows upward trend with long plateaus and sharp cyclical swings around crises is evident. seasonality is hard to observe and variation grows with the index level, compare with S&P500, it has larger variation.\n\n\n\nFrom the time-series plots, the S&P 500, KOSPI, and USD index appear multiplicative: while seasonality is hard to detect, their variation increases with the level (larger absolute swings when the series is high), and the dominant movements are multi-year cyclical regimes tied to macro conditions rather than calendar patterns. So for these variables will be log transformed.\n\n\nLag plots\n\nSouth korea base rateFederal Reserve rateKRW/USD FX ratetrade import South korea vs USAtrade export South korea vs USAUSA & South korea yield spread rate(3y)USA & South korea yield spread rate(10y)seoul housing property indexUSD indexKOSPI indexS&P 500 index\n\n\n\n\nCode\nbok_ts &lt;- ts(bok$base_rate, start = c(year(min(bok$Date)), month(min(bok$Date))), end = c(year(max(bok$Date)), month(max(bok$Date))),frequency = 4)\ngglagplot(bok_ts, do.lines=FALSE) +\n  xlab(\"Lags\") + ylab(\"Rate (%)\") +\n  ggtitle(\"Lag Plots — Bank of Korea Base Rate\") +\n  theme(axis.text.x=element_text(angle=45, hjust=1)) + theme_bw()\n\n\n\n\n\n\n\n\n\nThere is clear diagonal and tight clustering at lags 1–3 (strong positive autocorrelation). From about lag 4 onward the points spread and the diagonal weakens, having weak autocorrelation.\n\n\n\n\nCode\nusr_ts &lt;- ts(usr$rate, start = c(year(min(usr$Date)), month(min(usr$Date))), end = c(year(max(usr$Date)), month(max(usr$Date))),frequency=4)\n\ngglagplot(usr_ts, do.lines=FALSE) +\n  xlab(\"Lags\") + ylab(\"Rate (%)\") +\n  ggtitle(\"Lag Plots — U.S. Federal Funds Rate\") \n\n\n\n\n\n\n\n\n\nThere is strong diagonal at short lags, with values clustering at a few levels. After ~lag 4–5 the diagonal fades and scatter increases weaker, which in further lag, it seems that it has no autocorrelation.\n\n\n\n\nCode\nkr_ts&lt;- ts(kr$usd, frequency = 252, start = c(year(min(kr$Date)), month(min(kr$Date))), end = c(year(max(kr$Date)), month(max(kr$Date))))\ngglagplot(kr_ts, do.lines=FALSE) +\n  ggtitle(\"Lag Plots — KRW/USD FX rate\")+\n          xlab(\"Lags\")+ylab(\"KRW/USD FX rate\")\n\n\n\n\n\n\n\n\n\nThere is tight diagonal in every panel across all lags which means very high persistent autocorrelation for all lags.\n\n\n\n\nCode\nimport_ts&lt;- ts(imports$USD, frequency = 12, start = c(year(min(imports$Date)), month(min(imports$Date))), end = c(year(max(imports$Date)), month(max(imports$Date))))\ngglagplot(import_ts, do.lines=FALSE) +\n    ggtitle(\"Lag Plots — trade import South korea vs USA\")+\n          xlab(\"Lags\")+ylab(\"Trade import value\")\n\n\n\n\n\n\n\n\n\nThere is Pronounced diagonal through short–mid lags . At longer lags the diagonal remains but is wider which means positive but weakening autocorrelation.\n\n\n\n\nCode\nexport_ts&lt;- ts(exports$USD, frequency = 12, start = c(year(min(exports$Date)), month(min(exports$Date))), end = c(year(max(exports$Date)), month(max(exports$Date))))\ngglagplot(export_ts, do.lines=FALSE) +\n ggtitle(\"Lag Plots — trade export South korea vs USA\")+\n          xlab(\"Lags\")+ylab(\"Trade export value\")\n\n\n\n\n\n\n\n\n\nThere is Pronounced diagonal through short–mid lags . At longer lags the diagonal remains but is wider which means positive but weakening autocorrelation. It seems export has stronger autocorrelation than import for all plots.\n\n\n\n\nCode\nyield_3y_ts&lt;- ts(df$US_KR_3Y, frequency = 252, start = c(year(min(df$Date)), month(min(df$Date))), end = c(year(max(df$Date)), month(max(df$Date))))\ngglagplot(yield_3y_ts, do.lines=FALSE) +\n  ggtitle(\"Lag Plots — USA & South korea yield spread rate(3y)\")+\n          xlab(\"Lags\")+ylab(\"yield % \")\n\n\n\n\n\n\n\n\n\nThere is high autocorrelation across lags, with slightly more dispersion than the 10-year series.\n\n\n\n\nCode\nyield_10y_ts&lt;- ts(df$US_KR_10Y, frequency = 252, start = c(year(min(df$Date)), month(min(df$Date))), end = c(year(max(df$Date)), month(max(df$Date))))\ngglagplot(yield_10y_ts, do.lines=FALSE) +\n  ggtitle(\"Lag Plots — USA & South korea yield spread rate(10y)\")+\n          xlab(\"Lags\")+ylab(\"yield % \")\n\n\n\n\n\n\n\n\n\nDiagonal stays crisp across nearly all lags which has strong and long-horizon autocorrelation.\n\n\n\n\nCode\n#house_ts&lt;- ts(housing$housing, frequency = 12, start = c(year(min(housing$Date))))\nhouse_ts&lt;- ts(housing$housing, frequency = 12, start = c(year(min(housing$Date)), month(min(housing$Date))), end = c(year(max(housing$Date)), month(max(housing$Date))))\ngglagplot(house_ts, do.lines=FALSE) +\n    ggtitle(\"Lag Plots — seoul housing property index\")+\n          xlab(\"Lags\")+ylab(\"Seoul House index\") +\n          theme(axis.text.x=element_text(angle=45, hjust=1))\n\n\n\n\n\n\n\n\n\nThere is strong near-linear relationship at every lag; slight curvature at higher lags.\n\n\n\n\nCode\nusd_ts_log &lt;- ts(log(usd$usd_index), start = c(year(min(usd$Date)), month(min(usd$Date))), end = c(year(max(usd$Date)), month(max(usd$Date))), frequency = 252)\n#usd_ts_log &lt;- ts(log(usd$usd_index), start=min(usd$Date), frequency=252)\n\ngglagplot(usd_ts_log, do.lines=FALSE) +\n  ggtitle(\"Lag Plots — USD index (log)\")+\n          xlab(\"Lags\")+ylab(\"USD index\") +\n          theme(axis.text.x=element_text(angle=45, hjust=1))\n\n\n\n\n\n\n\n\n\nThere is tight diagonal in every panel across all lags which means very high persistent autocorrelation for all lags.\n\n\n\n\nCode\nkospi_ts_log &lt;- ts(log(kospi$Close), start = c(year(min(kospi$Date)), month(min(kospi$Date))), end = c(year(max(kospi$Date)), month(max(kospi$Date))), frequency = 252)\n\ngglagplot(kospi_ts_log, do.lines=FALSE) +\n  xlab(\"Lags\") + ylab(\"log(Price)\") +\n  ggtitle(\"Lag Plots — KOSPI (log)\") \n\n\n\n\n\n\n\n\n\nWhile there are some point that are off the line, but in general it is tight diagonal in every panel across all lags which means very high persistent autocorrelation for all lags.\n\n\n\n\nCode\nsp_ts_log &lt;- ts(log(sp500$Close), start = c(year(min(sp500$Date)), month(min(sp500$Date))), end = c(year(max(sp500$Date)), month(max(sp500$Date))), frequency = 252)\n                                              \ngglagplot(sp_ts_log, do.lines=FALSE) +\n  xlab(\"Lags\") + ylab(\"log(Price)\") +\n  ggtitle(\"Lag Plots — S&P 500 (log)\") +\n  theme(axis.text.x=element_text(angle=45, hjust=1)) + theme_bw()\n\n\n\n\n\n\n\n\n\nThere is tight diagonal in every panel across all lags which means very high persistent autocorrelation for all lags.\n\n\n\n\n\nDecomposition\n\nSouth korea base rateFederal Reserve rateKRW/USD FX ratetrade import South Korea vs USAtrade export South Korea vs USAUSA & South korea yield spread rate(3y)USA & South korea yield spread rate(10y)seoul housing property indexUSD indexKOSPI indexS&P500 index\n\n\n\n\nCode\nbok_stl &lt;- stl(bok_ts, s.window = \"periodic\", robust = TRUE)\nautoplot(bok_stl) +\n  labs(title = \"STL Decomposition — BOK Base Rate (Additive)\",\n       x = \"Date\", y = \"Rate (%)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThe decomposition is dominated by a smooth trend that drifts down from the mid-2000s into 2019–21, then inflects upward as policy tightens post-pandemic. The seasonal component is very small and roughly constant through time—its amplitude doesn’t expand when the level is higher—so it reads like a nuisance wiggle rather than a percentage effect. The remainder captures a few localized shocks (notably around 2009 and 2023) with variance that doesn’t scale with the policy level. Those cues point to an additive specification in levels.\n\n\n\n\nCode\nusr_stl &lt;- stl(usr_ts, s.window = \"periodic\", robust = TRUE)\nautoplot(usr_stl) +\n  labs(title = \"STL Decomposition — US Fed Funds (Additive)\",\n       x = \"Date\", y = \"Rate (%)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThe trend captures long tightening/easing cycles: near-zero from 2009–2015, hiking into 2019, a pandemic reset in 2020, and the rapid 2022–2023 liftoff. Seasonality is negligible and does not grow with the level—typical of policy rates that move in discrete steps rather than proportional swings. The remainder is episodic (crisis windows) but its magnitude is broadly stable in absolute terms. That pattern supports an additive decomposition.\n\n\n\n\nCode\ndecompose_kr_ts&lt;- decompose(kr_ts)\nautoplot(decompose_kr_ts,main = \"decomposition: KRW/USD FX rate\")\n\n\n\n\n\n\n\n\n\nThe trend reflects multi-year won weakness/strength cycles, with standout moves in 2008–09 and again around 2022. Seasonality is mild and appears roughly constant in absolute size; it doesn’t fan out as the level drifts, so an additive form is better option.\n\n\n\n\nCode\ndecompose_import_ts&lt;- decompose(import_ts)\nautoplot(decompose_import_ts,main = \"decomposition: trade import South Korea vs USA\")\n\n\n\n\n\n\n\n\n\nCode\ndecompose_import_ts1&lt;- decompose(export_ts,\"multiplicative\")\nautoplot(decompose_import_ts1,main = \"decomposition: trade import South Korea vs USA(multiplicative)\")\n\n\n\n\n\n\n\n\n\nThe trend shows a secular rise with cyclical dents (late 1990s, GFC, 2020) consistent with globalization and demand cycles. In levels, the seasonal pattern clearly widens over time and the remainder becomes more volatile as the series grows—classic heteroskedasticity that violates additive assumptions. On a multiplicative scale, seasonality becomes approximately constant in percentage terms, and the remainder tightens around zero. This yields a cleaner, more interpretable decomposition for strictly positive, growing trade flows.\n\n\n\n\nCode\ndecompose_export_ts&lt;- decompose(export_ts)\nautoplot(decompose_export_ts,main = \"decomposition: trade export South Korea vs USA(additive)\")\n\n\n\n\n\n\n\n\n\nCode\ndecompose_export_ts1&lt;- decompose(export_ts,\"multiplicative\")\nautoplot(decompose_export_ts1,main = \"decomposition: trade export South Korea vs USA(multiplicative)\")\n\n\n\n\n\n\n\n\n\nExports exhibit a strong upward trend with cyclical pauses and a noticeable surge post-2016 before cooling. The additive view shows seasonality and residual variance that expand alongside the level, indicating proportional—not absolute—effects. Switching to multiplicative stabilizes both, turning the seasonal shape into a near-constant proportion of the level and shrinking the remainder to a level-invariant band. That makes inference about turning points in the trend more reliable.\n\n\n\n\nCode\ndecompose_3y_ts&lt;- decompose(yield_3y_ts)\nautoplot(decompose_3y_ts,main = \"decomposition: USA & South korea yield spread rate(3y)\")\n\n\n\n\n\n\n\n\n\nThe trend meanders from negative values in the early 2000s toward positive territory around the late 2010s before sliding again, mirroring cross-country policy cycles and term-structure dynamics. Because the series crosses zero and can be negative, multiplicative models are not meaningful here. The seasonal component is modest and stable; the remainder features short bursts of volatility (pandemic, 2023) that don’t scale with the spread’s absolute level. An additive decomposition is therefore appropriate.\n\n\n\n\nCode\ndecompose_10y_ts&lt;- decompose(yield_10y_ts)\nautoplot(decompose_10y_ts,main =  \"decomposition: USA & South korea yield spread rate(10y)\")\n\n\n\n\n\n\n\n\n\nThere is upward trend through the mid-2010s gives way to a more pronounced decline after 2021, highlighting shifts in long-run rate differentials. As with the 3-year, the spread can be near or below zero, which rules out multiplicative forms. Seasonality is small, and the remainder shows occasional spikes that are fairly constant in absolute magnitude. The overall structure fits best with an additive model.\n\n\n\n\nCode\ndecompose_housing_ts&lt;- decompose(house_ts)\nautoplot(decompose_housing_ts,main = \"decomposition: Seoul housing property index\" )\n\n\n\n\n\n\n\n\n\nThe trend rises steadily, quickening around 2019–2021 before easing, while the seasonal component stays roughly the same amplitude across the sample, not widening as the index level increases. That constancy in absolute seasonal size argues for an additive form rather than multiplicative. The remainder shows episodic bumps—policy moves and sentiment shifts—but its variance doesn’t systematically scale with the level, so an additive decomposition cleanly separates the smooth trend\n\n\n\n\nCode\ndecompose_usd_ts&lt;- decompose(usd_ts_log)\nautoplot(decompose_usd_ts, main= \"decomposition: USD index\")\n\n\n\n\n\n\n\n\n\nThe trend captures well-known dollar cycles (strong mid-1980s, mid-2010s; softer interludes) while the seasonal component is persistent but proportionate to the level. In raw levels, the remainder tends to be larger when the index is higher; logging or using a multiplicative form evens that out. Decomposing multiplicatively yields cleaner inference: seasonality as a percent swing and a remainder that is closer to level-invariant.\n\n\n\n\nCode\ndecompose_kospi_ts&lt;- decompose(kospi_ts_log)\nautoplot(decompose_kospi_ts,main = \"decomposition: KOSPI index\")\n\n\n\n\n\n\n\n\n\nThe trend reflects a secular climb punctuated by sharp drawdowns (GFC, COVID, 2022–23). Equity markets exhibit volatility clustering and proportional variation: the seasonal and remainder amplitudes grow as the level rises. On logs (or multiplicatively), the seasonal share becomes roughly constant and the residual shocks are better behaved. This improves signal extraction around turning points and reduces spurious variance in the remainder.\n\n\n\n\nCode\ndecompose_sp_ts&lt;- decompose(sp_ts_log)\nautoplot(decompose_sp_ts,main = \"decomposition: S&P500 index\" )\n\n\n\n\n\n\n\n\n\nA strong upward trend dominates, with pauses and breaks around 2000–02, 2008–09, and 2020 before resuming higher. Seasonality is small but inherently proportional in equity prices, and the remainder is much noisier in bull markets when viewed in levels. A multiplicative/log-additive decomposition stabilizes variance, rendering seasonality as a constant percentage and isolating shocks without level-driven inflation of the residual. This specification typically produces the most interpretable components for stock indices.\n\n\n\n\n\nACF & PACF plot\n\nSouth korea base rateFederal Reserve RateKRW/USD FX ratetrade import South Korea vs USAtrade export South Korea vs USAUSA & South Korea yield spread rate(3Y)USA & South Korea yield spread rate(10Y)Seoul housing property indexUSD indexKOSPI indexS&P500 index\n\n\n\n\nCode\nggAcf(bok_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of South Korea base rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(bok_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of South Korea base rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows a very slow, gradual decay with high correlations extending well beyond lag 20, remaining above 0.25 throughout. The PACF shows a single strong spike at lag 1 of approximately 0.95, then cuts off sharply afterward with all subsequent lags staying within the confidence bounds. This is a classic signature of a highly persistent autoregressive process. This series is clearly non-stationary. The slow decay in the ACF is a classic signature of a unit root or near-unit root process. The PACF pattern suggests an AR(1) process with a coefficient very close to 1, indicating a random walk or highly persistent process. This makes economic sense as central banks adjust interest rates gradually rather than making abrupt changes. First differencing would be needed to achieve stationarity\n\n\n\n\nCode\nggAcf(usr_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of Federal Reserve Rate \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(usr_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of Federal Reserve Rate \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows slow decay similar to the South Korea rate, though slightly faster, with correlations gradually declining but remaining substantial even at longer lags. The PACF shows a dominant spike at lag 1 of approximately 0.95, with subsequent lags mostly within bounds, though there are some minor scattered exceedances at longer lags. This series is also non-stationary with similar characteristics to the South Korea rate. The persistent autocorrelation indicates the series has memory and trends, which aligns with how the Federal Reserve conducts monetary policy through gradual adjustments. The slow decay pattern confirms that the series doesn’t revert to a mean quickly. Differencing is required for stationarity before any modeling can proceed.\n\n\n\n\nCode\nggAcf(kr_ts,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of KRW/USD FX rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(kr_ts,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of  KRW/USD FX rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows extremely strong persistence with correlations near 1.0 extending across all 50+ lags with barely any decay visible. The PACF shows a massive spike at lag 1 of approximately 1.0, followed by an immediate and complete cutoff with all other lags remaining within the confidence bounds. This is perhaps the clearest example of a pure random walk in the dataset. This series is strongly non-stationary and represents an almost perfect random walk. The ACF barely decays at all, which is characteristic behavior for exchange rates in floating rate regimes. Exchange rates typically follow random walk processes as they respond to news and changing economic conditions without mean reversion. This series definitely requires first differencing, or preferably a returns transformation, to achieve stationarity.\n\n\n\n\nCode\nggAcf(import_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of trade import South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(import_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of trade import South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows very high initial values with slow decay, remaining above 0.7 even at lag 24, indicating strong persistence in the series. The PACF shows a very strong spike at lag 1 of approximately 0.95, then a smaller but still significant spike at lag 2, followed by scattered minor spikes at various longer lags within or just outside the confidence bounds. This series is non-stationary with strong persistence. The PACF suggests this might be an AR(2) process in differences, or possibly requires seasonal differencing given the trade data nature. Trade flows typically have both trend components and potential seasonal patterns. First differencing is recommended, and you may want to check for seasonal patterns that would require additional seasonal differencing or adjustment.\n\n\n\n\nCode\nggAcf(export_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of trade export South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(export_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of trade export South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF pattern is very similar to the import series, showing slow decay with high persistence and correlations remaining elevated throughout the lag structure. The PACF shows a dominant lag 1 spike of approximately 0.95, a smaller but noticeable lag 2 spike, and then mostly lags within bounds with occasional minor exceedances at longer lags. This series is non-stationary with characteristics nearly identical to the import series. This similarity makes economic sense as exports and imports often move together and share common trends related to economic cycles and bilateral trade relationships. First differencing is needed, and like the import series, you should consider checking for seasonal patterns that might require additional treatment beyond simple first differencing.\n\n\n\n\nCode\nggAcf(yield_3y_ts,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of USA & South Korea yield spread rate(3Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(yield_3y_ts,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of USA & South Korea yield spread rate(3Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows extremely high persistence with correlations remaining near 1.0 across all 50 lags, displaying almost no decay whatsoever. The PACF shows a dominant spike at lag 1 of approximately 0.99, followed by a small spike at lag 2, after which all subsequent lags remain within the confidence bounds. This represents one of the most persistent series in the dataset. This series is clearly non-stationary and exhibits random walk behavior. The yield spread between the two countries appears to drift over time without any mean reversion, possibly reflecting changing perceptions of relative risk, monetary policy divergence, or capital flow patterns. First differencing is absolutely required before any modeling can be performed on this series.\n\n\n\n\nCode\nggAcf(yield_10y_ts,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of USA & South Korea yield spread rate(10Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(yield_10y_ts,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of USA & South Korea yield spread rate(10Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF pattern is nearly identical to the 3Y spread, showing very high persistence across all lags with correlations staying close to 1.0 throughout the entire lag structure. The PACF displays the same structure with a strong lag 1 spike of approximately 0.99, a smaller but noticeable lag 2 spike, and then a sharp cutoff with all remaining lags within bounds. This series is strongly non-stationary. Both the 3Y and 10Y spreads show identical non-stationary behavior, which suggests persistent divergences or convergences in the yield curves between the two countries driven by common factors. The similarity between the two maturities suggests they might be cointegrated. This series requires first differencing before it can be used in any time series models.\n\n\n\n\nCode\nggAcf(house_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of Seoul housing  property index \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(house_ts) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of Seoul housing  property index \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows a slow, linear decay pattern starting from about 0.98 and gradually declining to approximately 0.55 by lag 24, representing moderately fast decay compared to financial indices. The PACF displays a massive spike at lag 1 of about 0.98, after which all subsequent lags remain comfortably within the confidence bounds with no other significant spikes visible. This series is non-stationary as expected for real estate price indices, which typically trend upward over time due to population growth, income increases, and inflation. The decay in the ACF is somewhat faster than pure financial indices, possibly reflecting some degree of mean reversion in housing markets. First differencing is needed before modeling this series, and seasonal adjustment might also be worth considering.\n\n\n\n\nCode\nggAcf(usd_ts_log,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of USD index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(usd_ts_log,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of USD index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows near-perfect persistence with correlations at 1.0 extending uniformly across all 50+ lags without any visible decay throughout the entire range. The PACF displays an almost perfect spike at lag 1 approaching 1.0, followed by an immediate and complete cutoff to values near zero for all remaining lags. This is perhaps the most extreme example of random walk behavior in the entire dataset. This series is extremely non-stationary, exhibiting textbook random walk characteristics. Dollar indices tend to follow this pattern as they drift based on relative monetary policy stances, economic conditions across countries, and international capital flows. The complete lack of mean reversion indicates the dollar’s value can move in any direction for extended periods. First differencing or computing log returns is definitely required before any analysis or modeling can proceed.\n\n\n\n\nCode\nggAcf(kospi_ts_log,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of KOSPI index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(kospi_ts_log,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of KOSPI index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows extremely high persistence with correlations remaining near 1.0 across all 50 lags without meaningful decay, indicating very strong memory in the series. The PACF displays a dominant lag 1 spike of approximately 0.99 followed by an immediate cutoff, with all subsequent lags staying within the confidence bounds. This is the standard pattern observed for equity price indices worldwide. This series is strongly non-stationary, which is typical behavior for stock market indices. Like most equity indices worldwide, KOSPI follows a random walk with long-term upward trends reflecting economic growth and corporate earnings expansion, but no reversion to a fixed mean level. First differencing is required, though using log returns would be even better for financial analysis purposes as they have better statistical properties.\n\n\n\n\nCode\nggAcf(sp_ts_log,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"ACF of S&P500 index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(sp_ts_log,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"PACF of S&P500 index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF pattern is virtually identical to the KOSPI, showing near-perfect persistence with correlations at 1.0 across all lags without any visible decay. The PACF shows the characteristic lag 1 spike of approximately 1.0 with a sharp, immediate cutoff afterward. All remaining lags stay comfortably within the confidence bounds, confirming the unit root structure typical of equity indices. This series is strongly non-stationary and exhibits classic random walk behavior identical to the KOSPI. This similarity confirms that equity indices worldwide share common stochastic properties regardless of the specific market or country, reflecting the general nature of stock prices. First differencing or log returns are required before any modeling, with log returns being strongly preferred for financial applications due to their better distributional properties and interpretation as continuously compounded returns.\n\n\n\n\n\nAugmented Dickey-Fuller Test\n\nSouth korea base rateFederal Reserve rateKRW/USD FX ratetrade import South Korea vs USAtrade export South Korea vs USAUSA & South korea yield spread rate(3y)USA & South korea yield spread rate(10y)seoul housing property indexUSD indexKOSPI indexS&P500 index\n\n\n\n\nCode\nadf.test(bok_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  bok_ts\nDickey-Fuller = -1.6484, Lag order = 4, p-value = 0.7225\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(usr_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  usr_ts\nDickey-Fuller = -2.6475, Lag order = 4, p-value = 0.308\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(kr_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  kr_ts\nDickey-Fuller = -2.0722, Lag order = 22, p-value = 0.5478\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(import_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  import_ts\nDickey-Fuller = -2.9309, Lag order = 7, p-value = 0.1841\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(export_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  export_ts\nDickey-Fuller = -2.0023, Lag order = 7, p-value = 0.5762\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(yield_3y_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  yield_3y_ts\nDickey-Fuller = -1.7543, Lag order = 18, p-value = 0.6824\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(yield_10y_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  yield_10y_ts\nDickey-Fuller = -2.7481, Lag order = 18, p-value = 0.2615\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(house_ts)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  house_ts\nDickey-Fuller = -2.556, Lag order = 6, p-value = 0.3418\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(usd_ts_log)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  usd_ts_log\nDickey-Fuller = -2.1606, Lag order = 22, p-value = 0.5103\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(kospi_ts_log)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  kospi_ts_log\nDickey-Fuller = -1.24, Lag order = 19, p-value = 0.9001\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(sp_ts_log)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  sp_ts_log\nDickey-Fuller = -1.758, Lag order = 20, p-value = 0.6809\nalternative hypothesis: stationary\n\n\n\n\n\nFor all plots, the p-value is greater than 0.05, which fails to reject null hypothesis. This means, all the plots are non-stationary. So, conducting further approach is required to ensure that each plots can become stationary. This aligns with what all of our ACF/PACF plots shows.\n\n\nDifferencing\n\nSouth korea base rateFederal Reserve RateKRW/USD FX ratetrade import South Korea vs USAtrade export South Korea vs USAUSA & South Korea yield spread rate(3Y)USA & South Korea yield spread rate(10Y)Seoul housing property indexUSD indexKOSPI indexS&P500 index\n\n\n\n\nCode\nbok_diff&lt;- diff(bok_ts)\nggAcf(bok_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of South Korea base rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(bok_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of South Korea base rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows a significant spike at lag 1 of approximately 0.37, followed by smaller spikes at lags 2-3, with some negative correlations appearing around lags 8-11. Most lags beyond lag 3 remain within the confidence bounds. The PACF shows a dominant spike at lag 1, followed by scattered smaller spikes at various lags including around lag 13. Overall, most correlations have diminished substantially compared to the original series. After first differencing, this series appears to be closer to stationarity.\n\n\n\n\nCode\nusr_diff&lt;- diff(usr_ts)\n\nggAcf(usr_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of Federal Reserve Rate \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(usr_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of Federal Reserve Rate \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF displays significant positive spikes at lags 1, 2, and 3 (around 0.6, 0.5, and 0.35 respectively), followed by several negative spikes around lags 7-11. The pattern shows a slow oscillating decay. The PACF shows a very large spike at lag 1 and then most other lags remain within bounds, with some scattered minor exceedances. This pattern differs noticeably from the South Korea rate. This series shows evidence of remaining non-stationarity or strong autocorrelation even after first differencing.\n\n\n\n\nCode\nkr_diff&lt;- diff(kr_ts)\n\nggAcf(kr_diff,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of KRW/USD FX rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(kr_diff,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of  KRW/USD FX rate\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows many small spikes scattered throughout the lags, with most staying within or just barely outside the confidence bounds. The correlations appear fairly random with no clear pattern, hovering close to zero. The PACF displays a similar pattern with multiple small spikes at various lags (notably around lags 8, 20, 27, 38, and 42), but most remain small in magnitude and many are within the confidence bounds. This differenced series appears to be stationary and close to white noise. The lack of strong patterns in both ACF and PACF suggests that first differencing has successfully removed the non-stationary component.\n\n\n\n\nCode\nimport_diff &lt;- diff(import_ts)\n\nggAcf(import_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of trade import South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(import_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of trade import South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows a very large negative spike at lag 1 (approximately -0.45), followed by mostly random small spikes that stay within confidence bounds. The PACF displays an extremely large negative spike at lag 1 (nearly -0.5), with most other lags remaining within bounds except for a few minor exceedances at lags around 6, 8, and 23. This series appears stationary after differencing but exhibits strong negative autocorrelation.\n\n\n\n\nCode\nexport_diff &lt;- diff(export_ts)\n\nggAcf(export_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of trade export South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(export_diff) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of trade export South Korea vs USA\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows significant positive spikes at lags 5 and 12, and a significant spike at lag 24, suggesting potential seasonal patterns. Most other lags remain within bounds with scattered minor exceedances. The PACF shows positive spikes at lags 5, 12, and 24, with most other lags within bounds, reinforcing the suggestion of seasonality in the data. This series appears stationary after first differencing, but exhibits clear seasonal patterns.\n\n\n\n\nCode\nyield_3y_ts_diff &lt;- diff(yield_3y_ts)\n\nggAcf(yield_3y_ts_diff,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of USA & South Korea yield spread rate(3Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(yield_3y_ts_diff,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of USA & South Korea yield spread rate(3Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows a very large negative spike at lag 1 (approximately -0.12), with all other lags appearing as small random fluctuations within the confidence bounds. The PACF displays a similar pattern with a large negative spike at lag 1 and all other lags remaining comfortably within bounds. The correlations are much smaller in magnitude compared to the interest rate series. This series appears stationary after first differencing.\n\n\n\n\nCode\nyield_10y_ts_diff &lt;- diff(yield_10y_ts)\n\nggAcf(yield_10y_ts_diff,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of USA & South Korea yield spread rate(10Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(yield_10y_ts_diff,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of USA & South Korea yield spread rate(10Y)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows a large negative spike at lag 1 (approximately -0.11), with scattered small spikes throughout but most remaining within bounds. There are some notable spikes around lags 8, 40-42, and 49. The PACF shows a similar large negative spike at lag 1, with most other lags within bounds except for some minor exceedances at longer lags around 40-50. This series is stationary after first differencing, very similar to the 3Y spread.\n\n\n\n\nCode\nhouse_dlog &lt;- diff(house_ts)\n\nggAcf(house_dlog) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of Seoul housing  property index \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(house_dlog) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of Seoul housing  property index \") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows a very large positive spike at lag 1 (approximately 0.87), followed by strong positive spikes at lags 2 (0.70) and 3 (0.52), with a clear exponential decay pattern continuing through about lag 7. After lag 7, correlations become small but some remain just outside bounds. The PACF shows a massive spike at lag 1 (around 0.87) and then all subsequent lags remain within the confidence bounds. This series seems NOT stationary even after first differencing. The extremely high lag 1 autocorrelation and slow decay in the ACF strongly suggest that first differencing was insufficient. For this, second order differencing will be conducted later.\n\n\n\n\nCode\n#log\n\nusd_dlog &lt;- diff(usd_ts_log) \n\nggAcf(usd_dlog,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of USD index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(usd_dlog,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of USD index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows small correlations scattered throughout all lags, with most remaining within the confidence bounds. There are a few lags that barely exceed the bounds (notably around lags 1, 20, and 30), but the magnitudes are very small (all under 0.04). The PACF displays a similar pattern with many small spikes scattered across lags, with a couple just exceeding the bounds around lags 1, 20, and 30, but again all are small in magnitude. This differenced series appears to be stationary. The lack of any strong patterns in both ACF and PACF, combined with the very small magnitudes of all correlations, suggests that first differencing has successfully removed the non-stationary component.\n\n\n\n\nCode\n#log\n\nkospi_dlog &lt;- diff(kospi_ts_log) \n\nggAcf(kospi_dlog,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of KOSPI index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(kospi_dlog,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of KOSPI index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows small positive correlations at various lags, with no strong decay pattern. Most lags remain within bounds, though there are noticeable spikes at lags around 1, 12-13, and 48-49, all staying relatively small in magnitude (under 0.03). The PACF shows a similar scattered pattern with small spikes throughout, with slightly larger ones at lags 1, 12, and 48, but most correlations are close to zero and within the confidence bounds. This differenced series appears to be stationary. The correlations are all very small, suggesting that first differencing has effectively removed the trend component.\n\n\n\n\nCode\n#log \n\nsp_dlog &lt;- diff(sp_ts_log) \n\nggAcf(sp_dlog,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"blue\") +\n  labs(title = \"Differenced: ACF of S&P500 index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCode\nggPacf(sp_dlog,lag.max = 50) +\n  geom_segment(aes(xend = lag, yend = 0), color=\"red\") +\n  labs(title = \"Differenced: PACF of S&P500 index\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nThe ACF shows small correlations scattered across all lags with no clear decay pattern. There are a few notable spikes that exceed the confidence bounds at lags around 7, 13, 15, 28, and 47, but all remain small in magnitude (under 0.03). Most lags are very close to zero. The PACF displays a similar pattern with scattered small spikes, including some that exceed bounds at lags 7, 13, 15, 28, and 32, but again all are small in magnitude. This differenced series appears to be stationary. Like the KOSPI, the S&P500 in differences shows very weak autocorrelation patterns, consistent with efficient market behavior.\n\n\n\n\n\nAugmented Dickey-Fuller Test after differencing\n\nSouth korea base rateFederal Reserve rateKRW/USD FX ratetrade import South Korea vs USAtrade export South Korea vs USAUSA & South korea yield spread rate(3y)USA & South korea yield spread rate(10y)seoul housing property indexUSD indexKOSPI indexS&P500 index\n\n\n\n\nCode\nadf.test(bok_diff)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  bok_diff\nDickey-Fuller = -4.7709, Lag order = 4, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(usr_diff)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  usr_diff\nDickey-Fuller = -4.6918, Lag order = 4, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(kr_diff)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  kr_diff\nDickey-Fuller = -17.413, Lag order = 22, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(import_diff)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  import_diff\nDickey-Fuller = -9.3481, Lag order = 7, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(export_diff)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  export_diff\nDickey-Fuller = -8.1974, Lag order = 7, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(yield_3y_ts_diff)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  yield_3y_ts_diff\nDickey-Fuller = -19.172, Lag order = 18, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(yield_10y_ts_diff)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  yield_10y_ts_diff\nDickey-Fuller = -18.933, Lag order = 18, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(house_dlog)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  house_dlog\nDickey-Fuller = -4.2819, Lag order = 6, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(usd_dlog)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  usd_dlog\nDickey-Fuller = -20.949, Lag order = 22, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(kospi_dlog)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  kospi_dlog\nDickey-Fuller = -19.46, Lag order = 19, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\n\nCode\nadf.test(sp_dlog)\n\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  sp_dlog\nDickey-Fuller = -21.152, Lag order = 20, p-value = 0.01\nalternative hypothesis: stationary\n\n\n\n\n\nFor all plots, the p-value is greater than 0.05, which fails to reject null hypothesis. This means, all the plots are non-stationary. So, conducting further approach is required to ensure that each plots can become stationary. This aligns with what all of our ACF/PACF plots shows except seoul housing index, which second order will be conducted(in univariate section) for accurate result.\n\n\nMoving Average\n\nSouth Korea base rateFederal Reserve rateKRW/USD FX ratetrade import South Korea vs USAtrade export South Korea vs USAUSA & South korea yield spread rate(3y)USA & South korea yield spread rate(10y)seoul housing property indexUSD indexKOSPI indexS&P500 index\n\n\n\n\nCode\ndates  &lt;- as.Date(as.yearqtr(time(bok_ts)))            \nbok_df &lt;- data.frame(Date = dates, Value = as.numeric(bok_ts)) \nbok_df$MA3 &lt;- rollmean(bok_df$Value, 3, fill = NA, align = \"right\")\nbok_df$MA6 &lt;- rollmean(bok_df$Value,6, fill = NA, align = \"right\")\nbok_df$MA12 &lt;- rollmean(bok_df$Value, 12, fill = NA, align = \"right\")\n\nplot_ly(bok_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"South Korea base rate\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA3, name = \"MA3\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA6, name = \"MA6\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA12, name = \"MA12\", line = list(color = \"green\")) %&gt;%\n  layout(title = \" South Korea base rate with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Rate (%)\"))\n\n\n\n\n\n\n\n\n\n\nCode\ndates  &lt;- as.Date(as.yearqtr(time(usr_ts)))              \nusr_df &lt;- data.frame(Date = dates, Value = as.numeric(usr_ts))  \n\nusr_df$MA3 &lt;- rollmean(usr_df$Value, 3, fill = NA, align = \"right\")\nusr_df$MA6 &lt;- rollmean(usr_df$Value,6, fill = NA, align = \"right\")\nusr_df$MA12 &lt;- rollmean(usr_df$Value, 12, fill = NA, align = \"right\")\n\nplot_ly(usr_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"Federal Reserve rate\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA3, name = \"MA3\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA6, name = \"MA6\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA12, name = \"MA12\", line = list(color = \"green\")) %&gt;%\n  layout(title = \" Federal Reserve rate with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Rate (%)\"))\n\n\n\n\n\n\n\n\n\n\nCode\nkr_ts &lt;- ts(kr$usd,\n            start = c(year(min(kr$Date)), 1),\n            frequency = 252)\n\nkr_df &lt;- data.frame(Date = kr$Date, Value = as.numeric(kr_ts))\n\nkr_df$MA50 &lt;- rollmean(kr_df$Value, 50, fill = NA, align = \"right\")\nkr_df$MA100 &lt;- rollmean(kr_df$Value, 100, fill = NA, align = \"right\")\nkr_df$MA200 &lt;- rollmean(kr_df$Value, 200, fill = NA, align = \"right\")\n\nplot_ly(kr_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"KRW/USD spot rate\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA50, name = \"MA50\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA100, name = \"MA100\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA200, name = \"MA200\", line = list(color = \"green\")) %&gt;%\n  layout(title = \" KRW/USD spot rate with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"KRW/USD\"))\n\n\n\n\n\n\n\n\n\n\nCode\ndates &lt;- as.Date(as.yearmon(time(import_ts)))             \nimport_df &lt;- data.frame(Date = dates, Value = as.numeric(import_ts))  \nimport_df$MA12 &lt;- rollmean(import_df$Value, 12, fill = NA, align = \"right\")\nimport_df$MA24 &lt;- rollmean(import_df$Value, 24, fill = NA, align = \"right\")\nimport_df$MA36 &lt;- rollmean(import_df$Value, 36, fill = NA, align = \"right\")\n\nplot_ly(import_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"trade import South Korea vs USA\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA12, name = \"MA12\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA24, name = \"MA24\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA36, name = \"MA36\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"Trade import South Korea vs USA with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"trade import South Korea vs USA\"))\n\n\n\n\n\n\n\n\n\n\nCode\ndates &lt;- as.Date(as.yearmon(time(export_ts)))              \nexport_df &lt;- data.frame(Date = dates, Value = as.numeric(export_ts)) \nexport_df$MA12 &lt;- rollmean(export_df$Value, 12, fill = NA, align = \"right\")\nexport_df$MA24 &lt;- rollmean(export_df$Value, 24, fill = NA, align = \"right\")\nexport_df$MA36 &lt;- rollmean(export_df$Value, 36, fill = NA, align = \"right\")\n\nplot_ly(export_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"trade export South Korea vs USA\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA12, name = \"MA12\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA24, name = \"MA24\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA36, name = \"MA36\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"Trade export South Korea vs USA with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"trade export South Korea vs USA\"))\n\n\n\n\n\n\n\n\n\n\nCode\nyield_3y_ts &lt;- ts(df$US_KR_3Y,\n            start = c(year(min(df$Date)), 1),\n            frequency = 252)\n\nyield_3y_df &lt;- data.frame(Date = df$Date, Value = as.numeric(yield_3y_ts))\n\nyield_3y_df$MA50 &lt;- rollmean(yield_3y_df$Value, 50, fill = NA, align = \"right\")\nyield_3y_df$MA100 &lt;- rollmean(yield_3y_df$Value, 100, fill = NA, align = \"right\")\nyield_3y_df$MA200 &lt;- rollmean(yield_3y_df$Value, 200, fill = NA, align = \"right\")\n\nplot_ly(yield_3y_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"USA & South korea yield spread rate(3y)\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA50, name = \"MA50\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA100, name = \"MA100\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA200, name = \"MA200\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"USA & South korea yield spread rate(3y) with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Rate (%)\"))\n\n\n\n\n\n\n\n\n\n\nCode\nyield_10y_ts &lt;- ts(df$US_KR_10Y,\n            start = c(year(min(df$Date)), 1),\n            frequency = 252)\nyield_10y_df &lt;- data.frame(Date = df$Date, Value = as.numeric(yield_10y_ts))\n\n\nyield_10y_df$MA50 &lt;- rollmean(yield_3y_df$Value, 50, fill = NA, align = \"right\")\nyield_10y_df$MA100 &lt;- rollmean(yield_3y_df$Value, 100, fill = NA, align = \"right\")\nyield_10y_df$MA200 &lt;- rollmean(yield_3y_df$Value, 200, fill = NA, align = \"right\")\n\nplot_ly(yield_10y_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"USA & South korea yield spread rate(10y)\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA50, name = \"MA50\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA100, name = \"MA100\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA200, name = \"MA200\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"USA & South korea yield spread rate(10y) with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Rate (%)\"))\n\n\n\n\n\n\n\n\n\n\nCode\ndates &lt;- as.Date(as.yearmon(time(house_ts)))              \nhousing_df &lt;- data.frame(Date = dates, Value = as.numeric(house_ts)) \n\n\nhousing_df$MA12 &lt;- rollmean(housing_df$Value, 12, fill = NA, align = \"right\")\nhousing_df$MA24 &lt;- rollmean(housing_df$Value, 24, fill = NA, align = \"right\")\nhousing_df$MA36 &lt;- rollmean(housing_df$Value, 36, fill = NA, align = \"right\")\n\nplot_ly(housing_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"Seoul housing property index\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA12, name = \"MA12\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA24, name = \"MA24\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA36, name = \"MA36\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"Seoul housing property Index with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Housing Index\"))\n\n\n\n\n\n\n\n\n\n\nCode\nusd_ts &lt;- ts(usd$usd_index,\n            start = c(year(min(usd$Date)), 1),\n            frequency = 252)\n\nusd_df &lt;- data.frame(Date = usd$Date, Value = as.numeric(usd_ts))\n\nusd_df$MA50 &lt;- rollmean(usd_df$Value, 50, fill = NA, align = \"right\")\nusd_df$MA100 &lt;- rollmean(usd_df$Value, 100, fill = NA, align = \"right\")\nusd_df$MA200 &lt;- rollmean(usd_df$Value, 200, fill = NA, align = \"right\")\n\nplot_ly(usd_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"USD Index\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA50, name = \"MA50\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA100, name = \"MA100\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA200, name = \"MA200\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"USD Index with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"USD Index\"))\n\n\n\n\n\n\n\n\n\n\nCode\nkospi_ts &lt;- ts(kospi$Close,\n            start = c(year(min(kospi$Date)), 1),\n            frequency = 252)\n\nkospi_df &lt;- data.frame(Date = kospi$Date, Value = as.numeric(kospi_ts))\n\nkospi_df$MA50 &lt;- rollmean(kospi_df$Value, 50, fill = NA, align = \"right\")\nkospi_df$MA100 &lt;- rollmean(kospi_df$Value, 100, fill = NA, align = \"right\")\nkospi_df$MA200 &lt;- rollmean(kospi_df$Value, 200, fill = NA, align = \"right\")\n\nplot_ly(kospi_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"KOSPI\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA50, name = \"MA50\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA100, name = \"MA100\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA200, name = \"MA200\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"KOSPI Index with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"KOSPI\"))\n\n\n\n\n\n\n\n\n\n\nCode\nsp_ts &lt;- ts(sp500$Close,                                                \n             start = c(year(min(sp500$Date)), 1),\n            frequency = 252)                                              \nsp500_df &lt;- data.frame(Date = sp500$Date, Value = as.numeric(sp_ts))\n\nsp500_df$MA50 &lt;- rollmean(sp500_df$Value, 50, fill = NA, align = \"right\")\nsp500_df$MA100 &lt;- rollmean(sp500_df$Value, 100, fill = NA, align = \"right\")\nsp500_df$MA200 &lt;- rollmean(sp500_df$Value, 200, fill = NA, align = \"right\")\n\nplot_ly(sp500_df, x = ~Date) %&gt;%\n  add_lines(y = ~Value, name = \"S&P500\", line = list(color = \"black\")) %&gt;%\n  add_lines(y = ~MA50, name = \"MA50\", line = list(color = \"blue\")) %&gt;%\n  add_lines(y = ~MA100, name = \"MA100\", line = list(color = \"red\")) %&gt;%\n  add_lines(y = ~MA200, name = \"MA200\", line = list(color = \"green\")) %&gt;%\n  layout(title = \"S&P500 Index with Moving Averages\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"S&P500\"))\n\n\n\n\n\n\n\n\n\n\nSouth Korea base rate — MA3 / MA6 / MA12 MA3 hugs the policy path closely and shows every wiggle; good for short-term shifts but still choppy. MA6 trims a lot of the month-to-month noise and captures inflections earlier than MA12. MA12 is the smoothest but lags notably—during the 2024–25 jump it under-shoots the peak and turns later.\nFederal Funds rate — MA3 / MA6 / MA12 Same pattern: MA3 tracks near the target with small oscillations; MA6 balances smoothness with timely turns. MA12 best shows the multi-year regimes but reacts last to both the pandemic-era lift-off and the latest easing hints.\nKRW/USD spot — MA50 / MA100 / MA200 MA50 responds fastest to swings and gives earlier crossover signals but whipsaws more. MA100 is a middle road, filtering short bursts yet catching medium-term trends. MA200 is very stable, ideal for the long-run dollar trend versus KRW, but it will miss shorter cycles.\nKorea–US trade imports — MA12 / MA24 / MA36 MA12 preserves seasonal/short business-cycle movements and shows timing of surges and slowdowns best. MA24 reduces those oscillations and highlights the underlying climb. MA36 smooths heavily and is useful for long-horizon trend levels, at the cost of noticeable lag at turning points.\nKorea–US trade exports — MA12 / MA24 / MA36 MA12 captures export accelerations and dips quickly, helpful for monitoring momentum. MA24 dampens volatility and clarifies medium-term expansions. MA36 offers a clean structural trend but turns well after the fact in the 2020s cycle.\nUS–KR 3-year yield spread — MA50 / MA100 / MA200 MA50 reacts early to spread reversals and flags regime changes first, though it’s twitchier. MA100 stabilizes the shape and still picks up the 2020–25 upswing in good time. MA200 is the steadiest—great for high-level regime view—but late at both troughs and peaks.\nUS–KR 10-year yield spread — MA50 / MA100 / MA200 Similar trade-offs: MA50 is most responsive and catches shifts around the 2010s and mid-2020s quickly. MA100 smooths without losing medium-term timing. MA200 gives a slow, clear secular picture of narrowing then widening spreads with the most lag.\nSeoul housing index — MA12 / MA24 / MA36 MA12 spots the crest and rollover quickest in the early-2020s. MA24 offers a cleaner arc of the cycle, muting month-to-month noise. MA36 is very smooth but lates the post-peak stabilization, so better for policy/structural views than timing.\nUSD Index — MA50 / MA100 / MA200 MA50 catches tactical swings and crossover signals, but it flips more often. MA100 nicely summarizes medium-run trends. MA200 shows the secular dollar waves (’80s peak, 2000s rise, 2010s base) and is the least noisy, with the largest delay.\nKOSPI — MA50 / MA100 / MA200 MA50 is most sensitive—good for momentum but prone to whipsaw in selloffs/rebounds. MA100 cuts a lot of noise yet reacts within a reasonable window. MA200 defines bull/bear phases and major supports; excellent for long-term risk posture, slow for entries/exits."
  },
  {
    "objectID": "introduction/introduction.html",
    "href": "introduction/introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "Time series analyis in US economics influence on South korea’s economics\n1\nThe United States is the world’s largest economy and, in many ways, the bellwether of global finance. When U.S. economic or political events unfold—rate decisions, inflation surprises, policy shocks—markets everywhere react. Countries tightly connected to the U.S. through trade, capital flows, and technology supply chains feel these ripples most acutely.\nSouth Korea is a prime example. Its economy is deeply integrated with the U.S. through manufacturing-led exports, advanced technology industries, and financial linkages. U.S. shifts in growth, interest rates, and risk sentiment can quickly feed into Korea’s exchange rate, equity market, local interest rates, corporate financing conditions, and real activity. Korean policymakers and investors therefore watch the U.S. closely—adapting policy stances and portfolio strategies to absorb or harness these external forces.\nThis project explores how and how much U.S. ecomoics transmit to Korea’s economy and markets.This project focus on the dynamics : the channels of influence (rate differentials, dollar liquidity, risk appetite, growth signals), the speed and persistence of the effects, and how these relationships change across calm and stressed periods.\n\n\nbig picture\nThis project explores how—and how much—U.S. economic conditions transmit to Korea’s economy and markets. At the center of this transmission sits U.S. Treasuries: the world’s benchmark for risk-free returns. Treasury moves are not just bond-market trivia; they anchor global rates, funding costs, and the appetite for risk. When the U.S. curve shifts or policy guidance changes, the ripple travels quickly through the won–dollar exchange rate, Korean equities (KOSPI), local interest rates, and—after a lag—into the real economy via trade flows and housing markets. The project focuses on the dynamics: the channels of influence (rate differentials, dollar liquidity, risk appetite, growth signals), the speed and persistence of the effects, and how these relationships change across calm and stressed periods. By organizing evidence across foreign exchange, interest rates, equity markets, and real-side indicators, this analysis builds a coherent narrative of how U.S. financial conditions connect to Korean financial and economic outcomes.\n\n\n\nAnalytical Angels\n\nU.S. Rate Shocks & Channels\n\nU.S. Treasury moves embed changing views about Federal Reserve policy, inflation expectations, and growth momentum. Using the FRED Effective Federal Funds Rate and U.S. Treasury yield curves (3Y/10Y spreads), the project identifies how these shocks reach Korea through interest-rate differentials, dollar liquidity and risk sentiment shifts, and growth expectations—and when those channels amplify or offset one another.\n\nFX: Because foreign exchange sits at the center of global pricing and funding, the USD/KRW spot rate often reacts first to U.S. developments. We map when U.S. rate spikes strengthen the dollar and weaken the won, when those moves act as risk-off signals (tracked via the VIX volatility index and U.S. Dollar Index from Yahoo Finance), and how quickly—or slowly—the effects fade.\nKorean Yield Curve & Policy Response The Korean Treasury Bond (KTB) curve (3Y/10Y spreads) summarizes Korea’s sovereign borrowing costs and embedded growth/inflation expectations. We examine how shifts in the U.S. curve pass through to Korean yields, comparing movements in the Bank of Korea Base Rate with Fed policy to identify where transmission is sharp versus sticky, and how it differs across calm and stressed regimes. This reveals how much room Korean policymakers have to diverge from U.S. monetary policy without triggering destabilizing FX or capital flow pressures.\nEquities Equities translate rate information into valuations and earnings expectations. Using the KOSPI index alongside the S&P 500 and VIX for global risk context, we track how Korean equity performance responds to U.S. rate changes, spotlighting moments when stocks confirm the message from rates—or contradict it—revealing shifts in discount rates, growth optimism, and risk appetite across different market regimes.\n\nReal-Side Spillovers: Trade and Housing Financial impulses filter into activity with lags. We connect market shocks to Korea’s U.S. import/export volumes and the Korean residential property price index (Seoul metro area), clarifying when higher U.S. rates and a stronger dollar translate into softer trade momentum or tighter real-estate financing—and when resilience shows up instead. These real-economy linkages close the loop from financial transmission to tangible economic outcomes.\n\n\n\n\nGuiding Questions\n\nHow do U.S. Treasury yield changes transmit through Korea’s financial system (FX, rates, equities, credit)?\nWhat is the best way to identify a U.S. rate shock — event-day surprises, residualized yields, or structural VAR identification?\nWhat is the size of the pass-through elasticity between U.S. and Korean yields (e.g., dKTB3Y/dUST2Y, dKTB10Y/dUST10Y)?\nWhich Korean market reacts first and strongest to U.S. shocks, and what is the typical lag structure of these reactions?\nHow does the strength and speed of transmission vary across regimes — high VIX, Fed tightening cycles, or funding stress periods?\nDo FX, rate, and equity responses move consistently after shocks, or do they diverge (e.g., rates up, stocks steady)?\nHow do U.S. financial shocks spill over into Korea’s real economy — exports, industrial production, and housing — over time?\nAre U.S. rate hikes and cuts symmetric in their effects on Korea’s markets and economy?\nWhat share of Korea’s financial-market volatility is explained by U.S. shocks versus domestic or regional factors?\nWhat actionable signals should Korean policymakers and investors monitor — U.S. front-end policy, long-end term premium, or dollar liquidity indicators?\n\n\n\nLiterature reviews\n\nUS–Korea yield & rate\n\nRecent evidence shows US Treasury moves often lead other curves, with term-premium and expectations shocks radiating into global funding costs—consistent with the view that Korea’s KTB curve imports a sizable share of the US signal unless domestic policy/liquidity conditions push back (BIS, 2024)2. This motivates our decomposition of KTB moves into imported expectations vs local term-premium and our tests for wedge episodes when BoK priorities (growth/financial stability) resist external tightening.\n\nFX\n\nNew work from the Bank of Korea highlights the dollar’s outsized role in transmitting US financial shocks to small open economies, including Korea, via both trade invoicing and dollar funding channels (Bank of Korea, 2025)3. This supports our focus on mapping how US rate spikes strengthen the dollar, pressure the won, and cascade into local funding and asset prices—while testing state dependence (calm vs stressed) in the speed and persistence of KRW pass-through.\n\nEquities\n\nThe IMF’s 2025 Global Financial Stability Report documents elevated equity valuations alongside heightened sensitivity to rate and policy-uncertainty shocks, with correlations to long-rate moves rising in risk-on phases (IMF, 2025)4. This informs our approach to track when KOSPI co-moves with US equities and the dollar/risk complex—confirming the discount-rate channel—and when local earnings or sector dynamics generate divergence from the message embedded in rates.\n\nHousing market\n\nThe IMF’s 2024 Article IV for Korea, assesses housing affordability and interest-rate transmission, noting how tighter financial conditions and higher mortgage costs can weigh on transactions/prices even as some stabilization emerges (IMF, 2025)5. We use this to link imported rate/FX shocks to mortgage proxies, volumes, and prices, distinguishing quick volume effects from slower price adjustments and identifying thresholds where financing tightens materially.\n\nTrade\n\nBIS research after 2023 emphasizes valuation effects under dominant-currency pricing: exchange-rate swings reshape firms’ cash flows and can outweigh classic expenditure-switching in the short run (Nookhwun et al., 2025)6. This frames our tests of how USD strength and US–Korea rate spreads filter into Korea’s export receipts and import bills—and when strong US growth offsets FX/risk headwinds for volumes and pricing.\n\n\n\n\n\n\n\n\nReferences\n\n1. Https://www.bloomberg.com/news/articles/2025-05-14/us-korea-currency-talks-fuel-bets-trump-is-open-to-weaker-dollar.\n\n\n2. International Settlements, B. for. Investor optimism prevails over uncertainty. BIS Quarterly Review (2024).\n\n\n3. Bank of Korea, E. R. I. Dollar dominance and international spillovers of US financial shocks. https://www.bok.or.kr/imerEng/bbs/E0002902/list.do?menuNo=600342 (2025).\n\n\n4. Fund, I. M. Global financial stability report, april 2025: Chapter 1. https://www.imf.org/en/Publications/GFSR (2025).\n\n\n5. Fund, I. M. Republic of korea: 2024 article IV consultation—press release; staff report; and statement by the executive director. https://www.elibrary.imf.org/view/journals/002/2025/041/article-A001-en.xml (2025).\n\n\n6. Nookhwun, N. & coauthors. Exchange rate effects on firm performance: A NICER framework. https://www.bis.org/publ/work1266.pdf (2025)."
  },
  {
    "objectID": "about/about_me.html",
    "href": "about/about_me.html",
    "title": "About me",
    "section": "",
    "text": "Welcome to my website!!\nHi my name is Zoo un Park and i am a second year student in the Data science and Analytics program at Georgetown University. Originally from Seoul, South Korea, I graduated from University of Minnesota-Twin Cities in 2024 with a B.A. in statistics and a minor in management from University of Minnesota in 2024."
  },
  {
    "objectID": "about/about_me.html#myself",
    "href": "about/about_me.html#myself",
    "title": "About me",
    "section": "",
    "text": "Welcome to my website!!\nHi my name is Zoo un Park and i am a second year student in the Data science and Analytics program at Georgetown University. Originally from Seoul, South Korea, I graduated from University of Minnesota-Twin Cities in 2024 with a B.A. in statistics and a minor in management from University of Minnesota in 2024."
  },
  {
    "objectID": "about/about_me.html#academic-interest",
    "href": "about/about_me.html#academic-interest",
    "title": "About me",
    "section": "Academic interest",
    "text": "Academic interest\n\nBaseball Analytics\nFinancial Analysis( specifically investment strategy)\nDeep learning\nReinforce learning"
  },
  {
    "objectID": "data_viz/viz.html",
    "href": "data_viz/viz.html",
    "title": "Data Visualization",
    "section": "",
    "text": "Code\nlibrary(readr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(plotly)\nlibrary(ggplot2)\nlibrary(here)\nlibrary(lubridate)"
  },
  {
    "objectID": "data_viz/viz.html#exchange-rates",
    "href": "data_viz/viz.html#exchange-rates",
    "title": "Data Visualization",
    "section": "exchange rates",
    "text": "exchange rates\n                   \nInterest rate is a key fundamental index in country’s economics since it influences every economic field in the country. these two plots shows US and south korea interest rates. overall, south korea interest rate tends to follow U.S interest rate, most of the trend is very similar. notable part in two plots are after 2009 to 2015, which was after global economic crisis. U.S has cut interest rate close to zero, whereas south korea maintained its rate around 2-3%."
  },
  {
    "objectID": "ts/uni.html",
    "href": "ts/uni.html",
    "title": "Univariate TS Models(ARIMA/SARIMA)",
    "section": "",
    "text": "note\n\n\n\nIn the EDA part, there is stationary observed from ACF and PACF plot except seoul housing index. Also ADF test(after differencing) confirms this with significant low p-value. To check further specifically seoul housing index, first part of this section is performing second order differencing."
  },
  {
    "objectID": "ts/uni.html#model-choices",
    "href": "ts/uni.html#model-choices",
    "title": "Univariate TS Models(ARIMA/SARIMA)",
    "section": "Model choices",
    "text": "Model choices\n\nModel & Parameter selection (USD, KOSPI, and S&P500 are log-transformed before differencing.)\n\n\n\n\n\n\nSeries\nModel parameters\n\n\n\n\nSouth Korea base rate\nARIMA p = 0,1 d = 1 ,q = 0,1\n\n\nFED effective rate\nARIMA p = 0,1,2 , d = 0,1 , q = 0,1,2\n\n\nKRW/USD FX rate\nARIMA p = 0,1 d = 0,1 q = 0,1\n\n\nYield spread 3Y (US–KR)\nARIMA p = 0,1 d = 1 q = 0,1\n\n\nYield spread 10Y (US–KR)\nARIMA p = 0,1 d = 1 q = 0,1\n\n\nUSD index (log)\nARIMA p = 0,1 d = 1, , q = 0,1\n\n\nKOSPI index (log)\nARIMA p = 0,1 d = 1,q = 0,1,2\n\n\nS&P 500 index (log)\nARIMA p = 0,1 d = 0,1, q = 0,1\n\n\ntrade export KOR - USA\nSARIMA p = 0,1,d = 0,1 q = 0,1, P = 0,1,2,3 D = 0,1,Q = 0,1 , s= 12\n\n\ntrade import KOR -USA\nSARIMA p = 0,1,d = 0,1 q = 0,1, P = 0,1,2 D = 0,1,Q = 0,1, s = 12\n\n\nSeoul housing property index\nSARIMA p =0,1 ,d = 0,1,2 q = 0,1,2 P = 0,1, D = 0,1 ,Q = 0,1,2 ,s = 12"
  },
  {
    "objectID": "ts/uni.html#model-choicewith-equation",
    "href": "ts/uni.html#model-choicewith-equation",
    "title": "Univariate TS Models(ARIMA/SARIMA)",
    "section": "Model choice(with equation)",
    "text": "Model choice(with equation)\n\nSouth korea base rate\n\nModel : ARIMA(0,1,1)\n\\[\nEquation: x_t = 1.0000x_{t-1} + w_t + 0.0161w_{t-1}\n\\]\n\nFederal reserve rate\n\nModel: ARIMA(1,1,0)\n\\[\nEquation:\\; x_t = x_{t-1} + 0.6987(x_{t-1} - x_{t-2}) + 0.0229 + w_t\n\\]\n\nKRW/USD FX rate\n\nModel: ARIMA(1,0,1)\n\\[\nEquation:\\; x_t = 0.9997x_{t-1} + w_t + 0.0165w_{t-1} + 0.0011\n\\]\n\nUSA & South Korea yield spread rate(10Y)\n\nModel : ARIMA(1,0,1)\n\\[\nEquation:\\; x_t = 0.9968x_{t-1} + w_t - 0.0896w_{t-1} - 0.7027\n\\]\n\nUSD index\n\nModel: ARIMA(1,0,0)\n\\[\nEquation:\\; x_t = 0.9997x_{t-1} + 4.5713 + w_t\n\\]\n\nS&P500 index\n\nModel: ARIMA(0,1,1)\n\\[\nEquation:\\; x_t = x_{t-1} + 0.0003 + w_t - 0.0802w_{t-1}\n\\]\n\nKOSPI index\n\nModel : ARIMA(0,1,2)\n\\[\nEquation:\\; x_t = x_{t-1} + 0.0000 + w_t + 0.0258w_{t-1} - 0.0214w_{t-2}\n\\]\n\nTrade import South korea vs USA Model\n\nSARIMA(0,1,2)(0,1,1)[12]\n\\[\nEquation:\\; (1 - B)(1 - B^{12})x_t = (1 - 0.5291B + 0.1363B^2)(1 - 0.9351B^{12})w_t\n\\]\n\nTrade import South korea vs USA\n\nModel : SARIMA(0,1,1)(0,1,1)[12]\n\\[\nModel : SARIMA(0,1,1)(0,1,1)[12] \\\nEquation:\\; (1 - B)(1 - B^{12})x_t = (1 - 0.5536B)(1 - 0.8441B^{12})w_t\n\\]\n\nSeoul housing property index\n\nModel : SARIMA(1,1,2)(0,1,1)[12]\n\\[\nEquation:\\; (1 - 0.7799B)(1 - B)(1 - B^{12})x_t = (1 + 0.2868B + 0.1734B^2)(1 - 0.9998B^{12})w_t\n\\]"
  },
  {
    "objectID": "ts/multi.html",
    "href": "ts/multi.html",
    "title": "Multivariate TS Models(ARIMAX/SARIMAX/VAR)",
    "section": "",
    "text": "note\n\n\n\nCurrently there are four models, but more models will be added\n\n\nThis project examines how U.S. economic and financial conditions transmit to South Korea’s economy across markets and the real sector. Because there are many candidate indicators—spanning growth, risk sentiment, interest rates, exchange rates, and trade—careful variable selection is essential before modeling. Goal of this section is to build multivariate models to answer four questions:\n\n\nhow U.S. and Korean equities interact\n\n\nhow the Seoul metropolitan housing market responds to Long end of the term structure\n\n\nwhich exogenous factors move the won–dollar exchange rate\n\n\nwhich factors drive Korea’s exports to the U.S.\n\n\n\nLiterature reviews\nBefore turning to the analysis, a targeted literature review aligns the four questions with the overarching research objective and justifies each modeling choice.\nIn U.S.–South Korea equity linkages, Kim (2010)1 documents significant spillovers in higher moments (mean, volatility, skewness, kurtosis) between U.S. and Korean equity markets using high-frequency data, indicating that U.S. shocks propagate to Korean returns; more recently, a study in Business and Economic Research shows that changes in the VIX are negatively associated with KOSPI returns, reinforcing a U.S. risk-to-Korea transmission channel. Together, these results support a VAR that treats U.S. equity performance and global risk as upstream drivers of Korean equities, with a discount-rate control: include Δlog(S&P 500), VIX, Δlog(KOSPI), and a U.S. yield spread (10Y–3M or 10Y–2Y) to capture the rate channel affecting both markets.\nFor the Seoul housing market, Lee (2022)2 uses a Korean time-varying parameter VAR (1991–2022) and finds that the impact of interest-rate shocks on housing prices strengthened markedly after the global financial crisis, implying state-dependent pass-through from rates to valuations. Complementary evidence from Min (2024)3 likewise highlights time-varying impulse responses of Seoul housing to interest rates. These findings motivate a compact VAR comprising the U.S. 10-year Treasury yield, the Korea 10-year government bond yield, and the log of the Seoul housing price index, ordered to trace global-to-local rate pass-through and then housing, while leaving room to test time variation via rolling windows or TVP extensions.\nFor the KRW/USD exchange rate, Yoon (2019)4 argues that U.S. monetary conditions dominate KRW/USD dynamics given the dollar-centric trading of Korea’s FX market, while Masujima (2018, RIETI)5 adds that exchange-rate drivers rotate across carry (rate differentials), the global dollar factor, and risk sentiment (VIX). These insights support a SARIMAX for Δlog(USD/KRW) with exogenous terms for the U.S.–Korea interest-rate spread (3Y or 10Y), Δlog(Dollar Index, DXY) to capture the global dollar cycle, and a risk proxy (VIX or Δlog(S&P 500))—a structure also consistent with funding-risk episodes highlighted for Korea by the IMF.\nFinally, on South Korea’s exports to the United States, a Bank of Korea working paper on dominant currency pricing (Son et al., 2023)6 shows that Korean exports are heavily invoiced in U.S. dollars due to strategic complementarities and real hedging, implying that the dollar level often matters for short-run trade revenues. Pairing this with a U.S. demand proxy captures the real-side pull. Accordingly, model Δlog(Korea’s exports to the United States) with U.S. manufacturing demand (ISM Manufacturing PMI or U.S. industrial production), an exchange-rate term (Δlog(USD/KRW) and/or DXY for invoicing effects), and a risk/financing control (VIX), with seasonal terms for monthly data.\n\n\nCode\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(forecast)\nlibrary(astsa) \nlibrary(xts)\nlibrary(zoo)\nlibrary(tseries)\nlibrary(fpp2)\nlibrary(fma)\nlibrary(lubridate)\nlibrary(tidyverse)\nlibrary(TSstudio)\nlibrary(tidyquant)\nlibrary(plotly)\nlibrary(readr)\nlibrary(kableExtra)\nlibrary(knitr)\nlibrary(patchwork)\nlibrary(vars)\nlibrary(here)\nlibrary(tsibble)\nlibrary(dplyr)\n# calling data\n\n#KR base rate\nbok&lt;- read.csv(\"../data/interest/bok.csv\")%&gt;%\n  rename(Date = date)\nbok$Date&lt;- as.Date(bok$Date)\nbok &lt;- bok %&gt;%\n  mutate(Date = floor_date(Date, unit = \"quarter\")) %&gt;%\n  group_by(Date) %&gt;%\n  summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)), .groups = \"drop\")\n\n\n# FED rate \n\nusr&lt;- read.csv(\"../data/interest/us_rate.csv\")%&gt;%\n  rename(Date = observation_date,rate = DFF)\nusr$Date&lt;- as.Date(usr$Date)\nusr&lt;- usr %&gt;%\n  mutate(Date = floor_date(Date, unit = \"quarter\")) %&gt;%\n  group_by(Date) %&gt;%\n  summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)), .groups = \"drop\")\n\n# KRW/USD rate\n\nkr &lt;- read.csv(\"../data/fx rate/kor.csv\")\nkr &lt;- kr %&gt;%\n  transmute(\n    Date = as.Date(observation_date),\n    krw  = DEXKOUS,    \n    usd  = 1 / DEXKOUS  \n  ) %&gt;%\n  filter(!is.na(Date)) %&gt;%\n  arrange(Date) %&gt;%\n  distinct(Date, .keep_all = TRUE) %&gt;%\n  complete(Date = seq(min(Date), max(Date), by = \"day\")) %&gt;%\n\n  fill(krw, usd, .direction = \"down\")\n\n\n# USD index \n\nusd &lt;- read_csv(\"../data/fx rate/usd_index.csv\", show_col_types = FALSE)\nusd &lt;- usd %&gt;%\n  transmute(\n    Date = as.Date(Date),\n    usd_index = Close\n  ) %&gt;%\n  filter(!is.na(Date)) %&gt;%\n  arrange(Date) %&gt;%\n  distinct(Date, .keep_all = TRUE) %&gt;%\n  complete(Date = seq(min(Date), max(Date), by = \"day\")) %&gt;%\n  fill(usd_index, .direction = \"down\")\n\n\n\n# Seoul housing data\n\nhousing &lt;- read_csv(here(\"data/housing/house.csv\")) %&gt;%\n  mutate(Date = as.Date(Date))\n\nhousing &lt;- housing %&gt;% mutate(Date = as.Date(Date))\n\n\n# Yield data \n\nus_yield  &lt;- read.csv(here(\"data/yield\", \"us_yield.csv\"))\nkor_yield   &lt;- read.csv(here(\"data/yield\", \"kor_yield.csv\"))\n\n\nus_yield$Date  &lt;- as.Date(us_yield$Date)\nkor_yield$Date &lt;- as.Date(kor_yield$Date)\n\ncolnames(us_yield)[colnames(us_yield)  == \"X3Y\"]  &lt;- \"US_3Y\"\ncolnames(us_yield)[colnames(us_yield)  == \"X10Y\"] &lt;- \"US_10Y\"\ncolnames(kor_yield)[colnames(kor_yield) == \"X3Y\"]  &lt;- \"KR_3Y\"\ncolnames(kor_yield)[colnames(kor_yield) == \"X10Y\"] &lt;- \"KR_10Y\"\n\nus_yield  &lt;- us_yield[,  c(\"Date\", \"US_3Y\", \"US_10Y\")]\nkor_yield &lt;- kor_yield[, c(\"Date\", \"KR_3Y\", \"KR_10Y\")]\n\nus_yield  &lt;- us_yield  %&gt;% arrange(Date) %&gt;% fill(US_3Y, US_10Y, .direction = \"down\")\nkor_yield &lt;- kor_yield %&gt;% arrange(Date) %&gt;% fill(KR_3Y, KR_10Y, .direction = \"down\")\n\n\ndf &lt;- merge(us_yield, kor_yield, by = \"Date\")\n\ndf$US_3m10  &lt;- df$US_3Y - df$US_10Y\ndf$KR_3m10  &lt;- df$KR_3Y - df$KR_10Y\ndf$US_KR_3Y &lt;- df$US_3Y - df$KR_3Y\ndf$US_KR_10Y&lt;- df$US_10Y - df$KR_10Y\n\n\n#import & export data \n\ntrade&lt;- read_csv(\"../data/trade/trade_merged.csv\")\ntrade$balance&lt;- trade$export_USD - trade$import_USD\nexports&lt;- trade%&gt;%\n  dplyr::select(Date,export_USD)\n#trade_ts &lt;- trade %&gt;%\n # as_tsibble(index = Date, key = Type)\n\n\n# S&P500 data\nsp500 &lt;- read_csv(\"../data/stock/sp500.csv\")\n\n\n# KOSPI data\nkospi &lt;- read_csv(\"../data/stock/kospi.csv\")\nkospi$Date &lt;- as.Date(kospi$Date)\n\n# VIX data(added for the modeling)\nvix&lt;- read_csv(\"../data/stock/vix.csv\")%&gt;%\n  mutate(Date = ymd(Date)) %&gt;%\n  arrange(Date) %&gt;%\n  fill(vix, .direction = \"down\")\n\n\n# extract spreads from df\n\n\nus_spreads &lt;- df %&gt;%\n  dplyr::select(Date, US_3m10) %&gt;%\n  rename(us_spread = US_3m10) %&gt;%\n  mutate(Date = as.Date(Date))\n\nkor_spreads &lt;- df %&gt;%\n  dplyr::select(Date, KR_3m10) %&gt;%\n  rename(kr_spread = KR_3m10) %&gt;%\n  mutate(Date = as.Date(Date))\n\nus_kr_spreads_3y &lt;- df %&gt;%\n  dplyr::select(Date, US_KR_3Y) %&gt;%\n  mutate(Date = as.Date(Date))\n\nus_kr_spreads_10y &lt;- df %&gt;%\n  dplyr::select(Date, US_KR_10Y) %&gt;%\n  mutate(Date = as.Date(Date))\n\n# balance of payment(debt,equity)\n\nbp&lt;- read_csv(\"../data/bp.csv\")%&gt;%\n  mutate(Date = ymd(Date)) %&gt;%\n  rename(debt_securities = \"Debt securities of P.I., Liabilities\")%&gt;%\n  rename(equity_securities = \"Equity securities of P.I., Liabilities\")%&gt;%\n  arrange(Date)\n\nbp_debt&lt;- data.frame(bp$Date,bp$debt_securities)\nbp_equity&lt;- data.frame(bp$Date,bp$equity_securities)\nbp_debt&lt;- bp_debt%&gt;%rename(Date = bp.Date, debt_securities= bp.debt_securities)\nbp_equity&lt;- bp_equity%&gt;%rename(Date = bp.Date, equity_securities= bp.equity_securities)\n\n#oil price \n\noil&lt;- read_csv(\"../data/oil.csv\")%&gt;%\n  rename(Date = observation_date)%&gt;%\n  rename(wti = DCOILWTICO)%&gt;%\n  mutate(Date = ymd(Date)) %&gt;%\n  arrange(Date)%&gt;%\n  fill(wti, .direction = \"down\")\n\ndebt_monthly &lt;- bp_debt %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,debt_securities)\n\nequity_monthly &lt;- bp_equity %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,equity_securities)\n\n\nvix_monthly &lt;- vix %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,vix)\n\n\n\nVariables\n\nFX spot rate (KRW per USD)\n\nThe bilateral exchange rate quoted as won per dollar; it moves up when the USD strengthens or U.S. rates/risk rise and down when KRW demand or relative KR rates strengthen; up-moves mean a weaker KRW and costlier imports/funding while down-moves mean stronger KRW and easier external conditions; it matters because it transmits U.S. financial shifts into Korea’s prices, trade margins, and capital flows.\n\nU.S.–Korea 3-year yield spread\n\nThe 3Y U.S. Treasury yield minus the 3Y Korea Treasury Bond yield; it widens when U.S. front-to-belly rates outpace Korea’s and narrows when Korea’s rise or U.S. fall; widening implies policy divergence favoring USD assets and KRW pressure, narrowing implies the opposite; it matters as a near-term compass for FX, flows, and local funding costs.\n\nU.S.–Korea 10-year yield spread\n\nThe 10Y U.S. Treasury yield minus the 10Y Korea government bond yield; it moves with relative long-run growth/inflation expectations and term premium; wider spreads signal capital preference for U.S. duration and KRW headwinds, narrower spreads point to relatively easier conditions for Korea; it matters for portfolio allocations, currency valuation, and long-tenor financing.\n\nS&P 500 index\n\nThe main U.S. large-capital equity benchmark; it rises with stronger earnings/risk appetite and falls on growth scares or tighter policy; gains signal global risk-on that often supports KOSPI and KRW, while declines flag risk-off and potential outflows from Korea; it matters as the world’s equity bellwether shaping cross-border sentiment.\n\nDollar Index (DXY)\n\nA broad USD index versus major currencies(JPY,GBP,EUR,CAD,SEK,CHF); it rises with stronger U.S. growth/real yields or heightened risk and falls when global growth broadens or the Fed eases; increases mean tighter global financial conditions and KRW headwinds, decreases mean relief; it matters because it frames Korea’s external competitiveness and dollar funding costs.\n\nSouth Korea exports to the United States (USD)\n\nThe monthly value of Korean goods shipped to the U.S.; it rises with firm U.S. demand/tech upcycles and falls when U.S. activity softens or conditions tighten; increases mean stronger external demand and earnings support for Korea, decreases warn of slower production and profits; it matters as a direct real-economy link between the two countries.\n\nVIX (U.S. equity volatility index)\n\nImplied 30-day volatility from S&P 500 options; it spikes in stress and recedes in calm; higher readings mean risk-off, likely KRW weakness and KOSPI pressure, lower readings mean risk-on support; it matters as a fast, forward-looking gauge of global risk that transmits into Korean assets.\n\nU.S. manufacturing index (ISM Manufacturing PMI)\n\nA diffusion index of U.S. factory activity where 50 marks expansion; it rises with stronger orders/production and falls with slowdowns; higher prints mean firmer U.S. goods demand that often lifts Korean exports, lower prints caution on future orders; it matters as a timely cue for Korea’s trade and industrial cycle.\n\nU.S. yield spread (10Y–3Y curve slope)\n\nThe term spread between long and intermediate Treasuries; it steepens on improving growth/term premium and inverts ahead of slowdowns; steepening often signals risk-on and better global momentum, inversion warns of softer demand; it matters because it foreshadows the external environment Korea will face.\n\nKOSPI index\n\nKorea’s main equity benchmark; it rises with global risk appetite, stable/strong KRW, and tech strength, and falls when the dollar tightens conditions or volatility jumps; up-moves mean improving earnings/flows, down-moves mean de-risking and potential outflows; it matters as the market-price readout of Korea’s cyclical exposure to U.S. conditions.\n\nU.S. 10-year Treasury yield\n\nThe anchor long-term U.S. risk-free rate; it rises on stronger growth/less-dovish policy or higher term premium and falls on easing or growth fears; higher yields mean tighter global discount rates and KRW/KOSPI headwinds, lower yields mean relief; it matters because it sets the tone for valuation and borrowing costs worldwide.\n\nSouth Korea 10-year government bond yield\n\nKorea’s benchmark long-term sovereign yield; it rises with domestic inflation/growth or spillovers from higher U.S. yields and falls with easing/disinflation; increases mean tighter local conditions and pricier mortgages/corporate debt, decreases mean looser conditions; it matters for domestic credit, housing, and investment.\n\nSeoul residential property price index\n\nAn index of Seoul home prices; it rises with lower mortgage rates/strong incomes and softens when rates rise or credit tightens; up-moves signal wealth effects and consumption support, down-moves flag cooling demand and potential credit restraint; it matters as a slower-moving but powerful transmission channel from global rates to the household economy.\n\n\nModel explanation\n\nVAR model 1 — Equity co-movements (S&P 500, VIX, U.S. yield spread, KOSPI)\n\nFinancial linkages transmit U.S. equity and risk shocks to Korean equities through discount-rate and sentiment channels, with feedback over short horizons. The VAR includes Δlog(S&P 500), VIX, the U.S. yield spread (10Y–3M or 10Y–2Y), and Δlog(KOSPI) as jointly endogenous variables. This set captures the main transmission mechanisms: the yield spread summarizes shifts in discount rates and growth expectations; S&P 500 represents U.S. equity innovations; VIX captures global risk aversion; and KOSPI reflects Korea’s market response. A VAR is justified because these variables interact contemporaneously and with lags; the system enables impulse responses from U.S. rate/equity/risk shocks to KOSPI, and variance decompositions that quantify the U.S. contribution to Korean equity volatility.\n\nVAR model 2 — Rates pass-through and Seoul housing (US10Y, KR10Y, Seoul HPI)\n\nHousing valuations in Seoul are sensitive to financing conditions, and global rate movements typically filter through to domestic long-term yields before affecting prices with lags. The VAR comprises the U.S. 10-year Treasury yield, the Korea 10-year government bond yield, and the log of the Seoul housing price index. This configuration reflects a plausible ordering of influences: global long rates anchor international term structures, domestic long rates transmit the shock into local borrowing costs and mortgage pricing, and housing prices adjust gradually via affordability and discount-rate channels. A VAR is warranted because long rates and housing prices exhibit mutual dynamics and delayed pass-through; the framework traces how a U.S. term-structure shock propagates to Korean yields and then to housing over time, while allowing tests for lag length, stability, and time-variation.\n\nSARIMAX model 1 — USD/KRW determinants\n\nExchange-rate behavior in Korea is strongly influenced by cross-border interest-rate differentials, global risk sentiment, and the broad dollar cycle, reflecting the market’s integration with U.S. monetary conditions and dollar funding. The model includes the U.S.–Korea 3-year yield spread, the S&P 500, and the Dollar Index (DXY) as exogenous drivers of USD/KRW. The spread captures carry/UIP forces and relative monetary stance; the S&P 500 serves as a high-frequency proxy for global risk-on/off that tends to strengthen or weaken KRW; and DXY isolates the common dollar factor that moves bilateral rates beyond country-specific fundamentals. SARIMAX fits because USD/KRW exhibits strong serial correlation that ARIMA errors can handle, while the exogenous block reflects reasonably weakly exogenous global forces at the chosen frequency.\n\nSARIMAX model 2— South Korea exports to the U.S.\n\nInternational trade research shows that partner-country demand, currency valuation, and global risk conditions jointly shape export dynamics—especially for economies like Korea that are tightly linked to U.S. manufacturing cycles and invoice a large share of exports in dollars. The model uses U.S. manufacturing activity (e.g., ISM Manufacturing PMI or U.S. industrial production), the KRW/USD spot rate, and the VIX as exogenous regressors for South Korea’s exports to the U.S. This selection is justified by clear channels: the U.S. manufacturing index captures external demand pull; the KRW/USD rate captures pricing and competitiveness as well as dollar-denominated revenue effects; and the VIX proxies global financial conditions that influence trade finance, inventory decisions, and risk-sensitive orders. A SARIMAX structure is appropriate because exports are persistent and seasonal, allowing ARIMA terms to absorb autocorrelation and seasonality while treating the U.S. indicators and VIX as upstream drivers at monthly frequency.\n\n\n\nModels\n\nSARIMAX:\n\n\nSouth korea exports(vs USA) ~ VIX + US manufacturing Index + KRW/USD spot rate\nUSD/KRW spot rate ~ us-korea spread rate 3years+ us-korea spread rate 3years+ S&P500 + dollar index\n\n\nVAR:\n\n\nequity: s&p500, vix, us_yield_spread,KOSPI index\nUS treasury yield curve 10 Years, South Korea government bond rate 10Years, Seoul housing index\n\n\n\nVAR model\n\n\nequity: s&p500, us_yield_spread,KOSPI index\n\ntime series plotparameter selectionmodel summaryCVforecast\n\n\n\n\nCode\nlibrary(dplyr)\ndf1 &lt;- us_spreads %&gt;%\n   left_join(sp500, by = \"Date\") %&gt;%\n   left_join(kospi, by = \"Date\")%&gt;%\n   dplyr::select(Date, us_spread, close_sp500 = Close.x , close_kospi = Close.y)%&gt;%\n   arrange(Date) %&gt;%\n   fill(close_sp500,close_kospi, .direction = \"down\")\n \ndf1$log_kospi&lt;- log(df1$close_kospi)\ndf1$log_sp500&lt;- log(df1$close_sp500)\n\n\n start_year_df1  &lt;- year(min(df1$Date))\n start_month_df1 &lt;- month(min(df1$Date))\n\n\np1 &lt;- plot_ly(df1, x = ~Date, y = ~us_spread, type = 'scatter', mode = 'lines',\n              name = \"U.S Spread Rate\") %&gt;%\n  layout(yaxis = list(title = \"U.S Spread Rate\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np2 &lt;- plot_ly(df1, x = ~Date, y = ~log_sp500, type = 'scatter', mode = 'lines',\n              name = \"S&P500 Index(log)\") %&gt;%\n  layout(yaxis = list(title = \"S&P500 Index(log)\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np3 &lt;- plot_ly(df1, x = ~Date, y = ~log_kospi, type = 'scatter', mode = 'lines',\n              name = \"KOSPI Index(log)\") %&gt;%\n  layout(yaxis = list(title = \"KOSPI Index(log)\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\nsubplot(p1, p2, p3, nrows = 3, shareX = TRUE, titleX = TRUE) %&gt;%\n  layout(title = list(text = \"Equities:KOSPI index, S&P 500 index, U.S T-bond spread rate\", font = list(size = 18)),\n         margin = list(l = 70, r = 40, t = 60, b = 40))\n\n\n\n\n\n\n\n\n\n\nCode\nnew_df1&lt;- df1[,c(2,5,6)]\ndf1.ts&lt;-ts(new_df1,star=decimal_date(as.Date(\"2001-12-01\",format = \"%Y-%m-%d\")),frequency = 252)\nVARselect(df1.ts, lag.max=10, type=\"both\")\n\n\n$selection\nAIC(n)  HQ(n)  SC(n) FPE(n) \n    10      5      2     10 \n\n$criteria\n                   1             2             3             4             5\nAIC(n) -2.419658e+01 -2.436948e+01 -2.437841e+01 -2.438541e+01 -2.438900e+01\nHQ(n)  -2.419068e+01 -2.436005e+01 -2.436544e+01 -2.436890e+01 -2.436895e+01\nSC(n)  -2.417962e+01 -2.434234e+01 -2.434109e+01 -2.433791e+01 -2.433132e+01\nFPE(n)  3.101405e-11  2.608965e-11  2.585770e-11  2.567740e-11  2.558543e-11\n                   6             7             8             9            10\nAIC(n) -2.439247e+01 -2.439309e+01 -2.439656e+01 -2.440048e+01 -2.440168e+01\nHQ(n)  -2.436889e+01 -2.436597e+01 -2.436590e+01 -2.436628e+01 -2.436394e+01\nSC(n)  -2.432461e+01 -2.431505e+01 -2.430834e+01 -2.430208e+01 -2.429310e+01\nFPE(n)  2.549667e-11  2.548083e-11  2.539261e-11  2.529342e-11  2.526311e-11\n\n\nFrom parameter selction process, three parameters were suggested; p = 2,5,10\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df1, p=2, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: us_spread, log_kospi, log_sp500 \nDeterministic variables: both \nSample size: 5918 \nLog Likelihood: 46927.097 \nRoots of the characteristic polynomial:\n0.9987 0.9979 0.9954 0.2162 0.0273 0.0273\nCall:\nVAR(y = new_df1, p = 2, type = \"both\")\n\n\nEstimation results for equation us_spread: \n========================================== \nus_spread = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  1.005e+00  1.302e-02  77.209   &lt;2e-16 ***\nlog_kospi.l1  4.318e-02  3.263e-02   1.324    0.186    \nlog_sp500.l1  5.690e-02  3.593e-02   1.583    0.113    \nus_spread.l2 -7.440e-03  1.302e-02  -0.572    0.568    \nlog_kospi.l2 -4.234e-02  3.264e-02  -1.297    0.195    \nlog_sp500.l2 -5.388e-02  3.591e-02  -1.501    0.134    \nconst        -2.991e-02  2.686e-02  -1.114    0.265    \ntrend        -4.247e-07  1.078e-06  -0.394    0.694    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.03353 on 5910 degrees of freedom\nMultiple R-Squared: 0.9981, Adjusted R-squared: 0.9981 \nF-statistic: 4.428e+05 on 7 and 5910 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_kospi: \n========================================== \nlog_kospi = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  4.210e-03  4.990e-03   0.844   0.3989    \nlog_kospi.l1  9.266e-01  1.250e-02  74.106  &lt; 2e-16 ***\nlog_sp500.l1  3.906e-01  1.377e-02  28.365  &lt; 2e-16 ***\nus_spread.l2 -4.170e-03  4.989e-03  -0.836   0.4032    \nlog_kospi.l2  7.104e-02  1.251e-02   5.679 1.42e-08 ***\nlog_sp500.l2 -3.907e-01  1.376e-02 -28.390  &lt; 2e-16 ***\nconst         1.698e-02  1.029e-02   1.650   0.0991 .  \ntrend         4.458e-07  4.131e-07   1.079   0.2805    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01285 on 5910 degrees of freedom\nMultiple R-Squared: 0.9992, Adjusted R-squared: 0.9992 \nF-statistic: 1.081e+06 on 7 and 5910 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_sp500: \n========================================== \nlog_sp500 = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1 -7.316e-03  4.799e-03  -1.524 0.127492    \nlog_kospi.l1  3.228e-02  1.203e-02   2.684 0.007286 ** \nlog_sp500.l1  8.753e-01  1.324e-02  66.083  &lt; 2e-16 ***\nus_spread.l2  7.526e-03  4.798e-03   1.569 0.116796    \nlog_kospi.l2 -3.438e-02  1.203e-02  -2.858 0.004284 ** \nlog_sp500.l2  1.215e-01  1.324e-02   9.183  &lt; 2e-16 ***\nconst         3.540e-02  9.900e-03   3.576 0.000352 ***\ntrend         1.609e-06  3.973e-07   4.049  5.2e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01236 on 5910 degrees of freedom\nMultiple R-Squared: 0.9995, Adjusted R-squared: 0.9995 \nF-statistic: 1.748e+06 on 7 and 5910 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n           us_spread log_kospi  log_sp500\nus_spread  1.124e-03 1.530e-06 -1.898e-05\nlog_kospi  1.530e-06 1.651e-04  4.392e-05\nlog_sp500 -1.898e-05 4.392e-05  1.527e-04\n\nCorrelation matrix of residuals:\n          us_spread log_kospi log_sp500\nus_spread  1.000000  0.003551  -0.04582\nlog_kospi  0.003551  1.000000   0.27658\nlog_sp500 -0.045820  0.276579   1.00000\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df1, p=5, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: us_spread, log_kospi, log_sp500 \nDeterministic variables: both \nSample size: 5915 \nLog Likelihood: 46994.576 \nRoots of the characteristic polynomial:\n0.9989 0.9983 0.9951 0.5204 0.5204 0.5144 0.5144 0.4234 0.4111 0.4111 0.3816 0.3816 0.373 0.373 0.2981\nCall:\nVAR(y = new_df1, p = 5, type = \"both\")\n\n\nEstimation results for equation us_spread: \n========================================== \nus_spread = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  1.002e+00  1.301e-02  77.017  &lt; 2e-16 ***\nlog_kospi.l1  1.256e-02  3.563e-02   0.352 0.724478    \nlog_sp500.l1  6.579e-02  3.675e-02   1.790 0.073477 .  \nus_spread.l2  8.197e-04  1.843e-02   0.044 0.964530    \nlog_kospi.l2 -3.401e-02  4.707e-02  -0.723 0.469980    \nlog_sp500.l2 -9.580e-03  4.836e-02  -0.198 0.842991    \nus_spread.l3 -2.020e-02  1.843e-02  -1.096 0.273182    \nlog_kospi.l3  2.201e-02  4.719e-02   0.466 0.640900    \nlog_sp500.l3  6.182e-02  4.972e-02   1.243 0.213783    \nus_spread.l4 -1.204e-02  1.843e-02  -0.653 0.513772    \nlog_kospi.l4  2.331e-02  4.615e-02   0.505 0.613522    \nlog_sp500.l4  2.283e-02  4.924e-02   0.464 0.642863    \nus_spread.l5  2.717e-02  1.300e-02   2.089 0.036755 *  \nlog_kospi.l5 -2.352e-02  3.276e-02  -0.718 0.472758    \nlog_sp500.l5 -1.388e-01  3.949e-02  -3.515 0.000443 ***\nconst        -1.963e-02  2.694e-02  -0.729 0.466262    \ntrend        -1.036e-07  1.081e-06  -0.096 0.923694    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.03347 on 5898 degrees of freedom\nMultiple R-Squared: 0.9981, Adjusted R-squared: 0.9981 \nF-statistic: 1.942e+05 on 16 and 5898 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_kospi: \n========================================== \nlog_kospi = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  3.449e-03  4.950e-03   0.697   0.4860    \nlog_kospi.l1  8.749e-01  1.355e-02  64.561  &lt; 2e-16 ***\nlog_sp500.l1  4.162e-01  1.398e-02  29.779  &lt; 2e-16 ***\nus_spread.l2 -9.057e-03  7.010e-03  -1.292   0.1964    \nlog_kospi.l2  7.212e-02  1.790e-02   4.028 5.69e-05 ***\nlog_sp500.l2 -2.779e-01  1.839e-02 -15.106  &lt; 2e-16 ***\nus_spread.l3  2.893e-03  7.010e-03   0.413   0.6798    \nlog_kospi.l3  2.295e-02  1.795e-02   1.279   0.2010    \nlog_sp500.l3 -2.757e-02  1.891e-02  -1.458   0.1449    \nus_spread.l4  2.902e-03  7.011e-03   0.414   0.6790    \nlog_kospi.l4  1.520e-02  1.755e-02   0.866   0.3866    \nlog_sp500.l4 -8.148e-02  1.873e-02  -4.351 1.38e-05 ***\nus_spread.l5  2.195e-05  4.946e-03   0.004   0.9965    \nlog_kospi.l5  1.240e-02  1.246e-02   0.995   0.3197    \nlog_sp500.l5 -2.974e-02  1.502e-02  -1.980   0.0477 *  \nconst         2.053e-02  1.024e-02   2.004   0.0451 *  \ntrend         4.817e-07  4.112e-07   1.172   0.2414    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01273 on 5898 degrees of freedom\nMultiple R-Squared: 0.9992, Adjusted R-squared: 0.9992 \nF-statistic: 4.801e+05 on 16 and 5898 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_sp500: \n========================================== \nlog_sp500 = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1 -6.714e-03  4.799e-03  -1.399 0.161845    \nlog_kospi.l1  3.661e-02  1.314e-02   2.787 0.005344 ** \nlog_sp500.l1  8.733e-01  1.355e-02  64.448  &lt; 2e-16 ***\nus_spread.l2  3.149e-03  6.797e-03   0.463 0.643122    \nlog_kospi.l2 -4.948e-02  1.736e-02  -2.851 0.004378 ** \nlog_sp500.l2  1.165e-01  1.783e-02   6.533 7.00e-11 ***\nus_spread.l3  3.961e-03  6.796e-03   0.583 0.560010    \nlog_kospi.l3  1.150e-02  1.740e-02   0.661 0.508860    \nlog_sp500.l3  2.171e-02  1.833e-02   1.184 0.236461    \nus_spread.l4  1.208e-02  6.797e-03   1.777 0.075545 .  \nlog_kospi.l4  1.366e-02  1.702e-02   0.803 0.422232    \nlog_sp500.l4 -4.602e-02  1.816e-02  -2.535 0.011276 *  \nus_spread.l5 -1.230e-02  4.795e-03  -2.564 0.010364 *  \nlog_kospi.l5 -1.436e-02  1.208e-02  -1.189 0.234606    \nlog_sp500.l5  3.140e-02  1.456e-02   2.156 0.031122 *  \nconst         3.451e-02  9.932e-03   3.474 0.000516 ***\ntrend         1.580e-06  3.986e-07   3.963 7.49e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01234 on 5898 degrees of freedom\nMultiple R-Squared: 0.9995, Adjusted R-squared: 0.9995 \nF-statistic: 7.667e+05 on 16 and 5898 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n           us_spread  log_kospi  log_sp500\nus_spread  1.120e-03 -4.196e-07 -1.812e-05\nlog_kospi -4.196e-07  1.620e-04  4.394e-05\nlog_sp500 -1.812e-05  4.394e-05  1.523e-04\n\nCorrelation matrix of residuals:\n           us_spread  log_kospi log_sp500\nus_spread  1.0000000 -0.0009848  -0.04386\nlog_kospi -0.0009848  1.0000000   0.27970\nlog_sp500 -0.0438603  0.2797035   1.00000\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df1, p=10, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: us_spread, log_kospi, log_sp500 \nDeterministic variables: both \nSample size: 5910 \nLog Likelihood: 47045.173 \nRoots of the characteristic polynomial:\n0.999 0.9984 0.9951 0.7704 0.7704 0.7486 0.7486 0.7463 0.7463 0.7041 0.7041 0.6959 0.6895 0.6895 0.6807 0.6807 0.6722 0.6554 0.6554 0.6546 0.6546 0.6301 0.6301 0.601 0.601 0.5982 0.5982 0.4709 0.4588 0.3093\nCall:\nVAR(y = new_df1, p = 10, type = \"both\")\n\n\nEstimation results for equation us_spread: \n========================================== \nus_spread = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + us_spread.l6 + log_kospi.l6 + log_sp500.l6 + us_spread.l7 + log_kospi.l7 + log_sp500.l7 + us_spread.l8 + log_kospi.l8 + log_sp500.l8 + us_spread.l9 + log_kospi.l9 + log_sp500.l9 + us_spread.l10 + log_kospi.l10 + log_sp500.l10 + const + trend \n\n                Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1   1.002e+00  1.305e-02  76.749  &lt; 2e-16 ***\nlog_kospi.l1   3.737e-03  3.569e-02   0.105 0.916600    \nlog_sp500.l1   6.888e-02  3.692e-02   1.866 0.062132 .  \nus_spread.l2   1.230e-03  1.846e-02   0.067 0.946885    \nlog_kospi.l2  -3.245e-02  4.708e-02  -0.689 0.490682    \nlog_sp500.l2   6.665e-05  4.857e-02   0.001 0.998905    \nus_spread.l3  -1.983e-02  1.843e-02  -1.076 0.282071    \nlog_kospi.l3   2.075e-02  4.720e-02   0.440 0.660182    \nlog_sp500.l3   5.134e-02  4.989e-02   1.029 0.303429    \nus_spread.l4  -1.334e-02  1.841e-02  -0.725 0.468652    \nlog_kospi.l4  -7.511e-04  4.720e-02  -0.016 0.987305    \nlog_sp500.l4   4.288e-02  4.984e-02   0.860 0.389668    \nus_spread.l5   9.839e-04  1.841e-02   0.053 0.957376    \nlog_kospi.l5  -6.118e-02  4.718e-02  -1.297 0.194734    \nlog_sp500.l5  -6.796e-02  4.989e-02  -1.362 0.173150    \nus_spread.l6   1.159e-02  1.840e-02   0.629 0.529055    \nlog_kospi.l6   1.586e-01  4.722e-02   3.359 0.000786 ***\nlog_sp500.l6  -6.364e-02  4.981e-02  -1.278 0.201468    \nus_spread.l7   2.156e-02  1.841e-02   1.171 0.241726    \nlog_kospi.l7  -1.830e-02  4.724e-02  -0.387 0.698491    \nlog_sp500.l7  -1.358e-01  4.980e-02  -2.727 0.006407 ** \nus_spread.l8   3.135e-03  1.842e-02   0.170 0.864816    \nlog_kospi.l8  -5.057e-02  4.724e-02  -1.071 0.284413    \nlog_sp500.l8   1.883e-01  4.983e-02   3.778 0.000159 ***\nus_spread.l9  -1.267e-02  1.844e-02  -0.687 0.492146    \nlog_kospi.l9  -7.425e-02  4.621e-02  -1.607 0.108167    \nlog_sp500.l9  -9.591e-02  4.943e-02  -1.940 0.052404 .  \nus_spread.l10  4.044e-03  1.302e-02   0.311 0.756052    \nlog_kospi.l10  5.440e-02  3.283e-02   1.657 0.097623 .  \nlog_sp500.l10  1.349e-02  3.967e-02   0.340 0.733836    \nconst         -1.445e-02  2.705e-02  -0.534 0.593179    \ntrend          3.707e-08  1.086e-06   0.034 0.972763    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.03338 on 5878 degrees of freedom\nMultiple R-Squared: 0.9981, Adjusted R-squared: 0.9981 \nF-statistic: 1.007e+05 on 31 and 5878 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_kospi: \n========================================== \nlog_kospi = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + us_spread.l6 + log_kospi.l6 + log_sp500.l6 + us_spread.l7 + log_kospi.l7 + log_sp500.l7 + us_spread.l8 + log_kospi.l8 + log_sp500.l8 + us_spread.l9 + log_kospi.l9 + log_sp500.l9 + us_spread.l10 + log_kospi.l10 + log_sp500.l10 + const + trend \n\n                Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1   3.823e-03  4.961e-03   0.770  0.44105    \nlog_kospi.l1   8.713e-01  1.357e-02  64.213  &lt; 2e-16 ***\nlog_sp500.l1   4.219e-01  1.404e-02  30.057  &lt; 2e-16 ***\nus_spread.l2  -1.007e-02  7.018e-03  -1.435  0.15138    \nlog_kospi.l2   7.196e-02  1.790e-02   4.021 5.88e-05 ***\nlog_sp500.l2  -2.801e-01  1.847e-02 -15.166  &lt; 2e-16 ***\nus_spread.l3   2.181e-03  7.007e-03   0.311  0.75564    \nlog_kospi.l3   2.189e-02  1.794e-02   1.220  0.22256    \nlog_sp500.l3  -2.711e-02  1.897e-02  -1.429  0.15294    \nus_spread.l4   3.345e-03  7.000e-03   0.478  0.63279    \nlog_kospi.l4   6.615e-03  1.795e-02   0.369  0.71247    \nlog_sp500.l4  -7.452e-02  1.895e-02  -3.932 8.53e-05 ***\nus_spread.l5  -8.468e-03  6.999e-03  -1.210  0.22639    \nlog_kospi.l5  -1.493e-02  1.794e-02  -0.832  0.40531    \nlog_sp500.l5  -1.364e-02  1.897e-02  -0.719  0.47203    \nus_spread.l6   1.404e-02  6.997e-03   2.007  0.04483 *  \nlog_kospi.l6   4.627e-02  1.795e-02   2.577  0.00998 ** \nlog_sp500.l6  -1.438e-02  1.894e-02  -0.759  0.44783    \nus_spread.l7  -2.637e-03  7.000e-03  -0.377  0.70636    \nlog_kospi.l7  -1.601e-02  1.796e-02  -0.892  0.37269    \nlog_sp500.l7   3.496e-02  1.893e-02   1.846  0.06490 .  \nus_spread.l8   6.284e-03  7.002e-03   0.898  0.36947    \nlog_kospi.l8  -1.374e-02  1.796e-02  -0.765  0.44418    \nlog_sp500.l8   1.423e-02  1.895e-02   0.751  0.45251    \nus_spread.l9  -1.457e-02  7.010e-03  -2.078  0.03772 *  \nlog_kospi.l9   4.660e-02  1.757e-02   2.652  0.00802 ** \nlog_sp500.l9  -3.879e-02  1.880e-02  -2.064  0.03907 *  \nus_spread.l10  6.351e-03  4.949e-03   1.283  0.19941    \nlog_kospi.l10 -2.255e-02  1.248e-02  -1.806  0.07090 .  \nlog_sp500.l10 -2.325e-02  1.508e-02  -1.541  0.12326    \nconst          2.347e-02  1.029e-02   2.282  0.02253 *  \ntrend          5.469e-07  4.128e-07   1.325  0.18527    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01269 on 5878 degrees of freedom\nMultiple R-Squared: 0.9992, Adjusted R-squared: 0.9992 \nF-statistic: 2.479e+05 on 31 and 5878 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_sp500: \n========================================== \nlog_sp500 = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + us_spread.l6 + log_kospi.l6 + log_sp500.l6 + us_spread.l7 + log_kospi.l7 + log_sp500.l7 + us_spread.l8 + log_kospi.l8 + log_sp500.l8 + us_spread.l9 + log_kospi.l9 + log_sp500.l9 + us_spread.l10 + log_kospi.l10 + log_sp500.l10 + const + trend \n\n                Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  -5.799e-03  4.795e-03  -1.209 0.226579    \nlog_kospi.l1   3.762e-02  1.311e-02   2.868 0.004143 ** \nlog_sp500.l1   8.775e-01  1.357e-02  64.678  &lt; 2e-16 ***\nus_spread.l2   3.384e-03  6.783e-03   0.499 0.617871    \nlog_kospi.l2  -5.056e-02  1.730e-02  -2.922 0.003486 ** \nlog_sp500.l2   1.102e-01  1.785e-02   6.173 7.13e-10 ***\nus_spread.l3   1.698e-03  6.773e-03   0.251 0.802102    \nlog_kospi.l3   1.404e-02  1.734e-02   0.809 0.418430    \nlog_sp500.l3   2.354e-02  1.833e-02   1.284 0.199261    \nus_spread.l4   1.370e-02  6.766e-03   2.025 0.042940 *  \nlog_kospi.l4   1.411e-02  1.735e-02   0.814 0.415946    \nlog_sp500.l4  -4.545e-02  1.832e-02  -2.481 0.013127 *  \nus_spread.l5  -7.747e-03  6.765e-03  -1.145 0.252170    \nlog_kospi.l5  -5.645e-02  1.734e-02  -3.256 0.001136 ** \nlog_sp500.l5   1.783e-02  1.833e-02   0.973 0.330697    \nus_spread.l6  -9.871e-04  6.763e-03  -0.146 0.883962    \nlog_kospi.l6   3.333e-02  1.735e-02   1.921 0.054797 .  \nlog_sp500.l6  -1.365e-02  1.831e-02  -0.746 0.455959    \nus_spread.l7  -1.439e-02  6.766e-03  -2.127 0.033500 *  \nlog_kospi.l7  -1.557e-02  1.736e-02  -0.897 0.369785    \nlog_sp500.l7   8.217e-02  1.830e-02   4.490 7.26e-06 ***\nus_spread.l8   2.489e-02  6.768e-03   3.678 0.000237 ***\nlog_kospi.l8  -2.296e-02  1.736e-02  -1.323 0.186001    \nlog_sp500.l8  -4.501e-02  1.831e-02  -2.458 0.014006 *  \nus_spread.l9  -1.923e-02  6.775e-03  -2.838 0.004551 ** \nlog_kospi.l9   8.825e-02  1.698e-02   5.197 2.09e-07 ***\nlog_sp500.l9   4.684e-03  1.817e-02   0.258 0.796531    \nus_spread.l10  4.649e-03  4.783e-03   0.972 0.331154    \nlog_kospi.l10 -4.380e-02  1.207e-02  -3.630 0.000286 ***\nlog_sp500.l10 -1.467e-02  1.458e-02  -1.006 0.314295    \nconst          3.262e-02  9.941e-03   3.281 0.001040 ** \ntrend          1.486e-06  3.990e-07   3.724 0.000198 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01227 on 5878 degrees of freedom\nMultiple R-Squared: 0.9995, Adjusted R-squared: 0.9995 \nF-statistic: 4.005e+05 on 31 and 5878 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n           us_spread  log_kospi  log_sp500\nus_spread  1.114e-03 -1.219e-06 -1.667e-05\nlog_kospi -1.219e-06  1.611e-04  4.338e-05\nlog_sp500 -1.667e-05  4.338e-05  1.505e-04\n\nCorrelation matrix of residuals:\n          us_spread log_kospi log_sp500\nus_spread  1.000000 -0.002877  -0.04071\nlog_kospi -0.002877  1.000000   0.27864\nlog_sp500 -0.040713  0.278642   1.00000\n\n\nThe VAR(2) model captures the short-term dynamics among the variables efficiently. The U.S. spread (us_spread) equation is mainly driven by its own lagged values, while both the Korean and U.S. stock indices (log_kospi and log_sp500) show strong dependence on their own past values and some cross-market effects. Most coefficients are statistically significant, and the model achieves a high R-squared (above 0.999) with low residual correlations, indicating a good fit and stable dynamics (all roots below one).\nThe VAR(5) model slightly improves the overall fit, as reflected by a marginal increase in log-likelihood and a small reduction in residual variance. Some additional lag terms, especially for the stock market variables, become significant, suggesting that the model captures medium-term interdependencies between the U.S. and Korean markets. However, several higher-order lag coefficients remain insignificant, implying that the added complexity provides limited explanatory gain.\nThe VAR(10) model, while achieving the highest log-likelihood, shows minimal improvement in explanatory power relative to the VAR(5) model. Many of the higher-order lag terms are statistically insignificant, and the R-squared values remain nearly identical to those of the simpler models. This indicates potential overfitting, as the model includes many parameters without substantial improvement in predictive accuracy.\n\n\n\n\nCode\nn=length(df1$log_sp500) \nk=1480 #1480\n#n-k=4440; 4440/252=17.619\nrmse1 &lt;- matrix(NA, 4440,3) #here 4440 is n-k\nrmse2 &lt;- matrix(NA, 4440,3)\nrmse3 &lt;- matrix(NA,4440,3) #here n-k / 252 = 4440/252 =17.619\nyear&lt;-c()\nts_obj &lt;- ts(df1[, c(2,5,6)], start=decimal_date(as.Date(\"2000-12-18\",format = \"%Y-%m-%d\")),frequency = 252)\nst &lt;- tsp(ts_obj)[1]+(k-1)/252 \nfor(i in 1:17) #here 17 is (n-k ) / 252 = 4440/252 =17.619\n{\n  \n  xtrain &lt;- window(ts_obj, end=st + i-1)\n  xtest &lt;- window(ts_obj, start=st + (i-1) + 1/252, end=st + i)\n  \n  # first model p = 2 \n  fit &lt;- vars::VAR(xtrain, p=2, type='both')\n  fcast &lt;- predict(fit, n.ahead = 252)\n  \n  fspread&lt;-fcast$fcst$us_spread\n  fkospi&lt;-fcast$fcst$log_kospi\n  fsp&lt;-fcast$fcst$log_sp500\n  \n  ff1&lt;-data.frame(fspread[,1],fkospi[,1],fsp[,1]) \n  year&lt;-st + (i-1) + 1/252 \n  \n  \n  ff1&lt;-ts(ff1,start=c(year,1),frequency = 252)\n  \n  a = 252*i-251 \n  b= 252*i \n \n  rmse1[c(a:b),]  &lt;-sqrt((ff1-xtest)^2)\n  \n  #second model p = 5\n  fit2 &lt;- vars::VAR(xtrain, p=5, type='both')\n  fcast2 &lt;- predict(fit2, n.ahead = 252)\n  \n  fspread2&lt;-fcast2$fcst$us_spread\n  fkospi2&lt;-fcast2$fcst$log_kospi\n  fsp2&lt;-fcast2$fcst$log_sp500\n  ff2&lt;-data.frame(fspread2[,1],fkospi2[,1],fsp2[,1])\n  \n  year&lt;-st + (i-1) + 1/252\n  \n  ff2&lt;-ts(ff2,start=c(year,1),frequency = 252)\n  \n  a = 252*i-251\n  b= 252*i\n  rmse2[c(a:b),]  &lt;-sqrt((ff2-xtest)^2)\n  \n  #third model p = 10\n  fit3 &lt;- vars::VAR(xtrain, p=10, type='both')\n  fcast3 &lt;- predict(fit3, n.ahead = 252)\n  \n  fspread3&lt;-fcast3$fcst$us_spread\n  fkospi3&lt;-fcast3$fcst$log_kospi\n  fsp3&lt;-fcast3$fcst$log_sp500\n  ff3&lt;-data.frame(fspread3[,1],fkospi3[,1],fsp3[,1])\n  \n  year&lt;-st + (i-1) + 1/252\n  \n  ff3&lt;-ts(ff3,start=c(year,1),frequency = 252)\n  \n  a = 252*i-251\n  b= 252*i\n  rmse3[c(a:b),]  &lt;-sqrt((ff3-xtest)^2)\n}\n\n\n\n\nCode\nday_index = 1:4440\ndates1 = as.Date(df1$Date[(k+1):n])\nrmse1 = data.frame(day_index,dates1,rmse1)\nnames(rmse1) =c(\"Day\",\"Date\",\"log_kospi\",\"log_sp500\",\"us_spread\")\nrmse2 = data.frame(day_index,dates1,rmse2)\nnames(rmse2) =c(\"Day\",\"Date\",\"log_kospi\",\"log_sp500\",\"us_spread\")\nrmse3 = data.frame(day_index,dates1,rmse3)\nnames(rmse3) =c(\"Day\",\"Date\",\"log_kospi\",\"log_sp500\",\"us_spread\")\nrmse1$Model &lt;- \"VAR(2)\"\nrmse2$Model &lt;- \"VAR(5)\"\nrmse3$Model &lt;- \"VAR(10)\"\nrmse_combined &lt;- rbind(rmse1, rmse2, rmse3)\nrmse1$Model &lt;- \"VAR(2)\"\nrmse2$Model &lt;- \"VAR(5)\"\nrmse3$Model &lt;- \"VAR(10)\"\nrmse_combined &lt;- rbind(rmse1, rmse2, rmse3)\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = log_kospi, color = Model)) + \n  geom_line() +\n  labs(\n    title = \"CV RMSE for log_kospi\",\n    x = \"Day\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = log_sp500, color = Model)) + \n  geom_line() +\n  labs(\n    title = \"CV RMSE for log_sp500\",\n    x = \"Day\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = us_spread, color = Model)) + \n  geom_line() +\n  labs(\n    title = \"CV RMSE for us_spread\",\n    x = \"Day\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nvar5&lt;- VAR(ts_obj,p = 5,type= \"both\")\nacf(residuals(var5))\n\n\n\n\n\n\n\n\n\nThe three line plots above show the RMSE values for three variables, comparing the VAR(2),VAR(5) and var(10) models. Although it’s somewhat difficult to clearly distinguish which model performs better based solely on the plots, the VAR(2) model appears to have slightly lower RMSE values overall. Therefore, I decided to proceed with the VAR(5) model for further analysis.\nlast plot is a acf plot for var(5) model’s residuals. From the plot, the residual autocorrelations are mostly within the 95% confidence bounds , except for a strong spike at lag 0, which simply reflects the correlation of each residual with itself. The absence of significant spikes beyond lag 0 suggests that the VAR(5) specification has successfully removed serial correlation from the system. This implies that the model order (p=5) is sufficient.\nOverall, the ACF of the residuals confirms that the VAR(5) model is appropriately specified and that the residuals behave as approximately white noise.\n\n\n\n\nCode\ndf1$Date &lt;- as.Date(df1$Date)\nn &lt;- nrow(df1)\n\nactual_frequency &lt;- nrow(df1) / as.numeric(difftime(max(df1$Date), \n                                                     min(df1$Date), \n                                                     units = \"days\")) * 365.25\n\nts_obj &lt;- ts(df1[, c(\"us_spread\", \"log_kospi\", \"log_sp500\")],\n             start = decimal_date(min(df1$Date)),\n             frequency = round(actual_frequency))\n\n\n\nh &lt;- 504\nfcast &lt;- forecast(var5, h = h)\n\n\nhist_dates &lt;- df1$Date\n\nlast_date &lt;- max(df1$Date)\n\nall_future_dates &lt;- seq(last_date + 1, by = \"day\", length.out = 1000)\nfuture_weekdays &lt;- all_future_dates[!weekdays(all_future_dates) %in% c(\"Saturday\", \"Sunday\")]\nfcast_dates &lt;- head(future_weekdays, h)\n\n\nfig1 &lt;- plot_ly() %&gt;%\n  add_lines(\n    x = tail(hist_dates, 2500),\n    y = tail(df1$us_spread, 2500),\n    name = \"Historical\",\n    line = list(color = \"black\", width = 1),\n    hovertemplate = \"%{x|%Y-%m-%d}&lt;br&gt;%{y:.4f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_lines(\n    x = fcast_dates,\n    y = as.numeric(fcast$forecast$us_spread$mean),\n    name = \"Forecast\",\n    line = list(color = \"blue\", width = 2),\n    hovertemplate = \"%{x|%Y-%m-%d}&lt;br&gt;%{y:.4f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$us_spread$lower[,2]),\n    ymax = as.numeric(fcast$forecast$us_spread$upper[,2]),\n    name = \"95% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$us_spread$lower[,1]),\n    ymax = as.numeric(fcast$forecast$us_spread$upper[,1]),\n    name = \"80% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  layout(\n    title = \"VAR(5) Forecast for US Spread\",\n    xaxis = list(\n      title = \"Year\",\n      type = \"date\",\n      tickformat = \"%Y\",     \n      dtick = \"M12\"         \n    ),\n    yaxis = list(title = \"US Spread\"),\n    hovermode = \"x unified\"\n  )\n\n\nfig2 &lt;- plot_ly() %&gt;%\n  add_lines(\n    x = tail(hist_dates, 2500),\n    y = exp(tail(df1$log_kospi, 2500)),\n    name = \"Historical\",\n    line = list(color = \"black\", width = 1),\n    hovertemplate = \"%{x|%Y-%m-%d}&lt;br&gt;%{y:.2f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_lines(\n    x = fcast_dates,\n    y = exp(as.numeric(fcast$forecast$log_kospi$mean)),\n    name = \"Forecast\",\n    line = list(color = \"blue\", width = 2),\n    hovertemplate = \"%{x|%Y-%m-%d}&lt;br&gt;%{y:.2f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = exp(as.numeric(fcast$forecast$log_kospi$lower[,2])),\n    ymax = exp(as.numeric(fcast$forecast$log_kospi$upper[,2])),\n    name = \"95% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = exp(as.numeric(fcast$forecast$log_kospi$lower[,1])),\n    ymax = exp(as.numeric(fcast$forecast$log_kospi$upper[,1])),\n    name = \"80% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  layout(\n    title = \"VAR(5) Forecast for KOSPI\",\n    xaxis = list(\n      title = \"Year\",\n      type = \"date\",\n      tickformat = \"%Y\",\n      dtick = \"M12\"\n    ),\n    yaxis = list(title = \"KOSPI Index\"),\n    hovermode = \"x unified\"\n  )\n\n\nfig3 &lt;- plot_ly() %&gt;%\n  add_lines(\n    x = tail(hist_dates, 2500),\n    y = exp(tail(df1$log_sp500, 2500)),\n    name = \"Historical\",\n    line = list(color = \"black\", width = 1),\n    hovertemplate = \"%{x|%Y-%m-%d}&lt;br&gt;%{y:.2f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_lines(\n    x = fcast_dates,\n    y = exp(as.numeric(fcast$forecast$log_sp500$mean)),\n    name = \"Forecast\",\n    line = list(color = \"blue\", width = 2),\n    hovertemplate = \"%{x|%Y-%m-%d}&lt;br&gt;%{y:.2f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = exp(as.numeric(fcast$forecast$log_sp500$lower[,2])),\n    ymax = exp(as.numeric(fcast$forecast$log_sp500$upper[,2])),\n    name = \"95% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = exp(as.numeric(fcast$forecast$log_sp500$lower[,1])),\n    ymax = exp(as.numeric(fcast$forecast$log_sp500$upper[,1])),\n    name = \"80% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  layout(\n    title = \"VAR(5) Forecast for S&P 500\",\n    xaxis = list(\n      title = \"Year\",\n      type = \"date\",\n      tickformat = \"%Y\",\n      dtick = \"M12\"\n    ),\n    yaxis = list(title = \"S&P 500 Index\"),\n    hovermode = \"x unified\"\n  )\n\nfig1\n\n\n\n\n\n\nCode\nfig2\n\n\n\n\n\n\nCode\nfig3\n\n\n\n\n\n\nFrom the forecast plot, the VAR model demonstrates a good fit, accurately capturing the patterns of past data and projecting trends for the next two years. The model forecasts an increase in the U.S. 3-year and 10-year spreads as well as the S&P 500 index, while predicting an opposite movement for the KOSPI index.\nThis result is both interesting and economically reasonable. As the U.S. yield spreads rise, investors are likely to favor U.S. dollar–denominated assets, leading to a stronger dollar. However, this appreciation of the USD tends to weaken the Korean won (KRW), which in turn exerts downward pressure on the KOSPI index.\n\n\n\n\n\nUS treasury yield curve 10 Years, South Korea government bond rate 10Years, seoul housing index\n\ndata cleaning process\n\n\nCode\nkor_yield_10&lt;- kor_yield%&gt;%\n  dplyr::select(Date,KR_10Y)\nkor_yield_monthly &lt;- kor_yield_10 %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,KR_10Y)\n\n\nus_yield_10&lt;- us_yield%&gt;%\n  dplyr::select(Date,US_10Y)\nus_yield_monthly &lt;- us_yield_10 %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,US_10Y)\n\ndf2&lt;- housing%&gt;%\n  left_join(kor_yield_monthly,by = \"Date\")%&gt;%\n  left_join(us_yield_monthly, by = \"Date\")\n\nstart_year_df2  &lt;- year(min(df2$Date))\nstart_month_df2 &lt;- month(min(df2$Date))\n\n\n\ntime series plotparameter selectionmodel summaryCVForecast\n\n\n\n\nCode\np2 &lt;- plot_ly(df2, x = ~Date, y = ~housing, type = 'scatter', mode = 'lines',\n              name = \"Seoul housing Index\") %&gt;%\n  layout(yaxis = list(title = \"Seoul housing Index\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np3 &lt;- plot_ly(df2, x = ~Date, y = ~KR_10Y, type = 'scatter', mode = 'lines',\n              name = \"South Korea government bond yield rate(10years)\") %&gt;%\n  layout(yaxis = list(title = \"South Korea yield rate(10years)\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np4 &lt;- plot_ly(df2, x = ~Date, y = ~US_10Y, type = 'scatter', mode = 'lines',\n              name = \"U.S. treasury bond yield rate(10years)\") %&gt;%\n  layout(yaxis = list(title = \"KRW/USD spot rate\", titlefont = list(size = 14)))\n\nsubplot( p2, p3,p4, nrows = 3, shareX = TRUE, titleX = TRUE) %&gt;%\n  layout(title = list(text = \"U.S. treasury bond yield rate(10years)\"))\n\n\n\n\n\n\n\n\n\n\nCode\nnew_df2&lt;- df2[,c(2:4)]\ndf2.ts&lt;-ts(new_df2,star=decimal_date(as.Date(\"2003-11-30\",format = \"%Y-%m-%d\")),frequency = 12)\nVARselect(df2.ts, lag.max=10, type=\"both\")\n\n\n$selection\nAIC(n)  HQ(n)  SC(n) FPE(n) \n     3      3      2      3 \n\n$criteria\n                   1             2             3             4             5\nAIC(n) -7.2354237514 -8.6966493085 -8.7538981175 -8.6951961691 -8.6376638957\nHQ(n)  -7.1506390633 -8.5609938075 -8.5673718036 -8.4577990423 -8.3493959561\nSC(n)  -7.0247393128 -8.3595542068 -8.2903923526 -8.1052797410 -7.9213368045\nFPE(n)  0.0007206133  0.0001671558  0.0001578714  0.0001674462  0.0001774111\n                   6             7             8             9            10\nAIC(n) -8.5859212103 -8.5718104042 -8.5100114868 -8.4743238217 -8.4526816818\nHQ(n)  -8.2467824578 -8.1818008388 -8.0691311085 -7.9825726306 -7.9100596778\nSC(n)  -7.7431834559 -7.6026619867 -7.4144524061 -7.2523540779 -7.1043012748\nFPE(n)  0.0001869059  0.0001896626  0.0002018927  0.0002094105  0.0002142223\n\n\nFrom parameter selction process, two parameters were suggested; p = 2,3\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df2, p=2, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: housing, KR_10Y, US_10Y \nDeterministic variables: both \nSample size: 259 \nLog Likelihood: 45.633 \nRoots of the characteristic polynomial:\n0.965 0.947 0.9063 0.9063 0.1358 0.02788\nCall:\nVAR(y = new_df2, p = 2, type = \"both\")\n\n\nEstimation results for equation housing: \n======================================== \nhousing = housing.l1 + KR_10Y.l1 + US_10Y.l1 + housing.l2 + KR_10Y.l2 + US_10Y.l2 + const + trend \n\n            Estimate Std. Error t value Pr(&gt;|t|)    \nhousing.l1  1.858502   0.030694  60.549  &lt; 2e-16 ***\nKR_10Y.l1   0.151384   0.088160   1.717 0.087186 .  \nUS_10Y.l1  -0.088694   0.081804  -1.084 0.279307    \nhousing.l2 -0.870774   0.031228 -27.884  &lt; 2e-16 ***\nKR_10Y.l2  -0.112900   0.087955  -1.284 0.200459    \nUS_10Y.l2   0.043591   0.080985   0.538 0.590873    \nconst       0.789500   0.236201   3.342 0.000957 ***\ntrend       0.002052   0.001134   1.810 0.071557 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.269 on 251 degrees of freedom\nMultiple R-Squared: 0.9996, Adjusted R-squared: 0.9996 \nF-statistic: 9.185e+04 on 7 and 251 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation KR_10Y: \n======================================= \nKR_10Y = housing.l1 + KR_10Y.l1 + US_10Y.l1 + housing.l2 + KR_10Y.l2 + US_10Y.l2 + const + trend \n\n             Estimate Std. Error t value Pr(&gt;|t|)    \nhousing.l1  0.0546272  0.0257766   2.119 0.035051 *  \nKR_10Y.l1   0.7155168  0.0740362   9.664  &lt; 2e-16 ***\nUS_10Y.l1   0.2772800  0.0686984   4.036 7.22e-05 ***\nhousing.l2 -0.0489818  0.0262253  -1.868 0.062965 .  \nKR_10Y.l2   0.2164915  0.0738636   2.931 0.003691 ** \nUS_10Y.l2  -0.2467968  0.0680101  -3.629 0.000345 ***\nconst      -0.1526568  0.1983593  -0.770 0.442262    \ntrend      -0.0014886  0.0009524  -1.563 0.119324    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.2259 on 251 degrees of freedom\nMultiple R-Squared: 0.9717, Adjusted R-squared: 0.9709 \nF-statistic:  1233 on 7 and 251 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation US_10Y: \n======================================= \nUS_10Y = housing.l1 + KR_10Y.l1 + US_10Y.l1 + housing.l2 + KR_10Y.l2 + US_10Y.l2 + const + trend \n\n             Estimate Std. Error t value Pr(&gt;|t|)    \nhousing.l1  0.0373124  0.0282106   1.323   0.1872    \nKR_10Y.l1  -0.0004244  0.0810271  -0.005   0.9958    \nUS_10Y.l1   1.0356735  0.0751852  13.775   &lt;2e-16 ***\nhousing.l2 -0.0468702  0.0287016  -1.633   0.1037    \nKR_10Y.l2   0.1057487  0.0808381   1.308   0.1920    \nUS_10Y.l2  -0.1373780  0.0744319  -1.846   0.0661 .  \nconst       0.3944815  0.2170893   1.817   0.0704 .  \ntrend       0.0025613  0.0010423   2.457   0.0147 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.2473 on 251 degrees of freedom\nMultiple R-Squared: 0.9549, Adjusted R-squared: 0.9536 \nF-statistic: 758.9 on 7 and 251 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n           housing   KR_10Y     US_10Y\nhousing  0.0723737 0.007764 -0.0005108\nKR_10Y   0.0077642 0.051041  0.0303960\nUS_10Y  -0.0005108 0.030396  0.0611356\n\nCorrelation matrix of residuals:\n          housing KR_10Y    US_10Y\nhousing  1.000000 0.1277 -0.007679\nKR_10Y   0.127745 1.0000  0.544137\nUS_10Y  -0.007679 0.5441  1.000000\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df2, p=3, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: housing, KR_10Y, US_10Y \nDeterministic variables: both \nSample size: 258 \nLog Likelihood: 61.065 \nRoots of the characteristic polynomial:\n0.9749 0.9524 0.8751 0.8751 0.3857 0.3857 0.3273 0.3273 0.2444\nCall:\nVAR(y = new_df2, p = 3, type = \"both\")\n\n\nEstimation results for equation housing: \n======================================== \nhousing = housing.l1 + KR_10Y.l1 + US_10Y.l1 + housing.l2 + KR_10Y.l2 + US_10Y.l2 + housing.l3 + KR_10Y.l3 + US_10Y.l3 + const + trend \n\n            Estimate Std. Error t value Pr(&gt;|t|)    \nhousing.l1  2.043800   0.061604  33.176   &lt;2e-16 ***\nKR_10Y.l1   0.129385   0.087402   1.480   0.1401    \nUS_10Y.l1  -0.056602   0.079288  -0.714   0.4760    \nhousing.l2 -1.247417   0.117832 -10.586   &lt;2e-16 ***\nKR_10Y.l2  -0.250874   0.105057  -2.388   0.0177 *  \nUS_10Y.l2  -0.100860   0.106653  -0.946   0.3452    \nhousing.l3  0.194519   0.061320   3.172   0.0017 ** \nKR_10Y.l3   0.148010   0.086738   1.706   0.0892 .  \nUS_10Y.l3   0.131469   0.080463   1.634   0.1036    \nconst       0.574709   0.236642   2.429   0.0159 *  \ntrend       0.001537   0.001143   1.345   0.1799    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.2592 on 247 degrees of freedom\nMultiple R-Squared: 0.9996, Adjusted R-squared: 0.9996 \nF-statistic: 6.814e+04 on 10 and 247 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation KR_10Y: \n======================================= \nKR_10Y = housing.l1 + KR_10Y.l1 + US_10Y.l1 + housing.l2 + KR_10Y.l2 + US_10Y.l2 + housing.l3 + KR_10Y.l3 + US_10Y.l3 + const + trend \n\n             Estimate Std. Error t value Pr(&gt;|t|)    \nhousing.l1  0.1737428  0.0533434   3.257  0.00128 ** \nKR_10Y.l1   0.6915471  0.0756818   9.138  &lt; 2e-16 ***\nUS_10Y.l1   0.2973998  0.0686561   4.332 2.15e-05 ***\nhousing.l2 -0.2956775  0.1020320  -2.898  0.00409 ** \nKR_10Y.l2   0.1876121  0.0909700   2.062  0.04022 *  \nUS_10Y.l2  -0.2534877  0.0923513  -2.745  0.00650 ** \nhousing.l3  0.1301736  0.0530975   2.452  0.01492 *  \nKR_10Y.l3   0.0376365  0.0751073   0.501  0.61674    \nUS_10Y.l3  -0.0001830  0.0696738  -0.003  0.99791    \nconst      -0.2884201  0.2049101  -1.408  0.16052    \ntrend      -0.0020085  0.0009898  -2.029  0.04350 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.2244 on 247 degrees of freedom\nMultiple R-Squared: 0.9723, Adjusted R-squared: 0.9712 \nF-statistic: 867.2 on 10 and 247 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation US_10Y: \n======================================= \nUS_10Y = housing.l1 + KR_10Y.l1 + US_10Y.l1 + housing.l2 + KR_10Y.l2 + US_10Y.l2 + housing.l3 + KR_10Y.l3 + US_10Y.l3 + const + trend \n\n            Estimate Std. Error t value Pr(&gt;|t|)    \nhousing.l1  0.131134   0.058612   2.237   0.0262 *  \nKR_10Y.l1   0.004759   0.083156   0.057   0.9544    \nUS_10Y.l1   1.049307   0.075436  13.910   &lt;2e-16 ***\nhousing.l2 -0.250432   0.112109  -2.234   0.0264 *  \nKR_10Y.l2   0.141081   0.099954   1.411   0.1594    \nUS_10Y.l2  -0.223614   0.101472  -2.204   0.0285 *  \nhousing.l3  0.112508   0.058341   1.928   0.0549 .  \nKR_10Y.l3  -0.063515   0.082525  -0.770   0.4422    \nUS_10Y.l3   0.093791   0.076555   1.225   0.2217    \nconst       0.265366   0.225147   1.179   0.2397    \ntrend       0.001936   0.001088   1.780   0.0762 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.2466 on 247 degrees of freedom\nMultiple R-Squared: 0.9557, Adjusted R-squared: 0.9539 \nF-statistic: 532.4 on 10 and 247 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n          housing   KR_10Y    US_10Y\nhousing  0.067164 0.005595 -0.002621\nKR_10Y   0.005595 0.050359  0.029895\nUS_10Y  -0.002621 0.029895  0.060797\n\nCorrelation matrix of residuals:\n         housing KR_10Y   US_10Y\nhousing  1.00000 0.0962 -0.04102\nKR_10Y   0.09620 1.0000  0.54028\nUS_10Y  -0.04102 0.5403  1.00000\n\n\nIn the VAR(2) model, the housing variable is primarily driven by its own past values, with highly significant coefficients for its first and second lags (positive and negative, respectively), implying mean-reverting dynamics. Korean and U.S. long-term interest rates (KR_10Y and US_10Y) have only weak short-run effects on housing, as most of their coefficients are statistically insignificant. The KR_10Y equation shows strong persistence—its own first and second lags are significant and positive—and a significant influence from the U.S. 10-year yield, suggesting cross-country linkages in bond markets. The U.S. yield (US_10Y) equation confirms high persistence as well, with its first lag strongly significant, while the trend term is also positive and significant, indicating a gradual upward drift. Residual correlations show moderate co-movement between KR_10Y and US_10Y (ρ ≈ 0.54) but only weak links between interest rates and housing.\nThe VAR(3) model slightly improves the log-likelihood (from 45.63 to 61.07) and marginally lowers residual variances, suggesting a better fit. Additional lag terms introduce some new dynamics: the third lag of housing becomes positive and significant, implying cyclical adjustment, while the second lag of KR_10Y is now significant and negative, and the third lag positive, showing alternating effects on housing. In the KR_10Y equation, housing’s first, second, and third lags all become significant, reinforcing feedback from the housing market to Korean yields. The U.S. yield equation remains dominated by its own autoregressive terms, with limited cross-effects, though housing’s influence is now slightly stronger. Overall, the VAR(3) captures more complex intertemporal relationships and richer lag structures, but the incremental explanatory gain over VAR(2) is small, and most new coefficients are marginally significant.\n\n\n\n\nCode\ndf2$Date &lt;- as.Date(df2$Date)\n\nseries_names &lt;- c(\"housing\", \"KR_10Y\", \"US_10Y\")\n\n\n\nts_obj &lt;- ts(df2[, series_names],\n             start = c(year(df2$Date[1]), month(df2$Date[1])),\n             frequency = 12)\n\n\nn &lt;- nrow(df2)\nk&lt;- 69\nh &lt;- 12\nn_k &lt;- n - k\nnum_blocks &lt;- floor(n_k / h)\n\nrmse2 &lt;- matrix(NA_real_, n_k, 3)   \nrmse3 &lt;- matrix(NA_real_, n_k, 3)  \n\n\nst &lt;- tsp(ts_obj)[1] + (k - 1) / 12\n\n\nfor (i in 1:num_blocks) {\n  xtrain &lt;- window(ts_obj, end = st + i - 1)\n\n  xtest  &lt;- window(ts_obj,\n                   start = st + (i - 1) + 1/12,\n                   end   = st + i)\n\n  if (NROW(xtest) != h) next  \n\n  fit2   &lt;- vars::VAR(xtrain, p = 2, type = \"both\")\n  fcast2 &lt;- predict(fit2, n.ahead = h)\n\n  ff2 &lt;- cbind(\n    fcast2$fcst$housing[, 1],\n    fcast2$fcst$KR_10Y [, 1],\n    fcast2$fcst$US_10Y [, 1]\n  )\n\n  year &lt;- st + (i - 1) + 1/12\n  ff2  &lt;- ts(ff2, start = c(year, 1), frequency = 12)\n\n  a &lt;- 12 * i - 11\n  b &lt;- 12 * i\n  rmse2[a:b, ] &lt;- sqrt((ff2 - xtest)^2)\n\n  fit3   &lt;- vars::VAR(xtrain, p = 3, type = \"both\")\n  fcast3 &lt;- predict(fit3, n.ahead = h)\n\n  ff3 &lt;- cbind(\n    fcast3$fcst$housing[, 1],\n    fcast3$fcst$KR_10Y [, 1],\n    fcast3$fcst$US_10Y [, 1]\n  )\n\n  ff3 &lt;- ts(ff3, start = c(year, 1), frequency = 12)\n\n  rmse3[a:b, ] &lt;- sqrt((ff3 - xtest)^2)\n}\n\ncolnames(rmse2) &lt;- series_names\ncolnames(rmse3) &lt;- series_names\n\nmonth_index &lt;- 1:n_k\ndates1 &lt;- as.Date(df2$Date[(k + 1):n])\n\nif (length(dates1) &lt; n_k) {\n  dates1 &lt;- c(dates1, rep(as.Date(NA), n_k - length(dates1)))\n} else if (length(dates1) &gt; n_k) {\n  dates1 &lt;- dates1[1:n_k]\n}\n\nrmse2_df &lt;- data.frame(month_index, dates1, rmse2, row.names = NULL)\nnames(rmse2_df) &lt;- c(\"Month\",\"Date\", series_names)\nrmse2_df$Model &lt;- \"VAR(2)\"\n\nrmse3_df &lt;- data.frame(month_index, dates1, rmse3, row.names = NULL)\nnames(rmse3_df) &lt;- c(\"Month\",\"Date\", series_names)\nrmse3_df$Model &lt;- \"VAR(3)\"\n\nrmse_combined &lt;- rbind(rmse2_df, rmse3_df)\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = housing, color = Model)) +\n  geom_line() +\n  labs(\n    title = \"CV RMSE for seoul housing index\",\n    x = \"Date\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = KR_10Y, color = Model)) +\n  geom_line() +\n  labs(\n    title = \"CV RMSE for korea government bond rate 10 years\",\n    x = \"Date\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = US_10Y, color = Model)) +\n  geom_line() +\n  labs(\n    title = \"CV RMSE for US treasury rate 10 years\",\n    x = \"Date\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nvar1&lt;- VAR(ts_obj,p = 2,type= \"both\")\nacf(residuals(var1))\n\n\n\n\n\n\n\n\n\nThe three line plots above show the RMSE values for three variables, comparing the VAR(2) and VAR(3) models. Although it’s somewhat difficult to clearly distinguish which model performs better based solely on the plots, the VAR(2) model appears to have slightly lower RMSE values overall. Therefore, I decided to proceed with the VAR(2) model for further analysis.\nlast plot is a acf plot for var(2) model’s residuals. From the plot, the residual autocorrelations are mostly within the 95% confidence bounds , except for a strong spike at lag 0, which simply reflects the correlation of each residual with itself. The absence of significant spikes beyond lag 0 suggests that the VAR(2) specification has successfully removed serial correlation from the system. This implies that the model order (p=2) is sufficient.\nOverall, the ACF of the residuals confirms that the VAR(2) model is appropriately specified and that the residuals behave as approximately white noise.\n\n\n\n\nCode\nh &lt;- 36\nfcast &lt;- forecast(var1, h = h)\n\nhist_dates &lt;- df2$Date\n\n\nlast_date &lt;- max(df2$Date)\nfcast_dates &lt;- seq(last_date, by = \"month\", length.out = h + 1)[-1]\nfcast_dates &lt;- ceiling_date(fcast_dates, \"month\") - days(1)\n\nfig1 &lt;- plot_ly() %&gt;%\n\n  add_lines(\n    x = tail(hist_dates, 100),\n    y = tail(df2$housing, 100),\n    name = \"Historical\",\n    line = list(color = \"black\", width = 1),\n    hovertemplate = \"%{x|%Y-%m}&lt;br&gt;%{y:.2f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n\n  add_lines(\n    x = fcast_dates,\n    y = as.numeric(fcast$forecast$housing$mean),\n    name = \"Forecast\",\n    line = list(color = \"blue\", width = 2),\n    hovertemplate = \"%{x|%Y-%m}&lt;br&gt;%{y:.2f}&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$housing$lower[,2]),\n    ymax = as.numeric(fcast$forecast$housing$upper[,2]),\n    name = \"95% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  # 80% CI\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$housing$lower[,1]),\n    ymax = as.numeric(fcast$forecast$housing$upper[,1]),\n    name = \"80% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  layout(\n    title = \"VAR(2) Forecast for Housing\",\n    xaxis = list(\n      title = \"Year\",\n      type = \"date\",\n      tickformat = \"%Y\",\n      dtick = \"M12\"\n    ),\n    yaxis = list(title = \"Housing Index\"),\n    hovermode = \"x unified\"\n  )\n\nfig2 &lt;- plot_ly() %&gt;%\n  add_lines(\n    x = tail(hist_dates, 100),\n    y = tail(df2$KR_10Y, 100),\n    name = \"Historical\",\n    line = list(color = \"black\", width = 1),\n    hovertemplate = \"%{x|%Y-%m}&lt;br&gt;%{y:.2f}%&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_lines(\n    x = fcast_dates,\n    y = as.numeric(fcast$forecast$KR_10Y$mean),\n    name = \"Forecast\",\n    line = list(color = \"blue\", width = 2),\n    hovertemplate = \"%{x|%Y-%m}&lt;br&gt;%{y:.2f}%&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$KR_10Y$lower[,2]),\n    ymax = as.numeric(fcast$forecast$KR_10Y$upper[,2]),\n    name = \"95% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$KR_10Y$lower[,1]),\n    ymax = as.numeric(fcast$forecast$KR_10Y$upper[,1]),\n    name = \"80% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  layout(\n    title = \"VAR(2) Forecast for Korea 10Y Yield\",\n    xaxis = list(\n      title = \"Year\",\n      type = \"date\",\n      tickformat = \"%Y\",\n      dtick = \"M12\"\n    ),\n    yaxis = list(title = \"Yield (%)\"),\n    hovermode = \"x unified\"\n  )\n\n\nfig3 &lt;- plot_ly() %&gt;%\n  add_lines(\n    x = tail(hist_dates, 100),\n    y = tail(df2$US_10Y, 100),\n    name = \"Historical\",\n    line = list(color = \"black\", width = 1),\n    hovertemplate = \"%{x|%Y-%m}&lt;br&gt;%{y:.2f}%&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_lines(\n    x = fcast_dates,\n    y = as.numeric(fcast$forecast$US_10Y$mean),\n    name = \"Forecast\",\n    line = list(color = \"blue\", width = 2),\n    hovertemplate = \"%{x|%Y-%m}&lt;br&gt;%{y:.2f}%&lt;extra&gt;&lt;/extra&gt;\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$US_10Y$lower[,2]),\n    ymax = as.numeric(fcast$forecast$US_10Y$upper[,2]),\n    name = \"95% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  add_ribbons(\n    x = fcast_dates,\n    ymin = as.numeric(fcast$forecast$US_10Y$lower[,1]),\n    ymax = as.numeric(fcast$forecast$US_10Y$upper[,1]),\n    name = \"80% CI\",\n    line = list(color = \"transparent\"),\n    hoverinfo = \"skip\"\n  ) %&gt;%\n  layout(\n    title = \"VAR(2) Forecast for US 10Y Yield\",\n    xaxis = list(\n      title = \"Year\",\n      type = \"date\",\n      tickformat = \"%Y\",\n      dtick = \"M12\"\n    ),\n    yaxis = list(title = \"Yield (%)\"),\n    hovermode = \"x unified\"\n  )\n\n\nfig1\n\n\n\n\n\n\nCode\nfig2\n\n\n\n\n\n\nCode\nfig3\n\n\n\n\n\n\nThe forecast suggests that yield curve rates are expected to decrease gradually over time, signaling a potential easing of monetary conditions. In contrast, the Seoul Residential Property Price Index is projected to increase, moving in the opposite direction. A decline in long-term yields often signals market expectations for lower policy rates in the future. Such expectations tend to stimulate the housing market, as lower interest rates reduce borrowing costs, making it cheaper to finance real estate purchases. Consequently, easier monetary conditions can lead to stronger demand and higher residential property prices.\n\n\n\n\n\n\nSARIMAX model: USD/KRW spot rate ~ us-korea spread rate 3years+ us-korea spread rate 10years+ S&P500+ dollar index\n\ndata cleaning\n\n\nCode\nspread_3y_monthly &lt;- us_kr_spreads_3y%&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n    dplyr::select(Date,US_KR_3Y)\n\n\nspread_10y_monthly &lt;- us_kr_spreads_10y%&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,US_KR_10Y)\n\n\nsp500_monthly &lt;-\n  sp500 %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%               \n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1)) %&gt;%  \n  dplyr::select(Date, Close) %&gt;%\n  rename(sp500_close = Close) %&gt;%\n  arrange(Date) %&gt;%\n  mutate(\n    return = sp500_close / lag(sp500_close) - 1,      \n    log_return = log(sp500_close) - log(lag(sp500_close))\n  )%&gt;%\n  dplyr::select(Date,sp500_close)\n\n\nusd_monthly&lt;-usd%&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,usd_index)\n\nkor_monthly &lt;- kr %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_tail(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = ceiling_date(year_month, \"month\") - days(1))%&gt;%\n  dplyr::select(Date,krw)\n\n\n\n\n\ndf3&lt;- spread_3y_monthly%&gt;%\n  left_join(spread_10y_monthly,by = \"Date\")%&gt;%\n  left_join(sp500_monthly, by = \"Date\")%&gt;%\n  left_join(usd_monthly,by = \"Date\")%&gt;%\n  left_join(kor_monthly)\n\nstart_year_df3  &lt;- year(min(df3$Date))\nstart_month_df3 &lt;- month(min(df3$Date))\n\nts_krw &lt;- ts(df3$krw, \n              star=decimal_date(as.Date(\"2000-12-01\",format = \"%Y-%m-%d\")),frequency = 12)  \n\nts_log_krw &lt;- ts(log(df3$krw), \n                  star=decimal_date(as.Date(\"2000-12-01\",format = \"%Y-%m-%d\")),frequency = 12)\n\n\n\n\nmanual search utility function\n\n\nCode\nSARIMA.c &lt;- function(p_range, d_range, q_range, P_range, D_range, Q_range, data) {\n  \n  # Set seasonal period\n  s &lt;- 12\n  \n  # Initialize results storage\n  results_list &lt;- list()\n  \n  # Iterate over parameter combinations\n  for (p in p_range) {\n    for (d in d_range) {\n      for (q in q_range) {\n        for (P in P_range) {\n          for (D in D_range) {\n            for (Q in Q_range) {\n              \n              # Apply parameter constraint to avoid overfitting\n              if (p + d + q + P + D + Q &lt;= 10) {\n                tryCatch({\n                  # Fit SARIMA model\n                  model &lt;- Arima(data, order = c(p, d, q), seasonal = c(P, D, Q))\n                  \n                  # Store results\n                  results_list[[length(results_list) + 1]] &lt;- c(p, d, q, P, D, Q, model$aic, model$bic, model$aicc)\n                }, error = function(e) {\n                  # Handle errors without breaking the loop\n                  cat(\"Model failed for (p=\", p, \", d=\", d, \", q=\", q, \", P=\", P, \", D=\", D, \", Q=\", Q, \")\\n\")\n                })\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  \n  # Convert results to a tidy data frame\n  results_df &lt;- as.data.frame(do.call(rbind, results_list))\n  colnames(results_df) &lt;- c(\"p\", \"d\", \"q\", \"P\", \"D\", \"Q\", \"AIC\", \"BIC\", \"AICc\")\n  \n  return(results_df)\n}\n\n\n\n\nCode\n# arima \nARIMA.c &lt;- function(p_range, d_range, q_range, data,\n                    include_drift = TRUE,\n                    quiet = TRUE) {\n\n  results &lt;- list()\n\n  for (p in p_range) {\n    for (d in d_range) {\n      for (q in q_range) {\n\n        fit &lt;- tryCatch(\n          {\n            forecast::Arima(\n              y = data,\n              order = c(p, d, q),\n              include.drift = include_drift\n            )\n          },\n          error = function(e) {\n            if (!quiet) message(sprintf(\"Model failed for p=%d d=%d q=%d: %s\", p, d, q, e$message))\n            NULL\n          }\n        )\n\n        if (!is.null(fit)) {\n          results[[length(results) + 1L]] &lt;- data.frame(\n            p = p, d = d, q = q,\n            AIC  = fit$aic,\n            BIC  = fit$bic,\n            AICc = fit$aicc,\n            stringsAsFactors = FALSE\n          )\n        }\n      }\n    }\n  }\n\n  if (length(results) == 0L) {\n    return(data.frame(\n      p = integer(), d = integer(), q = integer(),\n      AIC = double(), BIC = double(), AICc = double()\n    ))\n  }\n\n  out &lt;- do.call(rbind, results)\n  rownames(out) &lt;- NULL\n  out[order(out$AIC), ]\n}\n\n\n\n\nlog transformation\nIn EDA and univariate section, taking log for S&P500 index and USD index was better, so it will continue to use log transformation. however, here, FX rate needs to be checked\n\n\nCode\ndiff_krw &lt;- diff(ts_krw)\ndiff_log_krw &lt;- diff(ts_log_krw)\n\n\np1 &lt;- ggplot() +\n  geom_line(aes(x = time(diff_krw), y = diff_krw), color = \"blue\") +\n  labs(title = \"Differenced Log-Transformed KRW/USD spot exchange rate\",\n       x = \"Time\",\n       y = \"KRW to USD\") +\n  theme_minimal()\n\np2 &lt;- ggplot() +\n  geom_line(aes(x = time(diff_log_krw), y = diff_log_krw), color = \"red\") +\n  labs(title = \"Differenced Log-Transformed KRW/USD spot exchange rate\",\n       x = \"Time\",\n       y = \"KRW to USD\") +\n  theme_minimal()\n\n\n\n\np1 / p2\n\n\n\n\n\n\n\n\n\nfrom the plot, log transformation don’t give dramatical change, so for this model, original value for KRW/USD spot exchange rate will be used.\n\ntime series plotauto.arimamanual searchcross-validationmodel fittingforecast\n\n\n\n\nCode\np5 &lt;- plot_ly(df3, x = ~Date, y = ~US_KR_3Y, type = \"scatter\", mode = \"lines\",\n              name = \"kor-us 3y bond spread rate\") %&gt;%\nlayout(yaxis = list(title = \"kor-us 3y bond spread rate\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np6 &lt;- plot_ly(df3, x = ~Date, y = ~US_KR_10Y, type = \"scatter\", mode = \"lines\",\n              name = \"kor-us 10y bond spread rate\") %&gt;%\nlayout(yaxis = list(title = \"kor-us 10y bond spread rate\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np7 &lt;- plot_ly(df3, x = ~Date, y = ~log(sp500_close), type = \"scatter\", mode = \"lines\",\n              name = \"sp500 Index\") %&gt;%\n layout(yaxis = list(title = \"sp500 Index\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np8 &lt;- plot_ly(df3, x = ~Date, y = ~log(usd_index), type = \"scatter\", mode = \"lines\",\n              name = \"Usd Index\") %&gt;%\nlayout(yaxis = list(title = \"Usd Index\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np9 &lt;- plot_ly(df3, x = ~Date, y = ~krw, type = 'scatter', mode = 'lines',\n              name = \"KRW/USD spot rate\") %&gt;%\n  layout(yaxis = list(title = \"KRW/USD spot rate\", titlefont = list(size = 14), tickfont = list(size = 12)))\nsubplot(p5,p6,nrows = 2, shareX = TRUE, titleY = TRUE) %&gt;%\n  layout(xaxis = list(title = \"Date\"))\n\n\n\n\n\n\nCode\nsubplot(p7,p8,p9, nrows = 3, shareX = TRUE, titleY = TRUE) %&gt;%\n  layout(xaxis = list(title = \"Date\"))\n\n\n\n\n\n\n\n\n\n\nCode\ndf3$log_usd_index&lt;- log(df3$usd_index)\ndf3$log_sp500_close&lt;- log(df3$sp500_close)\ndf3$l1&lt;-log(df3$US_KR_3Y) \ndf3$l2&lt;-log(df3$US_KR_10Y)\ndf3.ts&lt;- ts(df3[,c( \"US_KR_3Y\",\"US_KR_10Y\",\"log_usd_index\",\"log_sp500_close\",\"krw\")],start = c(2000,12),frequency = 12)\ny1&lt;- df3.ts[,\"krw\"]\nxreg1 &lt;- df3.ts[, !(colnames(df3.ts) %in% \"krw\")]\nfit_auto1&lt;- auto.arima(y1,xreg = xreg1)\nsummary(fit_auto1)\n\n\nSeries: y1 \nRegression with ARIMA(0,0,5)(1,0,1)[12] errors \n\nCoefficients:\n         ma1     ma2     ma3     ma4     ma5    sar1    sma1   intercept\n      1.0185  0.9192  0.8077  0.5132  0.2915  0.0587  0.1304  -3430.4807\ns.e.  0.0866  0.1075  0.0744  0.0742  0.0843  0.3159  0.3023    354.6735\n      US_KR_3Y  US_KR_10Y  log_usd_index  log_sp500_close\n      -32.8100     2.1624       962.0504          28.3890\ns.e.   12.9267    13.0775        72.4748          23.0226\n\nsigma^2 = 1189:  log likelihood = -1477.74\nAIC=2981.48   AICc=2982.76   BIC=3029.59\n\nTraining set error measures:\n                    ME     RMSE      MAE         MPE     MAPE      MASE\nTraining set 0.2861407 33.77607 24.36759 -0.08942715 2.051096 0.3106065\n                   ACF1\nTraining set 0.09697159\n\n\nCode\ncheckresiduals(fit_auto1)\n\n\n\n\n\n\n\n\n\n\n    Ljung-Box test\n\ndata:  Residuals from Regression with ARIMA(0,0,5)(1,0,1)[12] errors\nQ* = 170.72, df = 17, p-value &lt; 2.2e-16\n\nModel df: 7.   Total lags used: 24\n\n\nThe auto.arima model exhibits noticeable autocorrelation, with a significant spike in the ACF before lag 12, suggesting the presence of remaining short-term dependence that the model has not fully captured. Additionally, the residual series displays visible fluctuations, including a pronounced period of volatility between 2008 and 2010, indicating potential structural changes or outliers during that time. These patterns imply that the model may be under-differenced or missing key components to adequately capture the temporal dynamics and seasonal structure of the data.\n\n\n\n\nCode\nm1&lt;- lm(krw~ US_KR_3Y+US_KR_10Y+log_sp500_close+log_usd_index,data = df3)\nsummary(m1)\n\n\n\nCall:\nlm(formula = krw ~ US_KR_3Y + US_KR_10Y + log_sp500_close + log_usd_index, \n    data = df3)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-143.28  -65.07  -13.86   45.71  448.57 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     -3085.90     245.24 -12.583  &lt; 2e-16 ***\nUS_KR_3Y          -64.56      10.48  -6.160 2.38e-09 ***\nUS_KR_10Y          32.00      13.99   2.288   0.0229 *  \nlog_sp500_close    92.78      14.00   6.626 1.65e-10 ***\nlog_usd_index     774.29      51.50  15.036  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 85.87 on 294 degrees of freedom\nMultiple R-squared:  0.533, Adjusted R-squared:  0.5266 \nF-statistic: 83.87 on 4 and 294 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nCode\nlibrary(patchwork)\nres.fit1&lt;- ts(residuals(m1),start = c(2000,12),frequency = 12)\n \nacf1&lt;- ggAcf(res.fit1) +\n  ggtitle(\"Autocorrelation Function (ACF) of Residuals\")\npacf1&lt;- ggPacf(res.fit1) +\n  ggtitle(\"Partial Autocorrelation Function (PACF) of Residuals\")\n\nacf1 / pacf1\n\n\n\n\n\n\n\n\n\nCode\ndiff1&lt;- diff(res.fit1)\nseasonal_diff1&lt;- diff(diff1,lag = 12)\n\ndiff_p1 &lt;- ggAcf(seasonal_diff1) +\n  ggtitle(\"ACF of Seasonally Differenced Residuals\") +\n  theme_minimal()\n\ndiff_p2 &lt;- ggPacf(seasonal_diff1) +\n  ggtitle(\"PACF of Seasonally Differenced Residuals\") +\n  theme_minimal()\n\ndiff_p1 /diff_p2\n\n\n\n\n\n\n\n\n\n\n\nCode\noutput1 &lt;- SARIMA.c(\n  p_range = 0:2, q_range = 0:2, \n  d_range = 0:1, D_range = 0:1, \n  P_range = 1, Q_range = 0:2, \n  data = res.fit1\n)\n\n\nminaic &lt;- output1[which.min(output1$AIC), ]\nminbic &lt;- output1[which.min(output1$BIC), ]\n\nprint(minaic)\n\n\n   p d q P D Q      AIC      BIC    AICc\n35 0 1 2 1 1 1 2840.916 2859.196 2841.13\n\n\nCode\nmodel_output_1 &lt;- capture.output(sarima(res.fit1, 0,1,2,1,1,1,12))\n\n\n\n\n\n\n\n\n\nCode\nmodel_output_2 &lt;- capture.output(sarima(res.fit1, 0,0,5,1,0,1,12))\n\n\n\n\n\n\n\n\n\n\n\nCode\nextract_model_diagnostics &lt;- function(model_output) {\n  start_line &lt;- grep(\"Coefficients\", model_output)  # Find where coefficients start\n  end_line &lt;- length(model_output)  # Capture till the last line\n  if (length(start_line) &gt; 0) {\n    cat(model_output[start_line:end_line], sep = \"\\n\")  # Print coefficient section\n  } else {\n    cat(\"No coefficient details found.\\n\")  # Handle cases where output format changes\n  }\n}\n\nextract_model_diagnostics(model_output_1)\n\n\nCoefficients: \n     Estimate     SE  t.value p.value\nma1   -0.0535 0.0595  -0.8997  0.3690\nma2   -0.1284 0.0626  -2.0522  0.0411\nsar1  -0.0710 0.0618  -1.1498  0.2512\nsma1  -1.0000 0.0596 -16.7682  0.0000\n\nsigma^2 estimated as 1012.115 on 282 degrees of freedom \n \nAIC = 9.933272  AICc = 9.93377  BIC = 9.997188 \n \n\n\nCode\nextract_model_diagnostics(model_output_2)\n\n\nCoefficients: \n      Estimate     SE t.value p.value\nma1     1.0187 0.0687 14.8269  0.0000\nma2     0.8521 0.0901  9.4559  0.0000\nma3     0.7539 0.0670 11.2585  0.0000\nma4     0.5018 0.0750  6.6902  0.0000\nma5     0.2326 0.0656  3.5479  0.0005\nsar1   -0.1625 0.5179 -0.3137  0.7540\nsma1    0.2462 0.5044  0.4882  0.6258\nxmean   1.1730 9.4233  0.1245  0.9010\n\nsigma^2 estimated as 1233.529 on 291 degrees of freedom \n \nAIC = 10.02133  AICc = 10.02299  BIC = 10.13272 \n \n\n\nThe ARIMA(0,1,2)(1,1,1)12 model produces residuals that behave much closer to white noise. The residual plot shows less obvious patterns or persistent fluctuations over time compared with the auto.arima model , indicating that both regular and seasonal differencing have successfully stabilized the series. The PACF of the residuals shows no significant spikes within the confidence bounds, suggesting that autocorrelation has been effectively removed. The Q–Q plot of standardized residuals aligns closely with the theoretical normal line, with only minor deviations at the tails. Furthermore, the Ljung–Box test p-values remain above the significance level across most lags, confirming the adequacy of the model fit. Overall, this model captures both the short-term and seasonal dynamics of the data well and provides a significant improvement over the auto.arima model.\n\n\n\n\n\n\nRMSE for 12-Step Forecasts\n\n\nHorizon1\nRMSE_Model1\nRMSE_Model2\n\n\n\n\n1\n75.2885\n74.8425\n\n\n2\n75.5743\n75.1145\n\n\n3\n75.3363\n75.2164\n\n\n4\n74.7199\n75.2525\n\n\n5\n74.5120\n75.1724\n\n\n6\n74.3232\n75.1111\n\n\n7\n74.2009\n75.0476\n\n\n8\n74.2162\n74.9261\n\n\n9\n74.2647\n74.7324\n\n\n10\n74.3287\n74.5284\n\n\n11\n74.4096\n74.3075\n\n\n12\n74.3660\n74.0836\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(rmse_table1, aes(x = Horizon1)) +\n  geom_line(aes(y = RMSE_Model1, color = \"SARIMA(0,1,2)(1,1,1)[12]\"), size = 1) +\n  geom_line(aes(y = RMSE_Model2, color = \"SARIMA(0,0,5)(1,0,1)[12]\"), size = 1) +\n  labs(title = \"RMSE Comparison for 12-Step Forecasts\",\n       x = \"Forecast Horizon (Months Ahead)\",\n       y = \"Root Mean Squared Error (RMSE)\") +\n  scale_color_manual(name = \"Models\", values = c(\"red\", \"blue\")) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nFrom the plots, the SARIMA(0,1,2)(1,1,1)[12] model demonstrates strong overall performance, capturing the main patterns and seasonal dynamics effectively across most of the time series. In contrast, the SARIMA(0,0,5)(1,0,1)[12] model performs slightly better in predicting values at the very beginning and end of the series, suggesting improved short-term and long-horizon accuracy. However, considering consistency and overall fit throughout the data, the SARIMA(0,1,2)(1,1,1)[12] model provides a more balanced and reliable performance. Therefore, this model is selected as the preferred choice.\n\n\n\n\nCode\nfinal_fit1&lt;- Arima(y1,order = c(0,1,2),seasonal = list(order = c(1,1,1),period = 12),xreg = xreg1)\nsummary(final_fit1)\n\n\nSeries: y1 \nRegression with ARIMA(0,1,2)(1,1,1)[12] errors \n\nCoefficients:\n          ma1      ma2     sar1     sma1  US_KR_3Y  US_KR_10Y  log_usd_index\n      -0.1410  -0.1266  -0.0513  -1.0000  -17.3951    -9.6550       883.1751\ns.e.   0.0605   0.0659   0.0626   0.1413   11.5517    11.7263        77.1053\n      log_sp500_close\n            -219.0293\ns.e.          39.0265\n\nsigma^2 = 748.9:  log likelihood = -1368.09\nAIC=2754.19   AICc=2754.84   BIC=2787.09\n\nTraining set error measures:\n                   ME     RMSE      MAE       MPE    MAPE      MASE\nTraining set 2.461805 26.38713 19.06936 0.1743897 1.62301 0.2430716\n                     ACF1\nTraining set -0.006297849\n\n\n$$ (1+0.0513,{12}),(1-)(1-{12}),y_t = -17.3951,_t -9.6550,_t +883.1751,()_t -219.0293,()_t +,(1-0.1410,,2),(1-1.0000,{12}),_t.\n\\[\n\\]\n\\[\\begin{aligned}\n(1 + 0.0513\\,B^{12})(1 - B)(1 - B^{12})\\,y_t\n\\\\[4pt]\n=\\;\n-\\,17.3951\\,\\text{US\\_KR\\_3Y}_t\n\\;-\\; 9.6550\\,\\text{US\\_KR\\_10Y}_t\n\\;+\\; 883.1751\\,\\log(\\text{usd\\_index})_t\n\\;-\\; 219.0293\\,\\log(\\text{sp500\\_close})_t\n\\\\[6pt]\n\\quad+\\;\n(1 - 0.1410\\,B - 0.1266\\,B^{2})(1 - 1.0000\\,B^{12})\\,\\varepsilon_t.\n\\end{aligned}\\]\n$$\n\\[\n\\begin{alignedat}{1}\n&(1 + 0.0513\\,B^{12})(1 - B)(1 - B^{12})\\,y_t \\\\[4pt]\n&=\\,-17.3951\\,\\text{US_KR_3Y}_t\n- 9.6550\\,\\text{US_KR_10Y}_t\n+ 883.1751\\,\\log(\\text{usd_index})_t\n- 219.0293\\,\\log(\\text{sp500_close})_t \\\\[6pt]\n&\\quad+\\,(1 - 0.1410\\,B - 0.1266\\,B^{2})(1 - 1.0000\\,B^{12})\\,\\varepsilon_t.\n\\end{alignedat}\n\\]\n\n\n\n\nCode\nfin_short_fit &lt;- auto.arima(xreg1[, \"US_KR_3Y\"])\nfshort &lt;- forecast(fin_short_fit, h = 32) \n\nfin_long_fit &lt;- auto.arima(xreg1[, \"US_KR_10Y\"])\nflong &lt;- forecast(fin_long_fit, h = 32)\n\nusd_fit &lt;- auto.arima(xreg1[, \"log_usd_index\"])\nfusd &lt;- forecast(usd_fit, h = 32)\n\nsp_fit &lt;- auto.arima(xreg1[, \"log_sp500_close\"])\nfsp &lt;- forecast(sp_fit, h = 32)\n\nfxreg1 &lt;- cbind(US_KR_3Y = fshort$mean,\n                US_KR_10Y = flong$mean,\n                log_usd_index = fusd$mean,\n                log_sp500_close = fsp$mean)\n\n\n\n\nCode\nlibrary(plotly)\n\nfcast1 &lt;- forecast(final_fit1, xreg = fxreg1, h = 32)\n\nfcast_df1 &lt;- data.frame(\n  Date = as.Date(time(fcast1$mean)),\n  Forecast = as.numeric(fcast1$mean),\n  Lower80 = as.numeric(fcast1$lower[,1]),\n  Upper80 = as.numeric(fcast1$upper[,1]),\n  Lower95 = as.numeric(fcast1$lower[,2]),\n  Upper95 = as.numeric(fcast1$upper[,2])\n)\n\norig_df &lt;- data.frame(\n  Date = as.Date(time(y1)),\n  Actual = as.numeric(y1)\n)\n\n\nplot_ly() |&gt;\n  add_lines(data = orig_df,\n            x = ~Date, y = ~Actual,\n            name = \"Actual\") |&gt;\n  add_lines(data = fcast_df1,\n            x = ~Date, y = ~Forecast,\n            name = \"Forecast\") |&gt;\n  add_ribbons(data = fcast_df1,\n              x = ~Date,\n              ymin = ~Lower95,\n              ymax = ~Upper95,\n              name = \"95% CI\",\n              opacity = 0.2,\n              showlegend = FALSE) |&gt;\n  add_ribbons(data = fcast_df1,\n              x = ~Date,\n              ymin = ~Lower80,\n              ymax = ~Upper80,\n              name = \"80% CI\",\n              opacity = 0.3,\n              showlegend = FALSE) |&gt;\n  layout(\n    title = \"Forecast of KRW/USD exchange spot rate for next 36 month\",\n    xaxis = list(title = \"Year\"),\n    yaxis = list(title = \"KRW to one USD\")\n  )\n\n\n\n\n\n\nThe forecast demonstrates a good fit, closely following the pattern of previous values. Over time, the KRW is projected to appreciate gradually, showing only minor changes and limited fluctuations.\n\n\n\n\n\n\nSARIMAX model : South korea exports(vs USA) ~ VIX + US manufacturing Index + KRW/USD spot rate\n\ndata cleaning\n\n\nCode\nusmi&lt;- read_csv(\"../data/usmi.csv\")\nusmi&lt;- usmi%&gt;% \n  rename(Date = observation_date, usm = INDPRO)%&gt;%\n  mutate(Date = ymd(Date)) %&gt;%\n  arrange(Date)\n\nvix_monthly_m2 &lt;- vix %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_head(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = floor_date(year_month, \"month\")) %&gt;%  \n  dplyr::select(Date, vix)\n\nkor_monthly_m2 &lt;- kr %&gt;%\n  mutate(year_month = floor_date(Date, \"month\")) %&gt;%\n  group_by(year_month) %&gt;%\n  slice_head(n = 1) %&gt;%\n  ungroup() %&gt;%\n  mutate(Date = floor_date(year_month, \"month\")) %&gt;%  \n  dplyr::select(Date, krw)\n\ntrade_exports&lt;- trade %&gt;%\n  dplyr::select(Date, export_USD)%&gt;%\n  rename(exports = export_USD)\n\ndf4&lt;- trade_exports%&gt;%\n  left_join(usmi,by = \"Date\")%&gt;%\n  left_join(vix_monthly_m2,by = \"Date\")%&gt;%\n  left_join(kor_monthly_m2, by = \"Date\")\n\nstart_year_df4  &lt;- year(min(df4$Date))\nstart_month_df4 &lt;- month(min(df4$Date))\n\n\n\ntime series plotauto.arimamanual searchcross-validationmodel fittingforecast\n\n\n\n\nCode\np9 &lt;- plot_ly(df4, x = ~Date, y = ~exports, type = \"scatter\", mode = \"lines\",\n              name = \"South korea exports(US)\") %&gt;%\nlayout(yaxis = list(title = \"South korea exports(US)\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np10 &lt;- plot_ly(df4, x = ~Date, y = ~usm, type = \"scatter\", mode = \"lines\",\n              name = \"US manufacturing Index\") %&gt;%\nlayout(yaxis = list(title = \"US manufacturing Index\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np11 &lt;- plot_ly(df4, x = ~Date, y = ~vix, type = \"scatter\", mode = \"lines\",\n              name = \"VIX index\") %&gt;%\nlayout(yaxis = list(title = \"VIX index\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np12 &lt;- plot_ly(df4, x = ~Date, y = ~krw, type = 'scatter', mode = 'lines',\n              name = \"KRW/USD spot rate\") %&gt;%\n  layout(yaxis = list(title = \"KRW/USD spot rate\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\n\nsubplot(p9,p12, nrows = 2, shareX = TRUE, titleY = TRUE) %&gt;%\n  layout(xaxis = list(title = \"Date\"))\n\n\n\n\n\n\nCode\nsubplot(p10,p11, nrows = 2, shareX = TRUE, titleY = TRUE) %&gt;%\n  layout(xaxis = list(title = \"Date\"))\n\n\n\n\n\n\n\n\n\n\nCode\ndf4.ts&lt;- ts(df4[,c( \"vix\",\"usm\",\"krw\",\"exports\")],start = c(1993,1),frequency = 12)\ny2&lt;- df4.ts[,\"exports\"]\nxreg2 &lt;- df4.ts[, !(colnames(df4.ts) %in% \"exports\")]\nfit_auto2&lt;- auto.arima(y2,xreg = xreg2)\nsummary(fit_auto2)\n\n\nSeries: y2 \nRegression with ARIMA(0,1,1)(0,0,2)[12] errors \n\nCoefficients:\n          ma1    sma1    sma2        vix       usm        krw\n      -0.6613  0.3278  0.1766  -272.6394  97227.64  -317.6629\ns.e.   0.0398  0.0544  0.0576  4246.8016  15051.92   341.1909\n\nsigma^2 = 1.859e+11:  log likelihood = -5625.82\nAIC=11265.63   AICc=11265.93   BIC=11293.41\n\nTraining set error measures:\n                   ME     RMSE      MAE        MPE     MAPE      MASE      ACF1\nTraining set 24238.72 427248.1 307163.3 -0.3682801 7.044885 0.5508381 0.0304862\n\n\nCode\ncheckresiduals(fit_auto2)\n\n\n\n\n\n\n\n\n\n\n    Ljung-Box test\n\ndata:  Residuals from Regression with ARIMA(0,1,1)(0,0,2)[12] errors\nQ* = 71.466, df = 21, p-value = 2.042e-07\n\nModel df: 3.   Total lags used: 24\n\n\nThe ARIMA(0,1,1)(0,0,2)[12] model from auto.arima() yields residuals that fluctuate randomly around zero, though variability increases in recent years, indicating the fit is not perfect. The residual ACF shows only mild autocorrelation, with most lags within the 95% bounds, but a faint seasonal signal remains near lag 12. The residual histogram is approximately normal, with slight skewness driven by a few large observations.\n\n\n\n\nCode\nm2&lt;- lm(exports~ usm+vix+krw, data = df4)\nsummary(m2)\n\n\n\nCall:\nlm(formula = exports ~ usm + vix + krw, data = df4)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3846667 -1306009  -267557  1170558  4378304 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -1.166e+07  7.807e+05 -14.939  &lt; 2e-16 ***\nusm          1.405e+05  9.939e+03  14.138  &lt; 2e-16 ***\nvix         -6.138e+04  1.243e+04  -4.937 1.18e-06 ***\nkrw          3.949e+03  6.564e+02   6.016 4.14e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1639000 on 388 degrees of freedom\nMultiple R-squared:  0.5771,    Adjusted R-squared:  0.5738 \nF-statistic: 176.5 on 3 and 388 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nCode\nlibrary(patchwork)\nres.fit2&lt;- ts(residuals(m2),start = c(1993,1),frequency = 12)\n \nacf2&lt;- ggAcf(res.fit2) +\n  ggtitle(\"Autocorrelation Function (ACF) of Residuals\")\npacf2&lt;- ggPacf(res.fit2) +\n  ggtitle(\"Partial Autocorrelation Function (PACF) of Residuals\")\n\nacf2 / pacf2\n\n\n\n\n\n\n\n\n\nCode\ndiff2&lt;- diff(res.fit2)\nseasonal_diff2&lt;- diff(diff2,lag = 12)\n\ndiff_p3 &lt;- ggAcf(seasonal_diff2) +\n  ggtitle(\"ACF of Seasonally Differenced Residuals\") +\n  theme_minimal()\n\ndiff_p4 &lt;- ggPacf(seasonal_diff2) +\n  ggtitle(\"PACF of Seasonally Differenced Residuals\") +\n  theme_minimal()\n\ndiff_p3 /diff_p4\n\n\n\n\n\n\n\n\n\n\n\nCode\noutput2 &lt;- SARIMA.c(\n  p_range = 0:3, q_range = 0:3, \n  d_range = 1, D_range = 1, \n  P_range = 0:1, Q_range = 0:1, \n  data = res.fit2\n)\n\n\nminaic &lt;- output2[which.min(output2$AIC), ]\nminbic &lt;- output2[which.min(output2$BIC), ]\n\nprint(minaic)\n\n\n   p d q P D Q      AIC   BIC     AICc\n64 3 1 3 1 1 1 11054.56 11090 11055.05\n\n\nCode\nprint(minbic)\n\n\n  p d q P D Q      AIC      BIC     AICc\n6 0 1 1 0 1 1 11067.37 11079.19 11067.44\n\n\nCode\nmodel_output_3 &lt;- capture.output(sarima(res.fit2, 3,1,3,1,1,1,12))\n\n\n\n\n\n\n\n\n\nCode\nmodel_output_4 &lt;- capture.output(sarima(res.fit2, 0,1,1,0,1,1,12))\n\n\n\n\n\n\n\n\n\nCode\nmodel_output_5 &lt;- capture.output(sarima(res.fit2, 0,1,1,0,0,2,12))\n\n\n\n\n\n\n\n\n\n\n\nCode\nextract_model_diagnostics &lt;- function(model_output) {\n  start_line &lt;- grep(\"Coefficients\", model_output)  # Find where coefficients start\n  end_line &lt;- length(model_output)  # Capture till the last line\n  if (length(start_line) &gt; 0) {\n    cat(model_output[start_line:end_line], sep = \"\\n\")  # Print coefficient section\n  } else {\n    cat(\"No coefficient details found.\\n\")  # Handle cases where output format changes\n  }\n}\n\nextract_model_diagnostics(model_output_3)\n\n\nCoefficients: \n     Estimate     SE  t.value p.value\nar1   -0.7264 0.1336  -5.4372  0.0000\nar2   -0.6606 0.1726  -3.8272  0.0002\nar3    0.2760 0.1270   2.1727  0.0304\nma1    0.2731 0.1184   2.3054  0.0217\nma2    0.3130 0.1246   2.5111  0.0125\nma3   -0.6248 0.0889  -7.0254  0.0000\nsar1  -0.1804 0.0676  -2.6684  0.0080\nsma1  -0.8364 0.0403 -20.7679  0.0000\n\nsigma^2 estimated as 246828438646 on 371 degrees of freedom \n \nAIC = 29.1677  AICc = 29.16873  BIC = 29.2612 \n \n\n\nCode\nextract_model_diagnostics(model_output_4)\n\n\nCoefficients: \n     Estimate     SE  t.value p.value\nma1   -0.4833 0.0500  -9.6756       0\nsma1  -0.8691 0.0277 -31.3438       0\n\nsigma^2 estimated as 2.64877e+11 on 377 degrees of freedom \n \nAIC = 29.20151  AICc = 29.2016  BIC = 29.23268 \n \n\n\nCode\nextract_model_diagnostics(model_output_5)\n\n\nCoefficients: \n          Estimate         SE t.value p.value\nma1        -0.5181     0.0536 -9.6671  0.0000\nsma1        0.1351     0.0525  2.5738  0.0104\nsma2        0.2083     0.0492  4.2301  0.0000\nconstant 1817.6271 18188.1618  0.0999  0.9204\n\nsigma^2 estimated as 314616300440 on 387 degrees of freedom \n \nAIC = 29.34198  AICc = 29.34225  BIC = 29.39273 \n \n\n\nAll three models display similar residual patterns, characterized by random fluctuations around zero with a few noticeable outlier spikes. The ACF plots of the residuals also show comparable behavior across models; however, the ARIMA(3,1,3)(1,1,1)[12] model performs slightly better, as its autocorrelations remain within the significance bounds across most lags. The normal Q–Q plots indicate that all models exhibit similar residual distributions, with deviations at the tails suggesting the presence of non-normality often observed in time series data. Although the Ljung–Box test results indicate that none of the models fully satisfy the white noise assumption—since most p-values fall below the significance threshold—the ARIMA(0,1,1)(0,1,1)[12] model appears to offer a marginally better fit compared to the others.\n\n\n\n\n\n\nRMSE for 12-Step Forecasts\n\n\nHorizon1\nRMSE_Model1\nRMSE_Model2\nRMSE_Model3\n\n\n\n\n1\n637017.7\n642596.4\n672063.4\n\n\n2\n633863.6\n640395.1\n667436.7\n\n\n3\n632142.4\n639283.7\n664722.5\n\n\n4\n631650.9\n639277.0\n663508.9\n\n\n5\n631066.2\n639602.8\n662778.5\n\n\n6\n630774.4\n639913.4\n662394.3\n\n\n7\n630954.7\n640642.6\n661496.3\n\n\n8\n631143.5\n641536.3\n661248.4\n\n\n9\n627005.3\n638510.5\n658305.9\n\n\n10\n625005.7\n637092.2\n656733.7\n\n\n11\n622939.7\n635708.0\n655528.9\n\n\n12\n621534.3\n634953.9\n654826.5\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(rmse_table1, aes(x = Horizon1)) +\n  geom_line(aes(y = RMSE_Model1, color = \"SARIMA(3,1,3)(1,1,1)[12]\"), size = 1) +\n  geom_line(aes(y = RMSE_Model2, color = \"SARIMA(0,1,1)(0,1,1)[12]\"), size = 1) +\n  geom_line(aes(y = RMSE_Model3, color = \"SARIMA(0,1,1)(0,0,2)[12]\"), size = 1) +\n  labs(title = \"RMSE Comparison for 12-Step Forecasts\",\n       x = \"Forecast Horizon (Months Ahead)\",\n       y = \"Root Mean Squared Error (RMSE)\") +\n  scale_color_manual(name = \"Models\", values = c(\"orange\",\"red\", \"blue\")) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nFrom the plot, SARIMA(3,1,3)(1,1,1)[12] performs better than other models, so SARIMA(3,1,3)(1,1,1)[12] model is best model.\n\n\n\n\nCode\nfinal_fit2&lt;- Arima(y2,order = c(3,1,3),seasonal = list(order = c(1,1,1),period = 12),xreg = xreg2)\nsummary(final_fit2)\n\n\nSeries: y2 \nRegression with ARIMA(3,1,3)(1,1,1)[12] errors \n\nCoefficients:\n         ar1      ar2      ar3     ma1     ma2      ma3     sar1     sma1\n      -1.216  -1.0579  -0.0649  0.6024  0.3140  -0.5152  -0.0829  -0.8007\ns.e.   0.102   0.1152   0.0985  0.0906  0.0949   0.0849   0.0662   0.0417\n            vix       usm        krw\n      -6911.305  97511.41  -220.2439\ns.e.   3920.370  14375.69   326.3332\n\nsigma^2 = 1.433e+11:  log likelihood = -5407.54\nAIC=10839.08   AICc=10839.93   BIC=10886.33\n\nTraining set error measures:\n                   ME     RMSE      MAE           MPE     MAPE      MASE\nTraining set 17649.08 366715.5 258171.3 -0.0009533994 5.717243 0.4629803\n                     ACF1\nTraining set -0.002233551\n\n\n\\[\n\\begin{aligned}\n\\bigl(1 + 1.216\\,B + 1.0579\\,B^{2} + 0.0649\\,B^{3}\\bigr)\n\\bigl(1 + 0.0829\\,B^{12}\\bigr) w_t\n\\\\[4pt]\n=\\;\n-\\,6911.305\\,\\mathrm{vix}_t\n\\;+\\; 97{,}511.41\\,\\mathrm{usm}_t\n\\;-\\; 220.2439\\,\\mathrm{krw}_t \\\\[6pt]\n\\quad+\\;\n\\bigl(1 + 0.6024\\,B + 0.3140\\,B^{2} - 0.5152\\,B^{3}\\bigr)\n\\bigl(1 - 0.8007\\,B^{12}\\bigr)\\varepsilon_t, \\\\[6pt]\n\\varepsilon_t &\\sim \\mathcal{N}(0, \\sigma^2).\n\\end{aligned}\n\\]\n\n\n\n\nCode\nusm_fit &lt;- auto.arima(xreg2[, \"usm\"])\nfusm &lt;- forecast(usm_fit, h = 48) \n\nvix_fit &lt;- auto.arima(xreg2[, \"vix\"])\nfvix &lt;- forecast(vix_fit, h = 48)\n\nkrw_fit &lt;- auto.arima(xreg2[, \"krw\"])\nfkrw &lt;- forecast(krw_fit, h = 48)\n\n\nfxreg2 &lt;- cbind(vix = fvix$mean,\n                usm = fusm$mean,\n                krw = fkrw$mean)\n\n\n\n\nCode\nlibrary(plotly)\n\nfcast2 &lt;- forecast(final_fit2, xreg = fxreg2, h = 48)\n\norig_df &lt;- data.frame(\n  Date   = as.Date(as.yearmon(time(y2))),\n  Actual = as.numeric(y2)\n)\n\nfcast_df2 &lt;- data.frame(\n  Date     = as.Date(as.yearmon(time(fcast2$mean))),\n  Forecast = as.numeric(fcast2$mean),\n  Lower80  = as.numeric(fcast2$lower[,1]),\n  Upper80  = as.numeric(fcast2$upper[,1]),\n  Lower95  = as.numeric(fcast2$lower[,2]),\n  Upper95  = as.numeric(fcast2$upper[,2])\n)\n\n\nplot_ly() |&gt;\n  add_lines(data = orig_df,\n            x = ~Date, y = ~Actual,\n            name = \"Actual\") |&gt;\n  add_lines(data = fcast_df2,\n            x = ~Date, y = ~Forecast,\n            name = \"Forecast\") |&gt;\n  add_ribbons(data = fcast_df2,\n              x = ~Date,\n              ymin = ~Lower95,\n              ymax = ~Upper95,\n              name = \"95% CI\",\n              opacity = 0.2,\n              showlegend = FALSE) |&gt;\n  add_ribbons(data = fcast_df2,\n              x = ~Date,\n              ymin = ~Lower80,\n              ymax = ~Upper80,\n              name = \"80% CI\",\n              opacity = 0.3,\n              showlegend = FALSE) |&gt;\n  layout(\n    title = \"Forecast of South korea export to US for next 48 month\",\n    xaxis = list(title = \"Year\"),\n    yaxis = list(title = \"thousand USD\")\n  )\n\n\n\n\n\n\nThe forecast demonstrates a strong fit, effectively capturing the pattern of historical values. Over the projection horizon, Korea’s exports in U.S. dollars are expected to exhibit an overall upward trend, although short-term monthly fluctuations are likely to continue.\n\n\n\n\n\n\nConclusion\nOverall, model fitting process was satisfied, with descent output for forecasting. However since all the models are not in “perfect”, it needs to be improved for better anaysis. Also in economic and finance sector, there are numerous factors that needs to be considered for analyzing economic situation and its prediction, so it have limitations. However, by conducting multivariate anaylsis, there were numerous meaningful findings. Generally, all the models didn’t produced “opposite” result compare to how usually economic variable acts to others. So, interpretation for forecasting was meaningful to explain.\n\n\n\n\n\n\n\n\nReference\n\n1. Kim, S. Do s&p 500 and KOSPI move together? A functional regression approach. KDI Economic Policy Review (2010).\n\n\n2. Lee, C. The time-varying effect of interest rates on housing prices. Land (2022).\n\n\n3. Min, C.-H. Time-varying analysis of housing prices in korea and the u.s. International Journal of Labor Economics (2024).\n\n\n4. Yoon, D. R. What determines the exchange rate of the korean won? (2019).\n\n\n5. Masujima, M. The shifting drivers of exchange rates. (2018).\n\n\n6. Son, M. et al. Dominant currency pricing: Evidence from korean exports. (2023)."
  },
  {
    "objectID": "ts/multi.html#equity-sp500-vix-us_yield_spreadkospi-index",
    "href": "ts/multi.html#equity-sp500-vix-us_yield_spreadkospi-index",
    "title": "Multivariate TS Models(ARIMAX/SARIMAX/VAR)",
    "section": "equity: s&p500, vix, us_yield_spread,KOSPI index",
    "text": "equity: s&p500, vix, us_yield_spread,KOSPI index\n\ntime series plotparameter selectionmodel summaryCVforecast\n\n\n\n\nCode\nlibrary(dplyr)\ndf1 &lt;- us_spreads %&gt;%\n   left_join(sp500, by = \"Date\") %&gt;%\n   left_join(kospi, by = \"Date\")%&gt;%\n   dplyr::select(Date, us_spread, close_sp500 = Close.x , close_kospi = Close.y)%&gt;%\n   arrange(Date) %&gt;%\n   fill(close_sp500,close_kospi, .direction = \"down\")\n \ndf1$log_kospi&lt;- log(df1$close_kospi)\ndf1$log_sp500&lt;- log(df1$close_sp500)\n\n\n start_year_df1  &lt;- year(min(df1$Date))\n start_month_df1 &lt;- month(min(df1$Date))\n\n\np1 &lt;- plot_ly(df1, x = ~Date, y = ~us_spread, type = 'scatter', mode = 'lines',\n              name = \"U.S Spread Rate\") %&gt;%\n  layout(yaxis = list(title = \"U.S Spread Rate\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np2 &lt;- plot_ly(df1, x = ~Date, y = ~log_sp500, type = 'scatter', mode = 'lines',\n              name = \"S&P500 Index(log)\") %&gt;%\n  layout(yaxis = list(title = \"S&P500 Index(log)\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\np3 &lt;- plot_ly(df1, x = ~Date, y = ~log_kospi, type = 'scatter', mode = 'lines',\n              name = \"KOSPI Index(log)\") %&gt;%\n  layout(yaxis = list(title = \"KOSPI Index(log)\", titlefont = list(size = 14), tickfont = list(size = 12)))\n\nsubplot(p1, p2, p3, nrows = 3, shareX = TRUE, titleX = TRUE) %&gt;%\n  layout(title = list(text = \"Equities:KOSPI index, S&P 500 index, U.S T-bond spread rate\", font = list(size = 18)),\n         margin = list(l = 70, r = 40, t = 60, b = 40))\n\n\n\n\n\n\n\n\n\n\nCode\nnew_df1&lt;- df1[,c(2,5,6)]\ndf1.ts&lt;-ts(new_df1,star=decimal_date(as.Date(\"2001-12-01\",format = \"%Y-%m-%d\")),frequency = 252)\nVARselect(df1.ts, lag.max=10, type=\"both\")\n\n\n$selection\nAIC(n)  HQ(n)  SC(n) FPE(n) \n    10      5      2     10 \n\n$criteria\n                   1             2             3             4             5\nAIC(n) -2.419658e+01 -2.436948e+01 -2.437841e+01 -2.438541e+01 -2.438900e+01\nHQ(n)  -2.419068e+01 -2.436005e+01 -2.436544e+01 -2.436890e+01 -2.436895e+01\nSC(n)  -2.417962e+01 -2.434234e+01 -2.434109e+01 -2.433791e+01 -2.433132e+01\nFPE(n)  3.101405e-11  2.608965e-11  2.585770e-11  2.567740e-11  2.558543e-11\n                   6             7             8             9            10\nAIC(n) -2.439247e+01 -2.439309e+01 -2.439656e+01 -2.440048e+01 -2.440168e+01\nHQ(n)  -2.436889e+01 -2.436597e+01 -2.436590e+01 -2.436628e+01 -2.436394e+01\nSC(n)  -2.432461e+01 -2.431505e+01 -2.430834e+01 -2.430208e+01 -2.429310e+01\nFPE(n)  2.549667e-11  2.548083e-11  2.539261e-11  2.529342e-11  2.526311e-11\n\n\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df1, p=2, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: us_spread, log_kospi, log_sp500 \nDeterministic variables: both \nSample size: 5918 \nLog Likelihood: 46927.097 \nRoots of the characteristic polynomial:\n0.9987 0.9979 0.9954 0.2162 0.0273 0.0273\nCall:\nVAR(y = new_df1, p = 2, type = \"both\")\n\n\nEstimation results for equation us_spread: \n========================================== \nus_spread = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  1.005e+00  1.302e-02  77.209   &lt;2e-16 ***\nlog_kospi.l1  4.318e-02  3.263e-02   1.324    0.186    \nlog_sp500.l1  5.690e-02  3.593e-02   1.583    0.113    \nus_spread.l2 -7.440e-03  1.302e-02  -0.572    0.568    \nlog_kospi.l2 -4.234e-02  3.264e-02  -1.297    0.195    \nlog_sp500.l2 -5.388e-02  3.591e-02  -1.501    0.134    \nconst        -2.991e-02  2.686e-02  -1.114    0.265    \ntrend        -4.247e-07  1.078e-06  -0.394    0.694    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.03353 on 5910 degrees of freedom\nMultiple R-Squared: 0.9981, Adjusted R-squared: 0.9981 \nF-statistic: 4.428e+05 on 7 and 5910 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_kospi: \n========================================== \nlog_kospi = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  4.210e-03  4.990e-03   0.844   0.3989    \nlog_kospi.l1  9.266e-01  1.250e-02  74.106  &lt; 2e-16 ***\nlog_sp500.l1  3.906e-01  1.377e-02  28.365  &lt; 2e-16 ***\nus_spread.l2 -4.170e-03  4.989e-03  -0.836   0.4032    \nlog_kospi.l2  7.104e-02  1.251e-02   5.679 1.42e-08 ***\nlog_sp500.l2 -3.907e-01  1.376e-02 -28.390  &lt; 2e-16 ***\nconst         1.698e-02  1.029e-02   1.650   0.0991 .  \ntrend         4.458e-07  4.131e-07   1.079   0.2805    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01285 on 5910 degrees of freedom\nMultiple R-Squared: 0.9992, Adjusted R-squared: 0.9992 \nF-statistic: 1.081e+06 on 7 and 5910 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_sp500: \n========================================== \nlog_sp500 = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1 -7.316e-03  4.799e-03  -1.524 0.127492    \nlog_kospi.l1  3.228e-02  1.203e-02   2.684 0.007286 ** \nlog_sp500.l1  8.753e-01  1.324e-02  66.083  &lt; 2e-16 ***\nus_spread.l2  7.526e-03  4.798e-03   1.569 0.116796    \nlog_kospi.l2 -3.438e-02  1.203e-02  -2.858 0.004284 ** \nlog_sp500.l2  1.215e-01  1.324e-02   9.183  &lt; 2e-16 ***\nconst         3.540e-02  9.900e-03   3.576 0.000352 ***\ntrend         1.609e-06  3.973e-07   4.049  5.2e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01236 on 5910 degrees of freedom\nMultiple R-Squared: 0.9995, Adjusted R-squared: 0.9995 \nF-statistic: 1.748e+06 on 7 and 5910 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n           us_spread log_kospi  log_sp500\nus_spread  1.124e-03 1.530e-06 -1.898e-05\nlog_kospi  1.530e-06 1.651e-04  4.392e-05\nlog_sp500 -1.898e-05 4.392e-05  1.527e-04\n\nCorrelation matrix of residuals:\n          us_spread log_kospi log_sp500\nus_spread  1.000000  0.003551  -0.04582\nlog_kospi  0.003551  1.000000   0.27658\nlog_sp500 -0.045820  0.276579   1.00000\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df1, p=5, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: us_spread, log_kospi, log_sp500 \nDeterministic variables: both \nSample size: 5915 \nLog Likelihood: 46994.576 \nRoots of the characteristic polynomial:\n0.9989 0.9983 0.9951 0.5204 0.5204 0.5144 0.5144 0.4234 0.4111 0.4111 0.3816 0.3816 0.373 0.373 0.2981\nCall:\nVAR(y = new_df1, p = 5, type = \"both\")\n\n\nEstimation results for equation us_spread: \n========================================== \nus_spread = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  1.002e+00  1.301e-02  77.017  &lt; 2e-16 ***\nlog_kospi.l1  1.256e-02  3.563e-02   0.352 0.724478    \nlog_sp500.l1  6.579e-02  3.675e-02   1.790 0.073477 .  \nus_spread.l2  8.197e-04  1.843e-02   0.044 0.964530    \nlog_kospi.l2 -3.401e-02  4.707e-02  -0.723 0.469980    \nlog_sp500.l2 -9.580e-03  4.836e-02  -0.198 0.842991    \nus_spread.l3 -2.020e-02  1.843e-02  -1.096 0.273182    \nlog_kospi.l3  2.201e-02  4.719e-02   0.466 0.640900    \nlog_sp500.l3  6.182e-02  4.972e-02   1.243 0.213783    \nus_spread.l4 -1.204e-02  1.843e-02  -0.653 0.513772    \nlog_kospi.l4  2.331e-02  4.615e-02   0.505 0.613522    \nlog_sp500.l4  2.283e-02  4.924e-02   0.464 0.642863    \nus_spread.l5  2.717e-02  1.300e-02   2.089 0.036755 *  \nlog_kospi.l5 -2.352e-02  3.276e-02  -0.718 0.472758    \nlog_sp500.l5 -1.388e-01  3.949e-02  -3.515 0.000443 ***\nconst        -1.963e-02  2.694e-02  -0.729 0.466262    \ntrend        -1.036e-07  1.081e-06  -0.096 0.923694    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.03347 on 5898 degrees of freedom\nMultiple R-Squared: 0.9981, Adjusted R-squared: 0.9981 \nF-statistic: 1.942e+05 on 16 and 5898 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_kospi: \n========================================== \nlog_kospi = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  3.449e-03  4.950e-03   0.697   0.4860    \nlog_kospi.l1  8.749e-01  1.355e-02  64.561  &lt; 2e-16 ***\nlog_sp500.l1  4.162e-01  1.398e-02  29.779  &lt; 2e-16 ***\nus_spread.l2 -9.057e-03  7.010e-03  -1.292   0.1964    \nlog_kospi.l2  7.212e-02  1.790e-02   4.028 5.69e-05 ***\nlog_sp500.l2 -2.779e-01  1.839e-02 -15.106  &lt; 2e-16 ***\nus_spread.l3  2.893e-03  7.010e-03   0.413   0.6798    \nlog_kospi.l3  2.295e-02  1.795e-02   1.279   0.2010    \nlog_sp500.l3 -2.757e-02  1.891e-02  -1.458   0.1449    \nus_spread.l4  2.902e-03  7.011e-03   0.414   0.6790    \nlog_kospi.l4  1.520e-02  1.755e-02   0.866   0.3866    \nlog_sp500.l4 -8.148e-02  1.873e-02  -4.351 1.38e-05 ***\nus_spread.l5  2.195e-05  4.946e-03   0.004   0.9965    \nlog_kospi.l5  1.240e-02  1.246e-02   0.995   0.3197    \nlog_sp500.l5 -2.974e-02  1.502e-02  -1.980   0.0477 *  \nconst         2.053e-02  1.024e-02   2.004   0.0451 *  \ntrend         4.817e-07  4.112e-07   1.172   0.2414    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01273 on 5898 degrees of freedom\nMultiple R-Squared: 0.9992, Adjusted R-squared: 0.9992 \nF-statistic: 4.801e+05 on 16 and 5898 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_sp500: \n========================================== \nlog_sp500 = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + const + trend \n\n               Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1 -6.714e-03  4.799e-03  -1.399 0.161845    \nlog_kospi.l1  3.661e-02  1.314e-02   2.787 0.005344 ** \nlog_sp500.l1  8.733e-01  1.355e-02  64.448  &lt; 2e-16 ***\nus_spread.l2  3.149e-03  6.797e-03   0.463 0.643122    \nlog_kospi.l2 -4.948e-02  1.736e-02  -2.851 0.004378 ** \nlog_sp500.l2  1.165e-01  1.783e-02   6.533 7.00e-11 ***\nus_spread.l3  3.961e-03  6.796e-03   0.583 0.560010    \nlog_kospi.l3  1.150e-02  1.740e-02   0.661 0.508860    \nlog_sp500.l3  2.171e-02  1.833e-02   1.184 0.236461    \nus_spread.l4  1.208e-02  6.797e-03   1.777 0.075545 .  \nlog_kospi.l4  1.366e-02  1.702e-02   0.803 0.422232    \nlog_sp500.l4 -4.602e-02  1.816e-02  -2.535 0.011276 *  \nus_spread.l5 -1.230e-02  4.795e-03  -2.564 0.010364 *  \nlog_kospi.l5 -1.436e-02  1.208e-02  -1.189 0.234606    \nlog_sp500.l5  3.140e-02  1.456e-02   2.156 0.031122 *  \nconst         3.451e-02  9.932e-03   3.474 0.000516 ***\ntrend         1.580e-06  3.986e-07   3.963 7.49e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01234 on 5898 degrees of freedom\nMultiple R-Squared: 0.9995, Adjusted R-squared: 0.9995 \nF-statistic: 7.667e+05 on 16 and 5898 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n           us_spread  log_kospi  log_sp500\nus_spread  1.120e-03 -4.196e-07 -1.812e-05\nlog_kospi -4.196e-07  1.620e-04  4.394e-05\nlog_sp500 -1.812e-05  4.394e-05  1.523e-04\n\nCorrelation matrix of residuals:\n           us_spread  log_kospi log_sp500\nus_spread  1.0000000 -0.0009848  -0.04386\nlog_kospi -0.0009848  1.0000000   0.27970\nlog_sp500 -0.0438603  0.2797035   1.00000\n\n\n\n\nCode\nsummary(fit &lt;- VAR(new_df1, p=10, type=\"both\"))\n\n\n\nVAR Estimation Results:\n========================= \nEndogenous variables: us_spread, log_kospi, log_sp500 \nDeterministic variables: both \nSample size: 5910 \nLog Likelihood: 47045.173 \nRoots of the characteristic polynomial:\n0.999 0.9984 0.9951 0.7704 0.7704 0.7486 0.7486 0.7463 0.7463 0.7041 0.7041 0.6959 0.6895 0.6895 0.6807 0.6807 0.6722 0.6554 0.6554 0.6546 0.6546 0.6301 0.6301 0.601 0.601 0.5982 0.5982 0.4709 0.4588 0.3093\nCall:\nVAR(y = new_df1, p = 10, type = \"both\")\n\n\nEstimation results for equation us_spread: \n========================================== \nus_spread = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + us_spread.l6 + log_kospi.l6 + log_sp500.l6 + us_spread.l7 + log_kospi.l7 + log_sp500.l7 + us_spread.l8 + log_kospi.l8 + log_sp500.l8 + us_spread.l9 + log_kospi.l9 + log_sp500.l9 + us_spread.l10 + log_kospi.l10 + log_sp500.l10 + const + trend \n\n                Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1   1.002e+00  1.305e-02  76.749  &lt; 2e-16 ***\nlog_kospi.l1   3.737e-03  3.569e-02   0.105 0.916600    \nlog_sp500.l1   6.888e-02  3.692e-02   1.866 0.062132 .  \nus_spread.l2   1.230e-03  1.846e-02   0.067 0.946885    \nlog_kospi.l2  -3.245e-02  4.708e-02  -0.689 0.490682    \nlog_sp500.l2   6.665e-05  4.857e-02   0.001 0.998905    \nus_spread.l3  -1.983e-02  1.843e-02  -1.076 0.282071    \nlog_kospi.l3   2.075e-02  4.720e-02   0.440 0.660182    \nlog_sp500.l3   5.134e-02  4.989e-02   1.029 0.303429    \nus_spread.l4  -1.334e-02  1.841e-02  -0.725 0.468652    \nlog_kospi.l4  -7.511e-04  4.720e-02  -0.016 0.987305    \nlog_sp500.l4   4.288e-02  4.984e-02   0.860 0.389668    \nus_spread.l5   9.839e-04  1.841e-02   0.053 0.957376    \nlog_kospi.l5  -6.118e-02  4.718e-02  -1.297 0.194734    \nlog_sp500.l5  -6.796e-02  4.989e-02  -1.362 0.173150    \nus_spread.l6   1.159e-02  1.840e-02   0.629 0.529055    \nlog_kospi.l6   1.586e-01  4.722e-02   3.359 0.000786 ***\nlog_sp500.l6  -6.364e-02  4.981e-02  -1.278 0.201468    \nus_spread.l7   2.156e-02  1.841e-02   1.171 0.241726    \nlog_kospi.l7  -1.830e-02  4.724e-02  -0.387 0.698491    \nlog_sp500.l7  -1.358e-01  4.980e-02  -2.727 0.006407 ** \nus_spread.l8   3.135e-03  1.842e-02   0.170 0.864816    \nlog_kospi.l8  -5.057e-02  4.724e-02  -1.071 0.284413    \nlog_sp500.l8   1.883e-01  4.983e-02   3.778 0.000159 ***\nus_spread.l9  -1.267e-02  1.844e-02  -0.687 0.492146    \nlog_kospi.l9  -7.425e-02  4.621e-02  -1.607 0.108167    \nlog_sp500.l9  -9.591e-02  4.943e-02  -1.940 0.052404 .  \nus_spread.l10  4.044e-03  1.302e-02   0.311 0.756052    \nlog_kospi.l10  5.440e-02  3.283e-02   1.657 0.097623 .  \nlog_sp500.l10  1.349e-02  3.967e-02   0.340 0.733836    \nconst         -1.445e-02  2.705e-02  -0.534 0.593179    \ntrend          3.707e-08  1.086e-06   0.034 0.972763    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.03338 on 5878 degrees of freedom\nMultiple R-Squared: 0.9981, Adjusted R-squared: 0.9981 \nF-statistic: 1.007e+05 on 31 and 5878 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_kospi: \n========================================== \nlog_kospi = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + us_spread.l6 + log_kospi.l6 + log_sp500.l6 + us_spread.l7 + log_kospi.l7 + log_sp500.l7 + us_spread.l8 + log_kospi.l8 + log_sp500.l8 + us_spread.l9 + log_kospi.l9 + log_sp500.l9 + us_spread.l10 + log_kospi.l10 + log_sp500.l10 + const + trend \n\n                Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1   3.823e-03  4.961e-03   0.770  0.44105    \nlog_kospi.l1   8.713e-01  1.357e-02  64.213  &lt; 2e-16 ***\nlog_sp500.l1   4.219e-01  1.404e-02  30.057  &lt; 2e-16 ***\nus_spread.l2  -1.007e-02  7.018e-03  -1.435  0.15138    \nlog_kospi.l2   7.196e-02  1.790e-02   4.021 5.88e-05 ***\nlog_sp500.l2  -2.801e-01  1.847e-02 -15.166  &lt; 2e-16 ***\nus_spread.l3   2.181e-03  7.007e-03   0.311  0.75564    \nlog_kospi.l3   2.189e-02  1.794e-02   1.220  0.22256    \nlog_sp500.l3  -2.711e-02  1.897e-02  -1.429  0.15294    \nus_spread.l4   3.345e-03  7.000e-03   0.478  0.63279    \nlog_kospi.l4   6.615e-03  1.795e-02   0.369  0.71247    \nlog_sp500.l4  -7.452e-02  1.895e-02  -3.932 8.53e-05 ***\nus_spread.l5  -8.468e-03  6.999e-03  -1.210  0.22639    \nlog_kospi.l5  -1.493e-02  1.794e-02  -0.832  0.40531    \nlog_sp500.l5  -1.364e-02  1.897e-02  -0.719  0.47203    \nus_spread.l6   1.404e-02  6.997e-03   2.007  0.04483 *  \nlog_kospi.l6   4.627e-02  1.795e-02   2.577  0.00998 ** \nlog_sp500.l6  -1.438e-02  1.894e-02  -0.759  0.44783    \nus_spread.l7  -2.637e-03  7.000e-03  -0.377  0.70636    \nlog_kospi.l7  -1.601e-02  1.796e-02  -0.892  0.37269    \nlog_sp500.l7   3.496e-02  1.893e-02   1.846  0.06490 .  \nus_spread.l8   6.284e-03  7.002e-03   0.898  0.36947    \nlog_kospi.l8  -1.374e-02  1.796e-02  -0.765  0.44418    \nlog_sp500.l8   1.423e-02  1.895e-02   0.751  0.45251    \nus_spread.l9  -1.457e-02  7.010e-03  -2.078  0.03772 *  \nlog_kospi.l9   4.660e-02  1.757e-02   2.652  0.00802 ** \nlog_sp500.l9  -3.879e-02  1.880e-02  -2.064  0.03907 *  \nus_spread.l10  6.351e-03  4.949e-03   1.283  0.19941    \nlog_kospi.l10 -2.255e-02  1.248e-02  -1.806  0.07090 .  \nlog_sp500.l10 -2.325e-02  1.508e-02  -1.541  0.12326    \nconst          2.347e-02  1.029e-02   2.282  0.02253 *  \ntrend          5.469e-07  4.128e-07   1.325  0.18527    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01269 on 5878 degrees of freedom\nMultiple R-Squared: 0.9992, Adjusted R-squared: 0.9992 \nF-statistic: 2.479e+05 on 31 and 5878 DF,  p-value: &lt; 2.2e-16 \n\n\nEstimation results for equation log_sp500: \n========================================== \nlog_sp500 = us_spread.l1 + log_kospi.l1 + log_sp500.l1 + us_spread.l2 + log_kospi.l2 + log_sp500.l2 + us_spread.l3 + log_kospi.l3 + log_sp500.l3 + us_spread.l4 + log_kospi.l4 + log_sp500.l4 + us_spread.l5 + log_kospi.l5 + log_sp500.l5 + us_spread.l6 + log_kospi.l6 + log_sp500.l6 + us_spread.l7 + log_kospi.l7 + log_sp500.l7 + us_spread.l8 + log_kospi.l8 + log_sp500.l8 + us_spread.l9 + log_kospi.l9 + log_sp500.l9 + us_spread.l10 + log_kospi.l10 + log_sp500.l10 + const + trend \n\n                Estimate Std. Error t value Pr(&gt;|t|)    \nus_spread.l1  -5.799e-03  4.795e-03  -1.209 0.226579    \nlog_kospi.l1   3.762e-02  1.311e-02   2.868 0.004143 ** \nlog_sp500.l1   8.775e-01  1.357e-02  64.678  &lt; 2e-16 ***\nus_spread.l2   3.384e-03  6.783e-03   0.499 0.617871    \nlog_kospi.l2  -5.056e-02  1.730e-02  -2.922 0.003486 ** \nlog_sp500.l2   1.102e-01  1.785e-02   6.173 7.13e-10 ***\nus_spread.l3   1.698e-03  6.773e-03   0.251 0.802102    \nlog_kospi.l3   1.404e-02  1.734e-02   0.809 0.418430    \nlog_sp500.l3   2.354e-02  1.833e-02   1.284 0.199261    \nus_spread.l4   1.370e-02  6.766e-03   2.025 0.042940 *  \nlog_kospi.l4   1.411e-02  1.735e-02   0.814 0.415946    \nlog_sp500.l4  -4.545e-02  1.832e-02  -2.481 0.013127 *  \nus_spread.l5  -7.747e-03  6.765e-03  -1.145 0.252170    \nlog_kospi.l5  -5.645e-02  1.734e-02  -3.256 0.001136 ** \nlog_sp500.l5   1.783e-02  1.833e-02   0.973 0.330697    \nus_spread.l6  -9.871e-04  6.763e-03  -0.146 0.883962    \nlog_kospi.l6   3.333e-02  1.735e-02   1.921 0.054797 .  \nlog_sp500.l6  -1.365e-02  1.831e-02  -0.746 0.455959    \nus_spread.l7  -1.439e-02  6.766e-03  -2.127 0.033500 *  \nlog_kospi.l7  -1.557e-02  1.736e-02  -0.897 0.369785    \nlog_sp500.l7   8.217e-02  1.830e-02   4.490 7.26e-06 ***\nus_spread.l8   2.489e-02  6.768e-03   3.678 0.000237 ***\nlog_kospi.l8  -2.296e-02  1.736e-02  -1.323 0.186001    \nlog_sp500.l8  -4.501e-02  1.831e-02  -2.458 0.014006 *  \nus_spread.l9  -1.923e-02  6.775e-03  -2.838 0.004551 ** \nlog_kospi.l9   8.825e-02  1.698e-02   5.197 2.09e-07 ***\nlog_sp500.l9   4.684e-03  1.817e-02   0.258 0.796531    \nus_spread.l10  4.649e-03  4.783e-03   0.972 0.331154    \nlog_kospi.l10 -4.380e-02  1.207e-02  -3.630 0.000286 ***\nlog_sp500.l10 -1.467e-02  1.458e-02  -1.006 0.314295    \nconst          3.262e-02  9.941e-03   3.281 0.001040 ** \ntrend          1.486e-06  3.990e-07   3.724 0.000198 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.01227 on 5878 degrees of freedom\nMultiple R-Squared: 0.9995, Adjusted R-squared: 0.9995 \nF-statistic: 4.005e+05 on 31 and 5878 DF,  p-value: &lt; 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n           us_spread  log_kospi  log_sp500\nus_spread  1.114e-03 -1.219e-06 -1.667e-05\nlog_kospi -1.219e-06  1.611e-04  4.338e-05\nlog_sp500 -1.667e-05  4.338e-05  1.505e-04\n\nCorrelation matrix of residuals:\n          us_spread log_kospi log_sp500\nus_spread  1.000000 -0.002877  -0.04071\nlog_kospi -0.002877  1.000000   0.27864\nlog_sp500 -0.040713  0.278642   1.00000\n\n\n\n\n\n\nCode\nn=length(df1$log_sp500) \nk=1480 #1480\n#n-k=4440; 4440/252=17.619\nrmse1 &lt;- matrix(NA, 4440,3) #here 4440 is n-k\nrmse2 &lt;- matrix(NA, 4440,3)\nrmse3 &lt;- matrix(NA,4440,3) #here n-k / 252 = 4440/252 =17.619\nyear&lt;-c()\nts_obj &lt;- ts(df1[, c(2,5,6)], start=decimal_date(as.Date(\"2000-12-18\",format = \"%Y-%m-%d\")),frequency = 252)\nst &lt;- tsp(ts_obj)[1]+(k-1)/252 \nfor(i in 1:17) #here 17 is (n-k ) / 252 = 4440/252 =17.619\n{\n  \n  xtrain &lt;- window(ts_obj, end=st + i-1)\n  xtest &lt;- window(ts_obj, start=st + (i-1) + 1/252, end=st + i)\n  \n  # first model p = 2 \n  fit &lt;- vars::VAR(xtrain, p=2, type='both')\n  fcast &lt;- predict(fit, n.ahead = 252)\n  \n  fspread&lt;-fcast$fcst$us_spread\n  fkospi&lt;-fcast$fcst$log_kospi\n  fsp&lt;-fcast$fcst$log_sp500\n  \n  ff1&lt;-data.frame(fspread[,1],fkospi[,1],fsp[,1]) \n  year&lt;-st + (i-1) + 1/252 \n  \n  \n  ff1&lt;-ts(ff1,start=c(year,1),frequency = 252)\n  \n  a = 252*i-251 \n  b= 252*i \n \n  rmse1[c(a:b),]  &lt;-sqrt((ff1-xtest)^2)\n  \n  #second model p = 5\n  fit2 &lt;- vars::VAR(xtrain, p=5, type='both')\n  fcast2 &lt;- predict(fit2, n.ahead = 252)\n  \n  fspread2&lt;-fcast2$fcst$us_spread\n  fkospi2&lt;-fcast2$fcst$log_kospi\n  fsp2&lt;-fcast2$fcst$log_sp500\n  ff2&lt;-data.frame(fspread2[,1],fkospi2[,1],fsp2[,1])\n  \n  year&lt;-st + (i-1) + 1/252\n  \n  ff2&lt;-ts(ff2,start=c(year,1),frequency = 252)\n  \n  a = 252*i-251\n  b= 252*i\n  rmse2[c(a:b),]  &lt;-sqrt((ff2-xtest)^2)\n  \n  #third model p = 10\n  fit3 &lt;- vars::VAR(xtrain, p=10, type='both')\n  fcast3 &lt;- predict(fit3, n.ahead = 252)\n  \n  fspread3&lt;-fcast3$fcst$us_spread\n  fkospi3&lt;-fcast3$fcst$log_kospi\n  fsp3&lt;-fcast3$fcst$log_sp500\n  ff3&lt;-data.frame(fspread3[,1],fkospi3[,1],fsp3[,1])\n  \n  year&lt;-st + (i-1) + 1/252\n  \n  ff3&lt;-ts(ff3,start=c(year,1),frequency = 252)\n  \n  a = 252*i-251\n  b= 252*i\n  rmse3[c(a:b),]  &lt;-sqrt((ff3-xtest)^2)\n}\n\n\n\n\nCode\nday_index = 1:4440\ndates1 = as.Date(df1$Date[(k+1):n])\nrmse1 = data.frame(day_index,dates1,rmse1)\nnames(rmse1) =c(\"Day\",\"Date\",\"log_kospi\",\"log_sp500\",\"us_spread\")\nrmse2 = data.frame(day_index,dates1,rmse2)\nnames(rmse2) =c(\"Day\",\"Date\",\"log_kospi\",\"log_sp500\",\"us_spread\")\nrmse3 = data.frame(day_index,dates1,rmse3)\nnames(rmse3) =c(\"Day\",\"Date\",\"log_kospi\",\"log_sp500\",\"us_spread\")\nrmse1$Model &lt;- \"VAR(2)\"\nrmse2$Model &lt;- \"VAR(5)\"\nrmse3$Model &lt;- \"VAR(10)\"\nrmse_combined &lt;- rbind(rmse1, rmse2, rmse3)\nrmse1$Model &lt;- \"VAR(2)\"\nrmse2$Model &lt;- \"VAR(5)\"\nrmse3$Model &lt;- \"VAR(10)\"\nrmse_combined &lt;- rbind(rmse1, rmse2, rmse3)\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = log_kospi, color = Model)) + \n  geom_line() +\n  labs(\n    title = \"CV RMSE for log_kospi\",\n    x = \"Day\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = log_sp500, color = Model)) + \n  geom_line() +\n  labs(\n    title = \"CV RMSE for log_sp500\",\n    x = \"Day\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = rmse_combined, aes(x = Date, y = us_spread, color = Model)) + \n  geom_line() +\n  labs(\n    title = \"CV RMSE for us_spread\",\n    x = \"Day\",\n    y = \"RMSE\",\n    color = \"Model\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(vars)\nlibrary(forecast)\nlibrary(plotly)\n\n# Fit VAR(5) on full data\nvar5 &lt;- VAR(ts_obj, p = 5, type = \"both\")\n\n# Forecast 252 days ahead\nh &lt;- 504\nfcast &lt;- forecast(var5, h = h)\n\n# us_spread plot (not log-transformed, keep as is)\nfig1 &lt;- plot_ly() %&gt;%\n  add_lines(x = as.numeric(time(tail(ts_obj[, \"us_spread\"], 2500))), \n            y = as.numeric(tail(ts_obj[, \"us_spread\"], 2500)), \n            name = \"Historical\", line = list(color = \"black\")) %&gt;%\n  add_lines(x = as.numeric(time(fcast$forecast$us_spread$mean)), \n            y = as.numeric(fcast$forecast$us_spread$mean), \n            name = \"Forecast\", line = list(color = \"blue\", width = 2)) %&gt;%\n  add_ribbons(x = as.numeric(time(fcast$forecast$us_spread$mean)), \n              ymin = as.numeric(fcast$forecast$us_spread$lower[,2]), \n              ymax = as.numeric(fcast$forecast$us_spread$upper[,2]),\n              name = \"95% CI\", fillcolor = \"rgba(0,100,255,0.2)\", \n              line = list(color = \"transparent\")) %&gt;%\n  add_ribbons(x = as.numeric(time(fcast$forecast$us_spread$mean)), \n              ymin = as.numeric(fcast$forecast$us_spread$lower[,1]), \n              ymax = as.numeric(fcast$forecast$us_spread$upper[,1]),\n              name = \"80% CI\", fillcolor = \"rgba(0,100,255,0.4)\", \n              line = list(color = \"transparent\")) %&gt;%\n  layout(title = \"VAR(5) Forecast for us_spread\",\n         xaxis = list(title = \"Year\"),\n         yaxis = list(title = \"us_spread\"),\n         hovermode = \"x unified\")\n\n# KOSPI plot (transform back from log to original scale)\nfig2 &lt;- plot_ly() %&gt;%\n  add_lines(x = as.numeric(time(tail(ts_obj[, \"log_kospi\"], 2500))), \n            y = exp(as.numeric(tail(ts_obj[, \"log_kospi\"], 2500))), \n            name = \"Historical\", line = list(color = \"black\")) %&gt;%\n  add_lines(x = as.numeric(time(fcast$forecast$log_kospi$mean)), \n            y = exp(as.numeric(fcast$forecast$log_kospi$mean)), \n            name = \"Forecast\", line = list(color = \"blue\", width = 2)) %&gt;%\n  add_ribbons(x = as.numeric(time(fcast$forecast$log_kospi$mean)), \n              ymin = exp(as.numeric(fcast$forecast$log_kospi$lower[,2])), \n              ymax = exp(as.numeric(fcast$forecast$log_kospi$upper[,2])),\n              name = \"95% CI\", fillcolor = \"rgba(0,100,255,0.2)\", \n              line = list(color = \"transparent\")) %&gt;%\n  add_ribbons(x = as.numeric(time(fcast$forecast$log_kospi$mean)), \n              ymin = exp(as.numeric(fcast$forecast$log_kospi$lower[,1])), \n              ymax = exp(as.numeric(fcast$forecast$log_kospi$upper[,1])),\n              name = \"80% CI\", fillcolor = \"rgba(0,100,255,0.4)\", \n              line = list(color = \"transparent\")) %&gt;%\n  layout(title = \"VAR(5) Forecast for KOSPI\",\n         xaxis = list(title = \"Year\"),\n         yaxis = list(title = \"KOSPI\"),\n         hovermode = \"x unified\")\n\n# S&P500 plot (transform back from log to original scale)\nfig3 &lt;- plot_ly() %&gt;%\n  add_lines(x = as.numeric(time(tail(ts_obj[, \"log_sp500\"], 2500))), \n            y = exp(as.numeric(tail(ts_obj[, \"log_sp500\"], 2500))), \n            name = \"Historical\", line = list(color = \"black\")) %&gt;%\n  add_lines(x = as.numeric(time(fcast$forecast$log_sp500$mean)), \n            y = exp(as.numeric(fcast$forecast$log_sp500$mean)), \n            name = \"Forecast\", line = list(color = \"blue\", width = 2)) %&gt;%\n  add_ribbons(x = as.numeric(time(fcast$forecast$log_sp500$mean)), \n              ymin = exp(as.numeric(fcast$forecast$log_sp500$lower[,2])), \n              ymax = exp(as.numeric(fcast$forecast$log_sp500$upper[,2])),\n              name = \"95% CI\", fillcolor = \"rgba(0,100,255,0.2)\", \n              line = list(color = \"transparent\")) %&gt;%\n  add_ribbons(x = as.numeric(time(fcast$forecast$log_sp500$mean)), \n              ymin = exp(as.numeric(fcast$forecast$log_sp500$lower[,1])), \n              ymax = exp(as.numeric(fcast$forecast$log_sp500$upper[,1])),\n              name = \"80% CI\", fillcolor = \"rgba(0,100,255,0.4)\", \n              line = list(color = \"transparent\")) %&gt;%\n  layout(title = \"VAR(5) Forecast for S&P500\",\n         xaxis = list(title = \"Year\"),\n         yaxis = list(title = \"S&P500\"),\n         hovermode = \"x unified\")\n\n# Display plots\nfig1\n\n\n\n\n\n\nCode\nfig2\n\n\n\n\n\n\nCode\nfig3"
  }
]